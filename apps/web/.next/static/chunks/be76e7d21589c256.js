(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,18566,(e,t,r)=>{t.exports=e.r(76562)},71829,e=>{"use strict";let t={progress:"progress",maintenance:"maintenance",light:"light"},r={[t.progress]:"Progress",[t.maintenance]:"Maintenance",[t.light]:"Light"},i={[t.progress]:"Push for small, steady improvements.",[t.maintenance]:"Hold steady and focus on form.",[t.light]:"Easy effort today."};e.s(["EXERCISE_HISTORY_AGGREGATION_MODES",0,{max:"max",avg:"avg"},"EXERCISE_HISTORY_DISPLAY_MODES",0,{weight:"weight",reps:"reps"},"EXERCISE_PRIMARY_METRICS",0,{weight:"weight",height:"height",time:"time",distance:"distance",repsOnly:"reps_only"},"EXERCISE_TYPES",0,{single:"single",b2b:"b2b",circuit:"circuit"},"SESSION_MODES",0,t,"SESSION_MODE_DESCRIPTIONS",0,i,"SESSION_MODE_LABELS",0,r])},62376,e=>{"use strict";var t=e.i(71829);let r="current_workout_session";function i(e){return e===t.SESSION_MODES.progress||e===t.SESSION_MODES.maintenance||e===t.SESSION_MODES.light}function n(e,r=t.SESSION_MODES.progress){return i(e)?e:r}function s(e,t){let i={workoutName:e,routineId:t??null,sessionId:null,startTime:new Date().toISOString(),exercises:[]};localStorage.setItem(r,JSON.stringify(i))}function a(e,t){let r=o(),i=t??null;r?(r.workoutName!==e||(r.routineId??null)!==i)&&s(e,i):s(e,i)}function o(){let e=localStorage.getItem(r);if(!e)return null;let t=JSON.parse(e),i=t.routineId,n="number"==typeof i?i:Number(i);t.routineId=Number.isFinite(n)?n:null;let s=t.sessionId,a="number"==typeof s?s:Number(s);return t.sessionId=Number.isFinite(a)?a:null,t}function c(e){let t=o();t&&t.sessionId!==e&&(t.sessionId=e,localStorage.setItem(r,JSON.stringify(t)))}function l(e){let t=o();t&&(t.exercises.push(e),localStorage.setItem(r,JSON.stringify(t)))}function u(e){let t=o();t&&(t.cardio=e,localStorage.setItem(r,JSON.stringify(t)))}function m(){localStorage.removeItem(r)}e.s(["addCardioToSession",()=>u,"addExerciseToSession",()=>l,"clearWorkoutSession",()=>m,"ensureWorkoutSession",()=>a,"getWorkoutSession",()=>o,"initWorkoutSession",()=>s,"isSessionMode",()=>i,"resolveSessionMode",()=>n,"setWorkoutSessionId",()=>c])},5907,e=>{"use strict";let t="session_workout_override",r="session_workout_change_ack",i="session_workout_targets_meta";function n(e,t,r){let i=encodeURIComponent(t),n=r?encodeURIComponent(r):"default";return`${e}:${i}:${n}`}function s(e,r){let i=n(t,e,r),s=sessionStorage.getItem(i);if(!s)return null;try{return JSON.parse(s)}catch(e){return console.error("Failed to parse session workout override:",e),null}}function a(e,r){let i=n(t,e.name,r);sessionStorage.setItem(i,JSON.stringify(e))}function o(e,t){let r=n(i,e,t),s=sessionStorage.getItem(r);if(!s)return null;try{return JSON.parse(s)}catch(e){return console.error("Failed to parse session targets meta:",e),null}}function c(e,t,r){let s=n(i,e,t);r?sessionStorage.setItem(s,JSON.stringify(r)):sessionStorage.removeItem(s)}function l(e,t){let i=n(r,e,t);return"1"===sessionStorage.getItem(i)}function u(e,t){let i=n(r,e,t);sessionStorage.setItem(i,"1")}e.s(["acknowledgeChangeWarning",()=>u,"hasChangeWarningAck",()=>l,"loadSessionTargetsMeta",()=>o,"loadSessionWorkout",()=>s,"saveSessionTargetsMeta",()=>c,"saveSessionWorkout",()=>a])},25699,e=>{"use strict";function t(e){return"lbs"===e||"kg"===e?e:"lbs"}function r(e){return"in"===e||"cm"===e?e:"in"}function i(e,t){return Number.isFinite(e)?"kg"===t?.45359237*e:e:0}function n(e,t){return Number.isFinite(e)?"kg"===t?e/.45359237:e:0}function s(e,t){return Number.isFinite(e)?"cm"===t?2.54*e:e:0}function a(e,t){return Number.isFinite(e)?"cm"===t?e/2.54:e:0}function o(e){if(!Number.isFinite(e))return"0";let t=Math.round(10*e)/10;return Number.isInteger(t)?t.toString():t.toFixed(1)}function c(e,t,r){if(r)return e<=0?"Machine":`+${o(i(e,t))} ${t}`;return`${o(i(e,t))} ${t}`}e.s(["DEFAULT_HEIGHT_UNIT",0,"in","DEFAULT_WEIGHT_UNIT",0,"lbs","convertHeightFromStorage",()=>s,"convertHeightToStorage",()=>a,"convertWeightFromStorage",()=>i,"convertWeightToStorage",()=>n,"formatDisplayNumber",()=>o,"formatWeightDisplay",()=>c,"normalizeHeightUnit",()=>r,"normalizeWeightUnit",()=>t])},44736,e=>{"use strict";var t=e.i(71829),r=e.i(25699);function i(e,r){return Object.values(t.EXERCISE_PRIMARY_METRICS).includes(e)?e:r?t.EXERCISE_PRIMARY_METRICS.repsOnly:t.EXERCISE_PRIMARY_METRICS.weight}function n(e,r,i,n){switch(e){case t.EXERCISE_PRIMARY_METRICS.weight:return i;case t.EXERCISE_PRIMARY_METRICS.height:return n;case t.EXERCISE_PRIMARY_METRICS.time:return r||"sec";case t.EXERCISE_PRIMARY_METRICS.distance:return r||"m";default:return null}}function s(e,r,i,s,a){let o=n(e,r,i,s);switch(e){case t.EXERCISE_PRIMARY_METRICS.weight:return a?`Added Weight (${o})`:`Weight (${o})`;case t.EXERCISE_PRIMARY_METRICS.height:return`Height (${o})`;case t.EXERCISE_PRIMARY_METRICS.time:return`Time (${o})`;case t.EXERCISE_PRIMARY_METRICS.distance:return`Distance (${o})`;case t.EXERCISE_PRIMARY_METRICS.repsOnly:return"Reps";default:return"Value"}}function a(e,i,n,s){return Number.isFinite(e)?i===t.EXERCISE_PRIMARY_METRICS.weight?(0,r.convertWeightFromStorage)(e,n):i===t.EXERCISE_PRIMARY_METRICS.height?(0,r.convertHeightFromStorage)(e,s):e:0}function o(e,i,s,o,c,l){if(i===t.EXERCISE_PRIMARY_METRICS.weight)return(0,r.formatWeightDisplay)(e,o,l);let u=n(i,s,o,c),m=a(e,i,o,c);return u?`${(0,r.formatDisplayNumber)(m)} ${u}`:(0,r.formatDisplayNumber)(m)}function c(e,t,i,n,s=!1){if(s&&0===e)return"";let o=a(e,t,i,n);return(0,r.formatDisplayNumber)(o)}function l(e,i,n,s){if(""===e)return 0;let a=parseFloat(e);return Number.isFinite(a)?Number.isFinite(a)?i===t.EXERCISE_PRIMARY_METRICS.weight?(0,r.convertWeightToStorage)(a,n):i===t.EXERCISE_PRIMARY_METRICS.height?(0,r.convertHeightToStorage)(a,s):a:0:null}function u(e){return e===t.EXERCISE_PRIMARY_METRICS.repsOnly}function m(e){return e===t.EXERCISE_PRIMARY_METRICS.weight}e.s(["convertMetricFromStorage",()=>a,"formatMetricDisplay",()=>o,"formatMetricInputValue",()=>c,"getMetricLabel",()=>s,"isRepsOnlyMetric",()=>u,"isWeightMetric",()=>m,"parseMetricInput",()=>l,"resolveMetricUnit",()=>n,"resolvePrimaryMetric",()=>i])},8479,e=>{"use strict";var t=e.i(43476),r=e.i(71645),i=e.i(18566),n=e.i(22016),s=e.i(5907),a=e.i(62376),o=e.i(71829),c=e.i(25699),l=e.i(44736);function u(e){if(!e)return[];let t=[];for(let r of e.exercises)if(r.type===o.EXERCISE_TYPES.single)t.push({name:r.name,targetWeight:Number.isFinite(r.targetWeight)?r.targetWeight:null,targetReps:Number.isFinite(r.targetReps)?r.targetReps:null,isBodyweight:r.isBodyweight??!1,isMachine:r.isMachine??!1,primaryMetric:r.primaryMetric,metricUnit:r.metricUnit??null});else{let[e,i]=r.exercises;t.push({name:e.name,targetWeight:Number.isFinite(e.targetWeight)?e.targetWeight:null,targetReps:Number.isFinite(e.targetReps)?e.targetReps:null,isBodyweight:e.isBodyweight??!1,isMachine:e.isMachine??!1,primaryMetric:e.primaryMetric,metricUnit:e.metricUnit??null}),t.push({name:i.name,targetWeight:Number.isFinite(i.targetWeight)?i.targetWeight:null,targetReps:Number.isFinite(i.targetReps)?i.targetReps:null,isBodyweight:i.isBodyweight??!1,isMachine:i.isMachine??!1,primaryMetric:i.primaryMetric,metricUnit:i.metricUnit??null})}return t}function m(){let e=(0,i.useParams)(),m=(0,i.useRouter)(),g=(0,i.useSearchParams)(),[d,h]=(0,r.useState)(null),[p,S]=(0,r.useState)(!0),[E,f]=(0,r.useState)(null),[b,M]=(0,r.useState)(!1),[y,I]=(0,r.useState)(!1),[x,w]=(0,r.useState)(0),[R,N]=(0,r.useState)(0),[_,v]=(0,r.useState)(null),[T,P]=(0,r.useState)(!1),[C,j]=(0,r.useState)(c.DEFAULT_WEIGHT_UNIT),[W,k]=(0,r.useState)(c.DEFAULT_HEIGHT_UNIT),U=e=>({primaryMetric:(0,l.resolvePrimaryMetric)(e.primaryMetric,e.isBodyweight),metricUnit:e.metricUnit??null}),O=(e,t,r)=>{let i=U(t);return(0,l.formatMetricDisplay)(e,i.primaryMetric,i.metricUnit,C,W,r)},F=e=>Math.round((0,c.convertWeightFromStorage)(e,C)).toLocaleString(),A=(0,r.useMemo)(()=>u(d),[d]),D=(0,r.useMemo)(()=>{let e=new Map;for(let t of A)e.set(t.name,t);return e},[A]),B=(0,r.useRef)(!1),X=(0,r.useRef)(!1);(0,r.useEffect)(()=>{let e=!0;return async function(){try{let t=await fetch("/api/user/settings");if(!t.ok)return;let r=await t.json();if(!e)return;j((0,c.normalizeWeightUnit)(r?.weightUnit)),k((0,c.normalizeHeightUnit)(r?.heightUnit))}catch(e){console.error("Error fetching user settings:",e)}}(),()=>{e=!1}},[]);let Y=g.get("routineId");return((0,r.useEffect)(()=>{!async function(){try{let t=`/api/workout/${e.name}`;Y&&(t+=`?routineId=${Y}`);let r=await fetch(t);if(!r.ok)throw Error("Workout not found");let i=await r.json();h(i.workout)}catch(e){console.error("Error fetching workout:",e)}finally{S(!1)}}()},[e.name,Y]),(0,r.useEffect)(()=>{let e=(0,a.getWorkoutSession)();if(!e)return void console.error("No session data found");f(e);let t=0;for(let r of e.exercises){let e=D.get(r.name),i=U({primaryMetric:r.primaryMetric??e?.primaryMetric,metricUnit:r.metricUnit??e?.metricUnit,isBodyweight:e?.isBodyweight});if((0,l.isWeightMetric)(i.primaryMetric))for(let e of(r.warmup&&(t+=r.warmup.weight*r.warmup.reps),r.sets))t+=e.weight*e.reps;if(r.b2bPartner){let e=D.get(r.b2bPartner.name),i=U({primaryMetric:r.b2bPartner.primaryMetric??e?.primaryMetric,metricUnit:r.b2bPartner.metricUnit??e?.metricUnit,isBodyweight:e?.isBodyweight});if((0,l.isWeightMetric)(i.primaryMetric))for(let e of(r.b2bPartner.warmup&&(t+=r.b2bPartner.warmup.weight*r.b2bPartner.warmup.reps),r.b2bPartner.sets))t+=e.weight*e.reps}}w(Math.round(t));let r=new Date(e.startTime);N(Math.round((new Date().getTime()-r.getTime())/6e4))},[D]),(0,r.useEffect)(()=>{if(!E||B.current)return;let e=`workout-saved-${E.startTime}`;if(localStorage.getItem(e)){console.log("âš ï¸ Workout already saved, skipping"),B.current=!0,I(!0);return}(async()=>{M(!0),B.current=!0;try{if(!(await fetch("/api/save-workout",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(E)})).ok)throw Error("Failed to save workout");localStorage.setItem(e,"true"),I(!0),console.log("âœ… Workout auto-saved")}catch(e){console.error("âŒ Error saving workout:",e),B.current=!1}finally{M(!1)}})()},[E]),(0,r.useEffect)(()=>{!E||X.current||(async()=>{P(!0),X.current=!0;try{let e=Y??("number"==typeof E.routineId?String(E.routineId):null),t=(0,s.loadSessionWorkout)(E.workoutName,e),r=u(t),i=(0,s.loadSessionTargetsMeta)(E.workoutName,e),n=i||r.length>0?{sessionMode:i?.sessionMode??null,source:i?.source??null,encouragement:i?.encouragement??null,goalSummary:i?.goalSummary??null,trendSummary:i?.trendSummary??null,targets:r}:null,a=new URLSearchParams;"number"==typeof E.sessionId&&a.set("sessionId",String(E.sessionId)),E.startTime&&a.set("sessionKey",E.startTime);let o=await fetch(`/api/workout-report?${a.toString()}`);if(o.ok){let e=await o.json();if(e?.report)return void v(e.report)}let c=await fetch("/api/workout-report",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sessionData:E,preWorkoutTargets:n})});if(!c.ok)throw Error("Failed to generate report");let l=await c.json();v(l.report||null)}catch(e){console.error("Error generating report:",e),X.current=!1}finally{P(!1)}})()},[E,Y]),p)?(0,t.jsx)("div",{className:"min-h-screen bg-zinc-900 flex items-center justify-center p-4",children:(0,t.jsx)("div",{className:"text-white text-2xl",children:"Loading..."})}):d?(0,t.jsx)("div",{className:"min-h-screen bg-zinc-900 p-4",children:(0,t.jsxs)("div",{className:"max-w-2xl mx-auto",children:[(0,t.jsxs)("div",{className:"text-center mb-8",children:[(0,t.jsx)("div",{className:"text-8xl mb-4",children:"ðŸŽ‰"}),(0,t.jsx)("h1",{className:"text-4xl font-bold text-white mb-2",children:"Workout Complete!"}),(0,t.jsx)("div",{className:"text-zinc-400 text-xl mb-2",children:d.name}),(0,t.jsx)("div",{className:"text-zinc-500",children:new Date().toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]}),(0,t.jsx)("div",{className:"bg-zinc-800 rounded-lg p-6 mb-8 border-2 border-green-600",children:E?(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-zinc-400 text-sm mb-2",children:"Total Volume"}),(0,t.jsxs)("div",{className:"text-white text-4xl font-bold mb-1",children:[F(x)," ",C]}),(0,t.jsxs)("div",{className:"text-zinc-500 text-sm mt-2",children:["Duration: ",R," minutes"]}),(0,t.jsxs)("div",{className:"text-xs mt-2",children:[b&&(0,t.jsx)("span",{className:"text-yellow-400",children:"Saving workout..."}),y&&(0,t.jsx)("span",{className:"text-green-400",children:"âœ“ Workout saved"})]})]}):(0,t.jsx)("div",{className:"text-center text-zinc-400",children:"Loading session data..."})}),(T||_)&&(0,t.jsxs)("div",{className:"bg-zinc-800 rounded-lg p-6 mb-8 border border-zinc-700",children:[(0,t.jsx)("div",{className:"text-zinc-300 text-sm font-semibold mb-3",children:"Workout Report"}),T&&(0,t.jsx)("div",{className:"text-zinc-400 text-sm",children:"Generating your report..."}),_&&(0,t.jsx)("div",{className:"text-zinc-200 text-sm whitespace-pre-line",children:_})]}),E&&(0,t.jsxs)("div",{className:"bg-zinc-800 rounded-lg p-6 mb-8",children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-white mb-4",children:"EXERCISES COMPLETED"}),(0,t.jsx)("div",{className:"space-y-4",children:E.exercises.map((e,r)=>{let i=D.get(e.name),n=U({primaryMetric:e.primaryMetric??i?.primaryMetric,metricUnit:e.metricUnit??i?.metricUnit,isBodyweight:i?.isBodyweight}),s=e.b2bPartner?.name?D.get(e.b2bPartner.name):void 0,a=U({primaryMetric:e.b2bPartner?.primaryMetric??s?.primaryMetric,metricUnit:e.b2bPartner?.metricUnit??s?.metricUnit,isBodyweight:s?.isBodyweight}),c=!!e.isMachine&&(0,l.isWeightMetric)(n.primaryMetric),u=!!e.b2bPartner?.isMachine&&(0,l.isWeightMetric)(a.primaryMetric),m=(0,l.isWeightMetric)(n.primaryMetric)||e.b2bPartner&&(0,l.isWeightMetric)(a.primaryMetric),g=0;return(0,l.isWeightMetric)(n.primaryMetric)&&(g+=(e.warmup?e.warmup.weight*e.warmup.reps:0)+e.sets.reduce((e,t)=>e+t.weight*t.reps,0)),e.b2bPartner&&(0,l.isWeightMetric)(a.primaryMetric)&&(g+=(e.b2bPartner.warmup?e.b2bPartner.warmup.weight*e.b2bPartner.warmup.reps:0)+e.b2bPartner.sets.reduce((e,t)=>e+t.weight*t.reps,0)),(0,t.jsxs)("div",{className:"border-l-4 border-green-500 pl-3",children:[(0,t.jsx)("div",{className:"text-white font-semibold mb-1",children:e.type===o.EXERCISE_TYPES.single?e.name:`B2B: ${e.name} / ${e.b2bPartner?.name}`}),(0,t.jsxs)("div",{className:"text-zinc-400 text-sm mb-2",children:[e.sets.length," sets",m&&(0,t.jsxs)(t.Fragment,{children:[" â€¢ ",F(g)," ",C," volume"]})]}),(0,t.jsxs)("div",{className:"space-y-1 text-xs",children:[e.warmup&&(0,t.jsxs)("div",{className:"text-zinc-500",children:["Warmup: ",O(e.warmup.weight,{primaryMetric:n.primaryMetric,metricUnit:n.metricUnit,isBodyweight:i?.isBodyweight},c)," Ã—"," ",e.warmup.reps," reps"]}),e.sets.map((r,o)=>(0,t.jsxs)("div",{className:"text-zinc-300",children:["Set ",o+1,": ",O(r.weight,{primaryMetric:n.primaryMetric,metricUnit:n.metricUnit,isBodyweight:i?.isBodyweight},c)," Ã— ",r.reps," reps",e.b2bPartner&&e.b2bPartner.sets[o]&&(0,t.jsxs)("span",{className:"text-purple-400",children:[" + ",O(e.b2bPartner.sets[o].weight,{primaryMetric:a.primaryMetric,metricUnit:a.metricUnit,isBodyweight:s?.isBodyweight},u)," Ã—"," ",e.b2bPartner.sets[o].reps," reps"]})]},o))]})]},r)})}),E.cardio&&(0,t.jsxs)("div",{className:"mt-4 pt-4 border-t border-zinc-700",children:[(0,t.jsxs)("div",{className:"text-white font-semibold mb-1",children:["Cardio: ",E.cardio.type]}),(0,t.jsxs)("div",{className:"text-zinc-400 text-sm",children:[E.cardio.time," min",E.cardio.speed&&` â€¢ ${E.cardio.speed} mph`,E.cardio.incline&&` â€¢ ${E.cardio.incline}% incline`]})]})]}),(0,t.jsx)("button",{onClick:()=>{m.push("/routines")},className:"w-full bg-green-600 hover:bg-green-700 text-white py-4 rounded-lg text-xl font-bold transition-colors mb-4",children:"âœ… Finish & Go Home"})]})}):(0,t.jsx)("div",{className:"min-h-screen bg-zinc-900 flex items-center justify-center p-4",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-white text-2xl mb-4",children:"Workout not found"}),(0,t.jsx)(n.default,{href:"/routines",className:"text-blue-400 hover:text-blue-300",children:"Back to routines"})]})})}e.s(["default",()=>m])}]);