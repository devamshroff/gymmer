(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,18566,(e,t,s)=>{t.exports=e.r(76562)},97313,e=>{"use strict";var t=e.i(43476),s=e.i(71645),r=e.i(18566),n=e.i(22016);function i({onComplete:e}){let[r,n]=(0,s.useState)(""),[i,l]=(0,s.useState)(""),[a,o]=(0,s.useState)(!1),c=async t=>{t.preventDefault(),l("");let s=r.trim(),n=s.length<3?"Username must be at least 3 characters":s.length>20?"Username must be 20 characters or less":/^[a-zA-Z0-9_]+$/.test(s)?null:"Username can only contain letters, numbers, and underscores";if(n)return void l(n);o(!0);try{let t=await fetch("/api/user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:s})}),r=await t.json();if(!t.ok)return void l(r.error||"Failed to set username");e(r.username)}catch(e){l("An error occurred. Please try again.")}finally{o(!1)}};return(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 p-4",children:(0,t.jsxs)("div",{className:"bg-zinc-800 rounded-xl p-8 max-w-md w-full border border-zinc-700",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-white mb-2 text-center",children:"Set your username"}),(0,t.jsx)("p",{className:"text-zinc-400 text-center mb-6",children:"Choose a username to identify yourself when sharing routines with others."}),(0,t.jsxs)("form",{onSubmit:c,children:[(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("label",{htmlFor:"username",className:"block text-sm font-medium text-zinc-300 mb-2",children:"Username"}),(0,t.jsx)("input",{id:"username",type:"text",value:r,onChange:e=>{n(e.target.value),l("")},placeholder:"Enter your username",className:"w-full bg-zinc-700 text-white px-4 py-3 rounded-lg border border-zinc-600 focus:outline-none focus:border-green-500 placeholder-zinc-500",autoFocus:!0,disabled:a}),(0,t.jsx)("p",{className:"text-xs text-zinc-500 mt-1",children:"3-20 characters. Letters, numbers, and underscores only."})]}),i&&(0,t.jsx)("div",{className:"mb-4 text-red-400 text-sm text-center",children:i}),(0,t.jsx)("button",{type:"submit",disabled:a||!r.trim(),className:"w-full bg-green-600 hover:bg-green-700 disabled:bg-zinc-600 disabled:cursor-not-allowed text-white font-bold py-3 rounded-lg transition-colors",children:a?"Setting username...":"Continue"})]})]})})}function l(){let e=(0,r.useRouter)(),[l,a]=(0,s.useState)([]),[o,c]=(0,s.useState)([]),[d,x]=(0,s.useState)([]),[m,u]=(0,s.useState)(!0),[h,b]=(0,s.useState)(null),[f,p]=(0,s.useState)(!1),[g,j]=(0,s.useState)(!1),[w,v]=(0,s.useState)(null),[N,y]=(0,s.useState)(!1);async function z(){try{let e=await fetch("/api/user");if(e.ok){let t=await e.json();b(t),t.hasUsername?C():p(!0)}}catch(e){console.error("Error fetching user info:",e),C()}}async function C(){try{let e=await fetch("/api/routines"),t=await e.json();a(t.routines||[]);let s=await fetch("/api/routines/favorites"),r=await s.json();c(r.routines||[]);let n=await fetch("/api/routines/public"),i=await n.json();x((i.routines||[]).slice(0,3))}catch(e){console.error("Error fetching routines:",e)}finally{u(!1)}}async function k(e){try{(await fetch(`/api/routines/${e}/favorite`,{method:"DELETE"})).ok&&c(o.filter(t=>t.id!==e))}catch(e){console.error("Error removing favorite:",e)}}async function S(){if(w&&!N){y(!0);try{if(!(await fetch(`/api/routines/${w.id}`,{method:"DELETE"})).ok)throw Error("Failed to delete routine");a(e=>e.filter(e=>e.id!==w.id)),v(null)}catch(e){console.error("Error deleting routine:",e),alert("Failed to delete routine. Please try again.")}finally{y(!1)}}}if((0,s.useEffect)(()=>{z()},[]),f)return(0,t.jsx)(i,{onComplete:function(e){b(t=>t?{...t,username:e,hasUsername:!0}:null),p(!1),C()}});if(m)return(0,t.jsx)("div",{className:"min-h-screen bg-zinc-900 flex items-center justify-center p-4",children:(0,t.jsx)("div",{className:"text-white text-2xl",children:"Loading..."})});let E=(e,s)=>{let r=e.last_workout_date||null,i=function(e){if(!e)return"Never";let t=new Date(/^\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}/.test(e)?`${e.replace(" ","T")}Z`:/^\d{4}-\d{2}-\d{2}$/.test(e)?`${e}T00:00:00Z`:e);return Number.isNaN(t.getTime())?"Unknown":t.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}(r),l=encodeURIComponent(e.name),a=`/workout/${l}?routineId=${e.id}&preview=1`;return(0,t.jsxs)("div",{className:"bg-zinc-800 hover:bg-zinc-700 transition-colors rounded-lg p-6 border-2 border-zinc-700",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between gap-3 mb-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-2xl font-semibold text-white",children:e.name}),(0,t.jsxs)("div",{className:"text-zinc-400 text-sm",children:[!s&&e.creator_username&&(0,t.jsxs)("span",{children:["by @",e.creator_username]}),!s&&!e.creator_username&&e.creator_name&&(0,t.jsxs)("span",{children:["by ",e.creator_name]}),s&&e.description&&e.description,s&&!e.description&&"Â "]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)("div",{className:"text-sm text-zinc-500 whitespace-nowrap shrink-0",children:["Last:"," ",(0,t.jsx)("span",{className:r?"text-blue-300":"text-zinc-600",children:i})]}),!s&&(0,t.jsx)("button",{onClick:()=>k(e.id),className:"text-red-400 hover:text-red-300 p-1",title:"Remove from favorites",children:(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})})})]})]}),(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,t.jsxs)(n.default,{href:a,className:"px-4 py-2 rounded-lg font-medium bg-red-900 hover:bg-red-800 text-red-100 transition-colors inline-flex items-center gap-2",children:[(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",children:(0,t.jsx)("path",{d:"M6.5 4.8a1 1 0 0 1 1 0l10 6a1 1 0 0 1 0 1.8l-10 6A1 1 0 0 1 6 17.8V6.2a1 1 0 0 1 .5-1.4z"})}),"Start"]}),s&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.default,{href:`/routines/${e.id}/edit`,className:"px-4 py-2 rounded-lg font-medium bg-blue-800 hover:bg-blue-700 text-white transition-colors inline-flex items-center gap-2",children:[(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",children:(0,t.jsx)("path",{d:"M4 17.3V20h2.7l8-8-2.7-2.7-8 8zm15.7-9.6a1 1 0 0 0 0-1.4l-2-2a1 1 0 0 0-1.4 0l-1.6 1.6L18.1 9l1.6-1.3z"})}),"Edit"]}),(0,t.jsx)("button",{onClick:()=>v(e),className:"ml-auto p-2.5 text-red-700 hover:text-red-600","aria-label":"Delete routine",title:"Delete routine",children:(0,t.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,t.jsx)("path",{d:"M19.5 6h-15"}),(0,t.jsx)("path",{d:"M8.5 6V4.5a1.5 1.5 0 0 1 1.5-1.5h4a1.5 1.5 0 0 1 1.5 1.5V6"}),(0,t.jsx)("path",{d:"M6.5 6l1 13a2 2 0 0 0 2 2h5a2 2 0 0 0 2-2l1-13"}),(0,t.jsx)("path",{d:"M10 11v6"}),(0,t.jsx)("path",{d:"M14 11v6"})]})})]})]})]},`routine-${e.id}`)};return(0,t.jsx)("div",{className:"min-h-screen bg-zinc-900 p-4",children:(0,t.jsxs)("main",{className:"max-w-2xl mx-auto py-8",children:[(0,t.jsx)("div",{className:"flex justify-end mb-4",children:(0,t.jsx)(n.default,{href:"/profile",className:"inline-flex items-center justify-center rounded-full border border-zinc-700 bg-zinc-800 p-3 text-zinc-200 transition-colors hover:border-emerald-600 hover:text-emerald-300","aria-label":"Open profile",title:"Profile",children:(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",children:(0,t.jsx)("path",{d:"M12 12c2.7 0 4.9-2.2 4.9-4.9S14.7 2.2 12 2.2 7.1 4.4 7.1 7.1 9.3 12 12 12zm0 2.4c-3.2 0-9.6 1.6-9.6 4.8v2.6h19.2v-2.6c0-3.2-6.4-4.8-9.6-4.8z"})})})}),(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-white",children:"My Routines"}),(0,t.jsx)("p",{className:"text-sm text-zinc-400",children:"Build, track, and favorite workouts you want to run again."}),h?.username&&(0,t.jsxs)("p",{className:"mt-2 text-sm text-zinc-500",children:["Signed in as ",(0,t.jsxs)("span",{className:"text-emerald-300",children:["@",h.username]})]})]}),(0,t.jsx)("button",{onClick:()=>j(!0),className:"mb-3 block w-full bg-purple-900 hover:bg-purple-800 text-white text-center py-4 rounded-lg text-lg font-bold transition-colors",children:"+ Create New Routine"}),(0,t.jsx)("div",{className:"mb-8",children:(0,t.jsx)(n.default,{href:"/routines/import",className:"block w-full rounded-lg bg-slate-800 hover:bg-slate-700 text-slate-200 px-4 py-3 text-center text-sm font-semibold transition-colors",children:"Import Routine from JSON"})}),(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold text-zinc-300 mb-4",children:"My Routines"}),(0,t.jsx)("div",{className:"space-y-4",children:0===l.length?(0,t.jsx)("div",{className:"text-center text-zinc-500 text-lg py-4",children:"No routines yet. Create one above or browse public routines."}):l.map(e=>E(e,!0))})]}),o.length>0&&(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsxs)("h2",{className:"text-xl font-semibold text-zinc-300 mb-4 flex items-center gap-2",children:[(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-red-300",fill:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})}),"Favorited Routines"]}),(0,t.jsx)("div",{className:"space-y-4",children:o.map(e=>E(e,!1))})]}),d.length>0&&(0,t.jsxs)("div",{className:"mt-8 pt-8 border-t border-zinc-700",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold text-zinc-300 mb-4",children:"Discover Public Routines"}),(0,t.jsx)(n.default,{href:"/routines/browse",className:"mb-4 block w-full bg-purple-900 hover:bg-purple-800 text-white text-center py-3 rounded-lg font-semibold transition-colors",children:"Browse All Public Routines"}),(0,t.jsx)("div",{className:"space-y-3",children:d.map(e=>(0,t.jsx)("div",{className:"bg-zinc-800 rounded-lg p-4 border border-zinc-700",children:(0,t.jsx)("div",{className:"flex items-center justify-between",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-white",children:e.name}),(0,t.jsxs)("p",{className:"text-sm text-zinc-400",children:["by ",(0,t.jsxs)("span",{className:"text-purple-300",children:["@",e.creator_username||e.creator_name||"Anonymous"]})]})]})})},`public-${e.id}`))})]}),g&&(0,t.jsx)("div",{className:"fixed inset-0 z-50 bg-black/70 flex items-center justify-center p-4",children:(0,t.jsxs)("div",{className:"w-full max-w-md bg-zinc-900 border border-zinc-700 rounded-xl p-6",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-white mb-2",children:"Create a new routine"}),(0,t.jsx)("p",{className:"text-zinc-400 text-sm mb-6",children:"Choose how you want to build your next workout."}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("button",{onClick:()=>e.push("/routines/builder"),className:"w-full bg-green-700 hover:bg-green-600 text-white py-3 rounded-lg text-lg font-semibold",children:"Manual Builder"}),(0,t.jsx)("button",{onClick:()=>e.push("/routines/ai"),className:"w-full bg-emerald-800 hover:bg-emerald-700 text-white py-3 rounded-lg text-lg font-semibold",children:"AI-Assisted"}),(0,t.jsx)("button",{onClick:()=>j(!1),className:"w-full bg-zinc-800 hover:bg-zinc-700 text-zinc-200 py-3 rounded-lg text-sm font-semibold",children:"Cancel"})]})]})}),w&&(0,t.jsx)("div",{className:"fixed inset-0 z-50 bg-black/70 flex items-center justify-center p-4",children:(0,t.jsxs)("div",{className:"w-full max-w-md bg-zinc-900 border border-zinc-700 rounded-xl p-6",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-white mb-2",children:"Delete Routine"}),(0,t.jsxs)("p",{className:"text-zinc-400 text-sm mb-6",children:['This will permanently delete "',w.name,'".']}),(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)("button",{onClick:S,className:"flex-1 bg-red-800 hover:bg-red-700 text-white py-3 rounded-lg text-sm font-semibold",disabled:N,children:N?"Deleting...":"Delete"}),(0,t.jsx)("button",{onClick:function(){N||v(null)},className:"flex-1 bg-zinc-800 hover:bg-zinc-700 text-zinc-200 py-3 rounded-lg text-sm font-semibold",disabled:N,children:"Cancel"})]})]})})]})})}e.s(["default",()=>l],97313)}]);