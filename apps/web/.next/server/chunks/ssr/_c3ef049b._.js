module.exports=[87674,a=>{"use strict";function b(a){return null}function c(a){}function d(a){var b;a.routineName&&(a.routineName,b=a.routineId&&String(a.routineId))}a.s(["invalidateWorkoutBootstrapCache",()=>d,"loadWorkoutBootstrapCache",()=>b,"saveWorkoutBootstrapCache",()=>c])},64600,a=>{"use strict";let b={progress:"progress",maintenance:"maintenance",light:"light"},c={[b.progress]:"Progress",[b.maintenance]:"Maintenance",[b.light]:"Light"},d={[b.progress]:"Push for small, steady improvements.",[b.maintenance]:"Hold steady and focus on form.",[b.light]:"Easy effort today."};a.s(["EXERCISE_HISTORY_AGGREGATION_MODES",0,{max:"max",avg:"avg"},"EXERCISE_HISTORY_DISPLAY_MODES",0,{weight:"weight",reps:"reps"},"EXERCISE_PRIMARY_METRICS",0,{weight:"weight",height:"height",time:"time",distance:"distance",repsOnly:"reps_only"},"EXERCISE_TYPES",0,{single:"single",b2b:"b2b",circuit:"circuit"},"SESSION_MODES",0,b,"SESSION_MODE_DESCRIPTIONS",0,d,"SESSION_MODE_LABELS",0,c])},13210,a=>{"use strict";var b=a.i(64600);function c(a){return a===b.SESSION_MODES.progress||a===b.SESSION_MODES.maintenance||a===b.SESSION_MODES.light}function d(a,e=b.SESSION_MODES.progress){return c(a)?a:e}function e(a,b){new Date().toISOString()}function f(a,b){let c=g(),d=b??null;c?(c.workoutName!==a||(c.routineId??null)!==d)&&e(a,d):e(a,d)}function g(){return null}function h(a){let b=g();b&&b.exercises.push(a)}function i(a){let b=g();b&&(b.cardio=a)}function j(){}a.s(["addCardioToSession",()=>i,"addExerciseToSession",()=>h,"clearWorkoutSession",()=>j,"ensureWorkoutSession",()=>f,"getWorkoutSession",()=>g,"initWorkoutSession",()=>e,"isSessionMode",()=>c,"resolveSessionMode",()=>d])},63586,a=>{"use strict";function b(a,b){return null}function c(a,b){}function d(a,b){return null}function e(a,b,c){}function f(a,b){return!1}function g(a,b){}a.s(["acknowledgeChangeWarning",()=>g,"hasChangeWarningAck",()=>f,"loadSessionTargetsMeta",()=>d,"loadSessionWorkout",()=>b,"saveSessionTargetsMeta",()=>e,"saveSessionWorkout",()=>c])},75216,a=>{"use strict";let b="No form tips yet.";function c(a){if("string"!=typeof a)return b;let c=a.trim();return c.length>0?c:b}function d(a,b){if("string"==typeof b&&b.trim().length>0)return b.trim();let c="string"==typeof a&&a.trim().length>0?a.trim():"exercise",d=`${c} form`;return`https://www.youtube.com/results?search_query=${encodeURIComponent(d)}`}a.s(["getFormTips",()=>c,"getVideoUrl",()=>d])},10615,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(64600),e=a.i(11827),f=a.i(62731);let g={week:"1W",month:"1M",all:"All"};function h(a){let b=Math.round(10*a)/10;return b>=1e6?`${(b/1e6).toFixed(1)}M`:b>=1e3?`${(b/1e3).toFixed(1)}k`:Number.isInteger(b)?b.toString():b.toFixed(1)}function i(a){return 0===a.length?"":a.map((a,b)=>`${0===b?"M":"L"} ${a.x} ${a.y}`).join(" ")}function j({points:a,weightMode:e,mode:g,primaryMetric:j,metricUnit:k,targetValue:l,isMachine:m,weightUnit:n,heightUnit:o}){let[p,q]=(0,c.useState)(null),r=224,s=g===d.EXERCISE_HISTORY_DISPLAY_MODES.reps||(0,f.isRepsOnlyMetric)(j),t=(0,f.isWeightMetric)(j),u=!!m&&t,v=(0,f.resolveMetricUnit)(j,k,n,o),w=v??n,x=v?` ${v}`:"",y=a=>null===a?null:(0,f.convertMetricFromStorage)(a,j,n,o),z=!s&&t,A=a.map(a=>s?e===d.EXERCISE_HISTORY_AGGREGATION_MODES.max?a.reps_max:a.reps_avg:y(e===d.EXERCISE_HISTORY_AGGREGATION_MODES.max?a.weight_max:a.weight_avg)).filter(a=>null!==a),B=null==l?null:(0,f.convertMetricFromStorage)(l,j,n,o),C=null!==B&&Number.isFinite(B)&&B>0;C&&A.push(B);let D=a.map(a=>s||!z?a.reps_total:y(a.volume)).filter(a=>null!==a),E=A.length?Math.min(...A):0,F=A.length?Math.max(...A):1,G=D.length?Math.min(...D):0,H=D.length?Math.max(...D):1;if(F===E){let a=Math.max(1,.2*Math.abs(F));E-=a,F+=a}if(H===G){let a=Math.max(1,.2*Math.abs(H));G-=a,H+=a}u&&F<=(E=0)&&(F=E+1);let I=F-E||1,J=H-G||1,K=a.length>1?592/(a.length-1):0,L=a.map((a,b)=>{let c=s?e===d.EXERCISE_HISTORY_AGGREGATION_MODES.max?a.reps_max:a.reps_avg:y(e===d.EXERCISE_HISTORY_AGGREGATION_MODES.max?a.weight_max:a.weight_avg),f=s||!z?a.reps_total:y(a.volume),g=64+b*K,h=6*(null!==c&&null!==f);return{baseX:g,primaryValue:c,secondaryValue:f,primaryX:g-h,secondaryX:g+h}}),M=L.map(a=>{if(null===a.primaryValue)return null;let b=16+r-(a.primaryValue-E)/I*r;return{x:a.primaryX,y:b,value:a.primaryValue}}).filter(a=>null!==a),N=L.map(a=>{if(null===a.secondaryValue)return null;let b=16+r-(a.secondaryValue-G)/J*r;return{x:a.secondaryX,y:b,value:a.secondaryValue}}).filter(a=>null!==a),O=i(M.map(({x:a,y:b})=>({x:a,y:b}))),P=i(N.map(({x:a,y:b})=>({x:a,y:b}))),Q=(0,f.getMetricLabel)(j,k,n,o,u),R=s?"Total Reps":z?`Volume (${w})`:"Total Reps",S=a=>s?h(a):u?0===a?"Machine":`+${h(a)}${x}`:`${h(a)}${x}`,T=a=>s||!z?h(a):`${h(a)}${x}`,U=Array.from(new Set(a.length<=1?[0]:[0,Math.floor((a.length-1)/2),a.length-1])).filter(b=>a[b]),V=p?.label||"",W=Math.min(704,Math.max(56,7*V.length+18)),X=p?Math.min(Math.max(p.x+10,8),720-W-8):0,Y=p?Math.max(8,p.y-24-10):0,Z=C?16+r-(B-E)/I*r:null,$=C?u?`Target +${h(B)}${x}`:`Target ${h(B)}${x}`:"";return(0,b.jsx)("div",{className:"w-full overflow-x-auto",children:(0,b.jsxs)("svg",{viewBox:"0 0 720 280",className:"w-full min-w-[520px]",children:[(0,b.jsx)("rect",{x:0,y:0,width:720,height:280,rx:16,fill:"#0f172a"}),(0,b.jsx)("g",{stroke:"#1f2937",strokeWidth:1,children:[0,.5,1].map(a=>{let c=16+r-a*r;return(0,b.jsx)("line",{x1:64,y1:c,x2:656,y2:c},a)})}),C&&null!==Z&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("line",{x1:64,y1:Z,x2:656,y2:Z,stroke:"#f59e0b",strokeWidth:2,strokeDasharray:"6 6"}),(0,b.jsx)("text",{x:650,y:Math.max(28,Z-6),fill:"#f59e0b",fontSize:"12",textAnchor:"end",children:$})]}),(0,b.jsxs)("g",{fill:"#94a3b8",fontSize:"12",children:[(0,b.jsx)("text",{x:52,y:26,textAnchor:"end",children:S(F)}),(0,b.jsx)("text",{x:52,y:16+r,textAnchor:"end",children:S(E)}),(0,b.jsx)("text",{x:668,y:26,textAnchor:"start",children:h(H)}),(0,b.jsx)("text",{x:668,y:16+r,textAnchor:"start",children:h(G)})]}),O&&(0,b.jsx)("path",{d:O,fill:"none",stroke:"#38bdf8",strokeWidth:3}),P&&(0,b.jsx)("path",{d:P,fill:"none",stroke:"#22c55e",strokeWidth:3}),p&&(0,b.jsxs)("g",{children:[(0,b.jsx)("rect",{x:X,y:Y,width:W,height:24,rx:6,fill:"#111827",stroke:"#374151",strokeWidth:1}),(0,b.jsx)("text",{x:X+9,y:Y+16,fill:"#e2e8f0",fontSize:"12",children:V})]}),(0,b.jsxs)("g",{fill:"#e2e8f0",children:[M.map((a,c)=>(0,b.jsx)("circle",{cx:a.x,cy:a.y,r:4,fill:"#38bdf8",onMouseEnter:()=>q({x:a.x,y:a.y,label:`${Q}: ${S(a.value)}`}),onMouseMove:()=>q({x:a.x,y:a.y,label:`${Q}: ${S(a.value)}`}),onMouseLeave:()=>q(null)},`w-${c}`)),N.map((a,c)=>(0,b.jsx)("circle",{cx:a.x,cy:a.y,r:4,fill:"#22c55e",onMouseEnter:()=>q({x:a.x,y:a.y,label:`${R}: ${T(a.value)}`}),onMouseMove:()=>q({x:a.x,y:a.y,label:`${R}: ${T(a.value)}`}),onMouseLeave:()=>q(null)},`v-${c}`))]}),(0,b.jsx)("g",{fill:"#94a3b8",fontSize:"12",children:U.map(c=>{var d;let e,f=(d=a[c].day,Number.isNaN((e=new Date(`${d}T00:00:00Z`)).getTime())?d:e.toLocaleDateString("en-US",{month:"short",day:"numeric"}));return(0,b.jsx)("text",{x:64+c*K,y:268,textAnchor:"middle",children:f},c)})}),(0,b.jsxs)("g",{fill:"#94a3b8",fontSize:"12",children:[(0,b.jsx)("text",{x:64,y:276,textAnchor:"start",children:Q}),(0,b.jsx)("text",{x:656,y:276,textAnchor:"end",children:R})]})]})})}function k({name:a}){return(0,b.jsxs)("div",{className:"bg-zinc-800 rounded-xl p-4 border border-zinc-700 animate-pulse",children:[(0,b.jsx)("div",{className:"h-5 w-40 bg-zinc-700 rounded mb-4"}),(0,b.jsx)("div",{className:"h-40 bg-zinc-900 rounded-lg border border-zinc-700"}),(0,b.jsxs)("div",{className:"mt-4 flex justify-between",children:[(0,b.jsx)("div",{className:"h-3 w-16 bg-zinc-700 rounded"}),(0,b.jsx)("div",{className:"h-3 w-16 bg-zinc-700 rounded"})]}),(0,b.jsxs)("div",{className:"mt-2 text-xs text-zinc-500",children:["Loading ",a,"..."]})]})}function l({open:a,onClose:h,exerciseNames:i,title:l="Exercise History",targets:m,weightUnit:n,heightUnit:o}){let p=n??e.DEFAULT_WEIGHT_UNIT,q=o??e.DEFAULT_HEIGHT_UNIT,[r,s]=(0,c.useState)("month"),[t,u]=(0,c.useState)(d.EXERCISE_HISTORY_AGGREGATION_MODES.max),[v,w]=(0,c.useState)(!1),[x,y]=(0,c.useState)(null),[z,A]=(0,c.useState)({}),B=(0,c.useMemo)(()=>i.join("|"),[i]);return((0,c.useEffect)(()=>{if(!a)return;let b=new AbortController;return(async()=>{w(!0),y(null);try{let a=new URLSearchParams({range:r});i.forEach(b=>a.append("name",b));let c=await fetch(`/api/exercise-history?${a.toString()}`,{signal:b.signal});if(!c.ok)throw Error("Failed to load exercise history");let d=await c.json();A(d.history||{})}catch(a){if(a?.name==="AbortError")return;y(a?.message||"Failed to load history")}finally{w(!1)}})(),()=>b.abort()},[a,r,B,i]),(0,c.useEffect)(()=>{if(!a)return;let b=a=>{"Escape"===a.key&&h()};return window.addEventListener("keydown",b),()=>window.removeEventListener("keydown",b)},[a,h]),a)?(0,b.jsx)("div",{className:"fixed inset-0 z-50 bg-black/70 flex items-center justify-center p-4",onClick:h,children:(0,b.jsxs)("div",{className:"bg-zinc-900 border border-zinc-700 rounded-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",onClick:a=>a.stopPropagation(),children:[(0,b.jsxs)("div",{className:"p-6 border-b border-zinc-800 flex items-start justify-between gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-2xl font-bold text-white",children:l}),(0,b.jsx)("div",{className:"text-zinc-400 text-sm",children:"Primary metric trends"})]}),(0,b.jsx)("button",{onClick:h,className:"text-zinc-300 hover:text-white bg-zinc-800 hover:bg-zinc-700 px-3 py-2 rounded-lg",children:"Close"})]}),(0,b.jsxs)("div",{className:"p-6 space-y-6",children:[(0,b.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[(0,b.jsx)("div",{className:"flex gap-2",children:["week","month","all"].map(a=>(0,b.jsx)("button",{onClick:()=>s(a),className:`px-3 py-2 rounded-lg text-sm font-semibold border ${r===a?"bg-blue-600 border-blue-500 text-white":"bg-zinc-800 border-zinc-700 text-zinc-300 hover:text-white"}`,children:g[a]},a))}),(0,b.jsx)("div",{className:"flex gap-2",children:Object.values(d.EXERCISE_HISTORY_AGGREGATION_MODES).map(a=>(0,b.jsx)("button",{onClick:()=>u(a),className:`px-3 py-2 rounded-lg text-sm font-semibold border ${t===a?"bg-emerald-600 border-emerald-500 text-white":"bg-zinc-800 border-zinc-700 text-zinc-300 hover:text-white"}`,children:a===d.EXERCISE_HISTORY_AGGREGATION_MODES.max?"Max":"Avg"},a))})]}),v&&(0,b.jsx)("div",{className:"text-zinc-400 text-sm",children:"Loading history..."}),x&&(0,b.jsx)("div",{className:"text-red-400 text-sm",children:x}),!v&&!x&&0===i.length&&(0,b.jsx)("div",{className:"text-zinc-500 text-sm",children:"No exercise selected."}),v&&i.map(a=>(0,b.jsx)(k,{name:a},`loading-${a}`)),!v&&!x&&i.map(a=>{let c=z[a],e=c?.points||[],g=c?.display_mode===d.EXERCISE_HISTORY_DISPLAY_MODES.reps?d.EXERCISE_HISTORY_DISPLAY_MODES.reps:d.EXERCISE_HISTORY_DISPLAY_MODES.weight,h=(0,f.resolvePrimaryMetric)(c?.primary_metric,g===d.EXERCISE_HISTORY_DISPLAY_MODES.reps),i="string"==typeof c?.metric_unit?c.metric_unit:null,k=!!c?.is_machine&&(0,f.isWeightMetric)(h),l=(0,f.getMetricLabel)(h,i,p,q,k),n=m?.[a],o=(0,f.isRepsOnlyMetric)(h)||g===d.EXERCISE_HISTORY_DISPLAY_MODES.reps?n?.reps:n?.weight,r=Number.isFinite(o)&&o>0?o:null,s=(0,f.resolveMetricUnit)(h,i,p,q),u=(0,f.isRepsOnlyMetric)(h)||g===d.EXERCISE_HISTORY_DISPLAY_MODES.reps?"Total Reps":(0,f.isWeightMetric)(h)?`Volume (${s??p})`:"Total Reps";return(0,b.jsxs)("div",{className:"bg-zinc-800 rounded-xl p-4 border border-zinc-700",children:[(0,b.jsxs)("div",{className:"flex flex-wrap items-center justify-between mb-4 gap-2",children:[(0,b.jsx)("div",{className:"text-white text-lg font-semibold",children:a}),(0,b.jsxs)("div",{className:"flex items-center gap-3 text-xs text-zinc-400",children:[(0,b.jsxs)("span",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"h-2 w-2 rounded-full bg-sky-400"}),l]}),(0,b.jsxs)("span",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"h-2 w-2 rounded-full bg-green-400"}),u]}),null!==r&&(0,b.jsxs)("span",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"h-[2px] w-4 border-t border-dashed border-amber-400"}),"Target"]})]})]}),0===e.length?(0,b.jsx)("div",{className:"bg-zinc-900 border border-zinc-700 rounded-lg p-4 text-sm text-zinc-400",children:"No history yet. Finish a workout with this exercise to populate the graph."}):(0,b.jsx)(j,{points:e,weightMode:t,mode:g,primaryMetric:h,metricUnit:i,targetValue:r,isMachine:k,weightUnit:p,heightUnit:q})]},a)})]})]})}):null}a.s(["default",()=>l])}];

//# sourceMappingURL=_c3ef049b._.js.map