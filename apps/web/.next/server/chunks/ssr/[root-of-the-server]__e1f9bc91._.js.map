{"version":3,"sources":["../../../../node_modules/next/src/server/route-modules/app-page/vendored/contexts/hooks-client-context.ts","../../../../node_modules/next/src/server/route-modules/app-page/vendored/contexts/server-inserted-html.ts","../../../../lib/muscle-tags.ts","../../../../lib/stretch-utils.ts","../../../../app/components/StretchSelector.tsx","../../../../app/components/QuickStretchForm.tsx","../../../../lib/workout-bootstrap.ts","../../../../lib/constants.ts","../../../../lib/workout-session.ts","../../../../lib/session-workout.ts","../../../../lib/workout-media.ts","../../../../app/components/WorkoutNavHeader.tsx","../../../../app/components/AutosaveBadge.tsx","../../../../lib/workout-autosave.ts","../../../../app/components/Timer.tsx","../../../../app/components/StretchCard.tsx","../../../../app/components/LoadingScreen.tsx","../../../../app/components/ErrorScreen.tsx","../../../../app/stretches/%5BworkoutName%5D/page.tsx"],"sourcesContent":["module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['contexts'].HooksClientContext\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['contexts'].ServerInsertedHtml\n","export const MUSCLE_GROUP_TAGS = [\n  'lower body compound',\n  'upper body compound',\n  'full body compound',\n  'chest',\n  'back',\n  'shoulders',\n  'biceps',\n  'triceps',\n  'forearms',\n  'core',\n  'lower back',\n  'glutes',\n  'quads',\n  'hamstrings',\n  'calves',\n  'hip flexors',\n  'adductors',\n  'abductors',\n  'unknown',\n] as const;\n\nexport const STRETCH_MUSCLE_TAGS = [...MUSCLE_GROUP_TAGS] as const;\n\nexport const MUSCLE_GROUP_ORDER = [...MUSCLE_GROUP_TAGS];\nexport const STRETCH_MUSCLE_ORDER = [...STRETCH_MUSCLE_TAGS];\n\nexport function normalizeTypeList(\n  value: unknown,\n  allowed?: readonly string[],\n  maxItems = 2\n): string[] {\n  const entries = Array.isArray(value)\n    ? value\n    : typeof value === 'string'\n      ? [value]\n      : [];\n  if (entries.length === 0) return [];\n  const cleaned = entries\n    .map((item) => (typeof item === 'string' ? item.trim().toLowerCase() : ''))\n    .filter(Boolean);\n  const filtered = allowed ? cleaned.filter((tag) => allowed.includes(tag)) : cleaned;\n  const unique: string[] = [];\n  for (const tag of filtered) {\n    if (!unique.includes(tag)) {\n      unique.push(tag);\n    }\n    if (unique.length >= maxItems) break;\n  }\n  return unique;\n}\n\nexport function parseTagJson(\n  value: string | null | undefined,\n  allowed?: readonly string[],\n  maxItems = 2\n): string[] {\n  if (!value) return [];\n  try {\n    const parsed = JSON.parse(value);\n    return normalizeTypeList(parsed, allowed, maxItems);\n  } catch {\n    return [];\n  }\n}\n\nexport function formatTypeLabel(value: string): string {\n  return value\n    .split(' ')\n    .map((word) => (word ? word[0].toUpperCase() + word.slice(1) : word))\n    .join(' ');\n}\n","export function formatStretchTimer(timerSeconds?: number | null): string {\n  if (!timerSeconds || timerSeconds <= 0) {\n    return 'Timer not set';\n  }\n  const minutes = Math.floor(timerSeconds / 60);\n  const seconds = timerSeconds % 60;\n  if (minutes > 0 && seconds === 0) {\n    return `${minutes} min`;\n  }\n  if (minutes > 0) {\n    return `${minutes} min ${seconds} sec`;\n  }\n  return `${timerSeconds} sec`;\n}\n","'use client';\n\nimport { useState, useEffect } from 'react';\nimport QuickStretchForm from './QuickStretchForm';\nimport { STRETCH_MUSCLE_ORDER, STRETCH_MUSCLE_TAGS, formatTypeLabel, parseTagJson } from '@/lib/muscle-tags';\nimport { formatStretchTimer } from '@/lib/stretch-utils';\n\ninterface Stretch {\n  id: number;\n  name: string;\n  timer_seconds?: number | null;\n  muscle_groups: string | null;\n  video_url: string | null;\n  tips: string | null;\n}\n\ninterface StretchSelectorProps {\n  onSelect: (stretch: Stretch) => void;\n  onCancel: () => void;\n  filterType?: 'pre_workout' | 'post_workout';\n  title?: string;\n}\n\nconst FALLBACK_GROUP = 'other';\n\nfunction getMuscleGroups(stretch: Stretch): string[] {\n  return parseTagJson(stretch.muscle_groups, STRETCH_MUSCLE_TAGS);\n}\n\nfunction groupStretchesByMuscleGroup(items: Stretch[]): Array<{ type: string; stretches: Stretch[] }> {\n  const grouped = new Map<string, Stretch[]>();\n  const sorted = [...items].sort((a, b) => a.name.localeCompare(b.name));\n\n  for (const stretch of sorted) {\n    const tags = getMuscleGroups(stretch);\n    const keys = tags.length > 0 ? tags : [FALLBACK_GROUP];\n    for (const key of keys) {\n      const list = grouped.get(key);\n      if (list) {\n        list.push(stretch);\n      } else {\n        grouped.set(key, [stretch]);\n      }\n    }\n  }\n\n  const order = [...STRETCH_MUSCLE_ORDER, FALLBACK_GROUP];\n  const keys = Array.from(grouped.keys()).sort((a, b) => {\n    const aIndex = order.indexOf(a);\n    const bIndex = order.indexOf(b);\n    if (aIndex === -1 && bIndex === -1) return a.localeCompare(b);\n    if (aIndex === -1) return 1;\n    if (bIndex === -1) return -1;\n    return aIndex - bIndex;\n  });\n\n  return keys.map((key) => ({ type: key, stretches: grouped.get(key) || [] }));\n}\n\nexport default function StretchSelector({ onSelect, onCancel, filterType, title }: StretchSelectorProps) {\n  const [stretches, setStretches] = useState<Stretch[]>([]);\n  const [searchQuery, setSearchQuery] = useState('');\n  const [loading, setLoading] = useState(true);\n  const [showCreateForm, setShowCreateForm] = useState(false);\n\n  useEffect(() => {\n    fetchStretches();\n  }, []);\n\n  const fetchStretches = async () => {\n    try {\n      const response = await fetch('/api/stretches');\n      const data = await response.json();\n      setStretches(data.stretches);\n    } catch (error) {\n      console.error('Error fetching stretches:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleCreateStretch = async (stretchData: {\n    name: string;\n    timerSeconds?: number;\n    videoUrl?: string;\n    tips?: string;\n    muscleGroups?: string[];\n  }) => {\n    try {\n      const response = await fetch('/api/stretches', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(stretchData)\n      });\n\n      if (!response.ok) {\n        throw new Error('Failed to create stretch');\n      }\n\n      const data = await response.json();\n      await fetchStretches();\n\n      const muscleGroupsJson = stretchData.muscleGroups?.length\n        ? JSON.stringify(stretchData.muscleGroups)\n        : null;\n\n      const newStretch: Stretch = {\n        id: data.id,\n        name: stretchData.name,\n        timer_seconds: typeof data.timer_seconds === 'number' ? data.timer_seconds : null,\n        muscle_groups: muscleGroupsJson,\n        video_url: stretchData.videoUrl || null,\n        tips: typeof data.tips === 'string' ? data.tips : stretchData.tips || null\n      };\n\n      setShowCreateForm(false);\n      onSelect(newStretch);\n    } catch (error) {\n      console.error('Error creating stretch:', error);\n      alert('Failed to create stretch. Please try again.');\n    }\n  };\n\n  const filteredStretches = stretches.filter((stretch) => {\n    if (!searchQuery) return true;\n    const query = searchQuery.toLowerCase();\n    const name = stretch.name.toLowerCase();\n    const tags = getMuscleGroups(stretch).join(' ').toLowerCase();\n    return name.includes(query) || tags.includes(query);\n  });\n  const groupedStretches = groupStretchesByMuscleGroup(filteredStretches);\n\n  if (showCreateForm) {\n    return (\n      <QuickStretchForm\n        onSubmit={handleCreateStretch}\n        onCancel={() => setShowCreateForm(false)}\n      />\n    );\n  }\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4 z-50\">\n      <div className=\"bg-zinc-800 rounded-lg p-6 max-w-3xl w-full max-h-[90vh] flex flex-col border-2 border-blue-800\">\n        <h2 className=\"text-2xl font-bold text-white mb-4\">\n          {title || (filterType === 'pre_workout' ? 'Select Pre-Workout Stretch' : filterType === 'post_workout' ? 'Select Post-Workout Stretch' : 'Select Stretch')}\n        </h2>\n\n        {/* Search & Create */}\n        <div className=\"mb-4 space-y-3\">\n          <input\n            type=\"text\"\n            value={searchQuery}\n            onChange={(e) => setSearchQuery(e.target.value)}\n            placeholder=\"Search by name or muscle group...\"\n            className=\"w-full bg-zinc-900 text-white px-4 py-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-700\"\n            autoFocus\n          />\n\n          <button\n            onClick={() => setShowCreateForm(true)}\n            className=\"w-full bg-blue-700 hover:bg-blue-800 text-white py-3 rounded-lg font-bold transition-colors\"\n          >\n            + Create New Stretch\n          </button>\n        </div>\n\n        {/* Stretch List */}\n        <div className=\"flex-1 overflow-y-auto mb-4 space-y-2\">\n          {loading ? (\n            <div className=\"text-center text-zinc-400 py-8\">Loading stretches...</div>\n          ) : groupedStretches.length === 0 ? (\n            <div className=\"text-center text-zinc-400 py-8\">\n              {searchQuery ? 'No stretches found' : 'No stretches available'}\n            </div>\n          ) : (\n            <div className=\"space-y-4\">\n              {groupedStretches.map(({ type, stretches: groupStretches }) => (\n                <div key={type} className=\"space-y-2\">\n                  <div className=\"text-xs uppercase tracking-wide text-zinc-400\">\n                    {formatTypeLabel(type)}\n                  </div>\n                  {groupStretches.map((stretch) => {\n                    const muscleGroups = getMuscleGroups(stretch);\n                    return (\n                      <button\n                        key={stretch.id}\n                        onClick={() => onSelect(stretch)}\n                        className=\"w-full bg-zinc-900 hover:bg-zinc-700 text-left p-4 rounded-lg transition-colors border-2 border-zinc-700 hover:border-blue-600\"\n                      >\n                        <div className=\"flex items-start justify-between\">\n                          <div className=\"flex-1\">\n                            <div className=\"text-white font-semibold\">{stretch.name}</div>\n                            <div className=\"text-zinc-400 text-sm mt-1\">\n                              {formatStretchTimer(stretch.timer_seconds)}\n                            </div>\n                            {muscleGroups.length > 0 && (\n                              <div className=\"flex flex-wrap gap-1 mt-2\">\n                                {muscleGroups.map((muscle, idx) => (\n                                  <span\n                                    key={idx}\n                                    className=\"text-xs bg-zinc-700 text-zinc-300 px-2 py-1 rounded\"\n                                  >\n                                    {muscle}\n                                  </span>\n                                ))}\n                              </div>\n                            )}\n                          </div>\n                        </div>\n                      </button>\n                    );\n                  })}\n                </div>\n              ))}\n            </div>\n          )}\n        </div>\n\n        {/* Cancel Button */}\n        <button\n          onClick={onCancel}\n          className=\"w-full bg-zinc-700 hover:bg-zinc-600 text-white py-3 rounded-lg font-semibold transition-colors\"\n        >\n          Cancel\n        </button>\n      </div>\n    </div>\n  );\n}\n","'use client';\n\nimport { useState } from 'react';\nimport { STRETCH_MUSCLE_TAGS, formatTypeLabel } from '@/lib/muscle-tags';\n\ninterface QuickStretchFormProps {\n  onSubmit: (stretch: {\n    name: string;\n    timerSeconds?: number;\n    videoUrl?: string;\n    tips?: string;\n    muscleGroups?: string[];\n  }) => Promise<void>;\n  onCancel: () => void;\n}\n\nexport default function QuickStretchForm({ onSubmit, onCancel }: QuickStretchFormProps) {\n  const [name, setName] = useState('');\n  const [timerSeconds, setTimerSeconds] = useState('');\n  const [videoUrl, setVideoUrl] = useState('');\n  const [tips, setTips] = useState('');\n  const [muscleGroups, setMuscleGroups] = useState<string[]>([]);\n  const [submitting, setSubmitting] = useState(false);\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!name.trim()) return;\n\n    const secondsValue = timerSeconds.trim();\n    const secondsRaw = secondsValue ? Number(secondsValue) : NaN;\n    const resolvedTimerSeconds = Number.isFinite(secondsRaw) && secondsRaw > 0\n      ? Math.round(secondsRaw)\n      : undefined;\n    const parsedMuscleGroups = muscleGroups.map((entry) => entry.trim()).filter(Boolean);\n\n    setSubmitting(true);\n    try {\n      await onSubmit({\n        name: name.trim(),\n        timerSeconds: resolvedTimerSeconds,\n        videoUrl: videoUrl.trim() || undefined,\n        tips: tips.trim() || undefined,\n        muscleGroups: parsedMuscleGroups.length ? parsedMuscleGroups : undefined\n      });\n    } finally {\n      setSubmitting(false);\n    }\n  };\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4 z-50\">\n      <div className=\"bg-zinc-800 rounded-lg p-6 max-w-md w-full border-2 border-blue-700\">\n        <h2 className=\"text-2xl font-bold text-white mb-4\">Create New Stretch</h2>\n\n        <form onSubmit={handleSubmit} className=\"space-y-4\">\n          <div>\n            <label className=\"text-zinc-300 text-sm font-semibold block mb-2\">\n              Stretch Name <span className=\"text-red-500\">*</span>\n            </label>\n            <input\n              type=\"text\"\n              value={name}\n              onChange={(e) => setName(e.target.value)}\n              placeholder=\"e.g., Hamstring Stretch\"\n              className=\"w-full bg-zinc-900 text-white px-4 py-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600\"\n              required\n              autoFocus\n            />\n          </div>\n\n          <div>\n            <label className=\"text-zinc-300 text-sm font-semibold block mb-2\">\n              Timer (seconds)\n            </label>\n            <input\n              type=\"number\"\n              min=\"1\"\n              step=\"1\"\n              value={timerSeconds}\n              onChange={(e) => setTimerSeconds(e.target.value)}\n              placeholder=\"e.g., 30\"\n              className=\"w-full bg-zinc-900 text-white px-4 py-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600\"\n            />\n          </div>\n\n          <div>\n            <label className=\"text-zinc-300 text-sm font-semibold block mb-2\">\n              Muscle Groups <span className=\"text-zinc-500\">(up to 2)</span>\n            </label>\n            <div className=\"rounded-lg border border-zinc-700 bg-zinc-900 px-3 py-2\">\n              {muscleGroups.length === 0 ? (\n                <span className=\"text-zinc-500 text-sm\">Select muscle groups below</span>\n              ) : (\n                <div className=\"flex flex-wrap gap-2\">\n                  {muscleGroups.map((group) => (\n                  <button\n                    key={group}\n                    type=\"button\"\n                    onClick={() => setMuscleGroups((prev) => prev.filter((tag) => tag !== group))}\n                    className=\"inline-flex items-center gap-1 rounded-full border border-blue-600/40 bg-blue-700/30 px-3 py-1 text-xs font-semibold text-blue-100 transition hover:border-blue-400 hover:bg-blue-600/60\"\n                  >\n                      {formatTypeLabel(group)}\n                      <span aria-hidden>√ó</span>\n                    </button>\n                  ))}\n                </div>\n              )}\n            </div>\n            <div className=\"mt-3\">\n              <div className=\"relative\">\n                <select\n                  value=\"\"\n                  onChange={(e) => {\n                    const nextValue = e.target.value;\n                    if (!nextValue) return;\n                    setMuscleGroups((prev) => {\n                      if (prev.includes(nextValue)) return prev;\n                      if (prev.length >= 2) return prev;\n                      return [...prev, nextValue];\n                    });\n                    e.currentTarget.value = '';\n                  }}\n                  className=\"w-full appearance-none bg-zinc-900 text-white px-4 py-2 pr-10 rounded-lg border border-zinc-700 focus:outline-none focus:ring-2 focus:ring-blue-600\"\n                >\n                  <option value=\"\" disabled>\n                    Add a muscle group...\n                  </option>\n                  {STRETCH_MUSCLE_TAGS.filter((group) => group !== 'unknown').map((group) => (\n                    <option key={group} value={group}>\n                      {formatTypeLabel(group)}\n                    </option>\n                  ))}\n                </select>\n                <span className=\"pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 text-zinc-400\">\n                  ‚ñæ\n                </span>\n              </div>\n              <p className=\"mt-2 text-xs text-zinc-500\">\n                Choose up to two muscle groups.\n              </p>\n            </div>\n          </div>\n\n          <div>\n            <label className=\"text-zinc-300 text-sm font-semibold block mb-2\">\n              Video URL\n            </label>\n            <input\n              type=\"url\"\n              value={videoUrl}\n              onChange={(e) => setVideoUrl(e.target.value)}\n              placeholder=\"https://youtube.com/...\"\n              className=\"w-full bg-zinc-900 text-white px-4 py-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600\"\n            />\n          </div>\n\n          <div>\n            <label className=\"text-zinc-300 text-sm font-semibold block mb-2\">\n              Tips\n            </label>\n            <textarea\n              value={tips}\n              onChange={(e) => setTips(e.target.value)}\n              placeholder=\"Form tips, cues, etc.\"\n              rows={3}\n              className=\"w-full bg-zinc-900 text-white px-4 py-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 resize-none\"\n            />\n          </div>\n\n          <p className=\"text-xs text-zinc-400\">\n            Duration, video URL, tips, and muscle groups will be auto-filled with AI if empty.\n          </p>\n\n          <div className=\"grid grid-cols-2 gap-3 pt-2\">\n            <button\n              type=\"button\"\n              onClick={onCancel}\n              className=\"bg-zinc-700 hover:bg-zinc-600 text-white py-3 rounded-lg font-semibold transition-colors\"\n            >\n              Cancel\n            </button>\n            <button\n              type=\"submit\"\n              disabled={!name.trim() || submitting}\n              className=\"bg-blue-700 hover:bg-blue-800 disabled:bg-blue-900 disabled:cursor-not-allowed text-white py-3 rounded-lg font-bold transition-colors\"\n            >\n              {submitting ? 'Creating...' : 'Create & Select'}\n            </button>\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n}\n","import type { WorkoutPlan, WorkoutExerciseLog } from '@/lib/types';\nimport type { HeightUnit, WeightUnit } from '@/lib/units';\n\nexport type BootstrapUserSettings = {\n  restTimeSeconds: number;\n  supersetRestSeconds: number;\n  weightUnit: WeightUnit;\n  heightUnit: HeightUnit;\n};\n\nexport type LastSetSummary =\n  | (WorkoutExerciseLog & { completed_at?: string; matched_role?: string })\n  | null;\n\nexport type RoutineMeta = {\n  id?: number | null;\n  name: string;\n  updatedAt?: string | null;\n  checksum?: string | null;\n};\n\nexport type WorkoutBootstrapPayload = {\n  workout: WorkoutPlan;\n  settings: BootstrapUserSettings;\n  lastSetSummaries: Record<string, LastSetSummary>;\n  lastWorkoutReport: string | null;\n  routineMeta?: RoutineMeta;\n};\n\ntype WorkoutBootstrapCacheEntry = WorkoutBootstrapPayload & {\n  cachedAt: string;\n  editVersionId?: string | null;\n  editVersionName?: string | null;\n};\n\nconst BOOTSTRAP_PREFIX = 'workout_bootstrap';\nconst EDIT_PREFIX = 'routine_edit_version';\n\nfunction buildCacheKey(workoutName: string, routineId?: string | null): string {\n  const safeName = encodeURIComponent(workoutName);\n  const safeRoutine = routineId ? encodeURIComponent(routineId) : 'default';\n  return `${BOOTSTRAP_PREFIX}:${safeName}:${safeRoutine}`;\n}\n\nfunction buildEditKey(scope: string): string {\n  return `${EDIT_PREFIX}:${scope}`;\n}\n\nfunction getEditVersionById(routineId?: string | number | null): string | null {\n  if (typeof window === 'undefined' || routineId === null || routineId === undefined) return null;\n  const key = buildEditKey(`id:${routineId}`);\n  return localStorage.getItem(key) ?? '0';\n}\n\nfunction getEditVersionByName(workoutName?: string | null): string | null {\n  if (typeof window === 'undefined' || !workoutName) return null;\n  const key = buildEditKey(`name:${encodeURIComponent(workoutName)}`);\n  return localStorage.getItem(key) ?? '0';\n}\n\nfunction isCacheEntryValid(\n  entry: WorkoutBootstrapCacheEntry,\n  workoutName: string,\n  routineId?: string | null\n): boolean {\n  const currentIdVersion = getEditVersionById(routineId);\n  if (entry.editVersionId && currentIdVersion && entry.editVersionId !== currentIdVersion) {\n    return false;\n  }\n  const currentNameVersion = getEditVersionByName(workoutName);\n  if (entry.editVersionName && currentNameVersion && entry.editVersionName !== currentNameVersion) {\n    return false;\n  }\n  return true;\n}\n\nexport function loadWorkoutBootstrapCache(params: {\n  workoutName: string;\n  routineId?: string | null;\n}): WorkoutBootstrapCacheEntry | null {\n  if (typeof window === 'undefined') return null;\n  const { workoutName, routineId } = params;\n  const keys = [buildCacheKey(workoutName, routineId)];\n  if (routineId) {\n    keys.push(buildCacheKey(workoutName, null));\n  }\n\n  for (const key of keys) {\n    const stored = sessionStorage.getItem(key);\n    if (!stored) continue;\n    try {\n      const entry = JSON.parse(stored) as WorkoutBootstrapCacheEntry;\n      if (!isCacheEntryValid(entry, workoutName, routineId)) {\n        sessionStorage.removeItem(key);\n        continue;\n      }\n      return entry;\n    } catch (error) {\n      console.error('Failed to parse workout bootstrap cache:', error);\n      sessionStorage.removeItem(key);\n    }\n  }\n\n  return null;\n}\n\nexport function saveWorkoutBootstrapCache(params: {\n  workoutName: string;\n  routineId?: string | null;\n  payload: WorkoutBootstrapPayload;\n}): void {\n  if (typeof window === 'undefined') return;\n  const { workoutName, routineId, payload } = params;\n  const entry: WorkoutBootstrapCacheEntry = {\n    ...payload,\n    cachedAt: new Date().toISOString(),\n    editVersionId: getEditVersionById(routineId),\n    editVersionName: getEditVersionByName(workoutName),\n  };\n  const serialized = JSON.stringify(entry);\n  sessionStorage.setItem(buildCacheKey(workoutName, routineId), serialized);\n  if (routineId) {\n    sessionStorage.setItem(buildCacheKey(workoutName, null), serialized);\n  }\n}\n\nexport function clearWorkoutBootstrapCache(params: {\n  workoutName: string;\n  routineId?: string | null;\n}): void {\n  if (typeof window === 'undefined') return;\n  const { workoutName, routineId } = params;\n  sessionStorage.removeItem(buildCacheKey(workoutName, routineId));\n  if (routineId) {\n    sessionStorage.removeItem(buildCacheKey(workoutName, null));\n  }\n}\n\nexport function bumpRoutineEditVersion(params: {\n  routineId?: string | number | null;\n  routineName?: string | null;\n}): void {\n  if (typeof window === 'undefined') return;\n  const stamp = String(Date.now());\n  if (params.routineId !== null && params.routineId !== undefined) {\n    localStorage.setItem(buildEditKey(`id:${params.routineId}`), stamp);\n  }\n  if (params.routineName) {\n    localStorage.setItem(buildEditKey(`name:${encodeURIComponent(params.routineName)}`), stamp);\n  }\n}\n\nexport function invalidateWorkoutBootstrapCache(params: {\n  routineId?: string | number | null;\n  routineName?: string | null;\n}): void {\n  bumpRoutineEditVersion(params);\n  if (!params.routineName) return;\n  clearWorkoutBootstrapCache({\n    workoutName: params.routineName,\n    routineId: params.routineId ? String(params.routineId) : null,\n  });\n}\n","// lib/constants.ts\n\n// Exercise type identifiers used across workouts, routines, and storage.\nexport const EXERCISE_TYPES = {\n  single: 'single',\n  b2b: 'b2b',\n  circuit: 'circuit',\n} as const;\n\nexport type ExerciseType = typeof EXERCISE_TYPES[keyof typeof EXERCISE_TYPES];\n\n// Exercise history display modes (primary metric axis).\nexport const EXERCISE_HISTORY_DISPLAY_MODES = {\n  weight: 'weight',\n  reps: 'reps',\n} as const;\n\nexport type ExerciseHistoryDisplayMode =\n  typeof EXERCISE_HISTORY_DISPLAY_MODES[keyof typeof EXERCISE_HISTORY_DISPLAY_MODES];\n\n// Exercise history aggregation modes (how points are summarized).\nexport const EXERCISE_HISTORY_AGGREGATION_MODES = {\n  max: 'max',\n  avg: 'avg',\n} as const;\n\nexport type ExerciseHistoryAggregationMode =\n  typeof EXERCISE_HISTORY_AGGREGATION_MODES[keyof typeof EXERCISE_HISTORY_AGGREGATION_MODES];\n\n// Exercise tracking primary metrics (how we interpret the numeric value).\nexport const EXERCISE_PRIMARY_METRICS = {\n  weight: 'weight',\n  height: 'height',\n  time: 'time',\n  distance: 'distance',\n  repsOnly: 'reps_only',\n} as const;\n\nexport type ExercisePrimaryMetric =\n  typeof EXERCISE_PRIMARY_METRICS[keyof typeof EXERCISE_PRIMARY_METRICS];\n\n// Workout session modes (preview-only target selection).\nexport const SESSION_MODES = {\n  progress: 'progress',\n  maintenance: 'maintenance',\n  light: 'light',\n} as const;\n\nexport type SessionMode = typeof SESSION_MODES[keyof typeof SESSION_MODES];\n\nexport const SESSION_MODE_LABELS: Record<SessionMode, string> = {\n  [SESSION_MODES.progress]: 'Progress',\n  [SESSION_MODES.maintenance]: 'Maintenance',\n  [SESSION_MODES.light]: 'Light',\n};\n\nexport const SESSION_MODE_DESCRIPTIONS: Record<SessionMode, string> = {\n  [SESSION_MODES.progress]: 'Push for small, steady improvements.',\n  [SESSION_MODES.maintenance]: 'Hold steady and focus on form.',\n  [SESSION_MODES.light]: 'Easy effort today.',\n};\n","// lib/workout-session.ts\n// Client-side storage for current workout session\n\nimport { EXERCISE_TYPES, SESSION_MODES, type ExercisePrimaryMetric, type SessionMode } from '@/lib/constants';\n\nexport interface SessionExerciseData {\n  name: string;\n  type: typeof EXERCISE_TYPES.single | typeof EXERCISE_TYPES.b2b;\n  isMachine?: boolean;\n  primaryMetric?: ExercisePrimaryMetric;\n  metricUnit?: string | null;\n  warmup?: { weight: number; reps: number };\n  sets: Array<{ weight: number; reps: number }>;\n  b2bPartner?: {\n    name: string;\n    isMachine?: boolean;\n    primaryMetric?: ExercisePrimaryMetric;\n    metricUnit?: string | null;\n    warmup?: { weight: number; reps: number };\n    sets: Array<{ weight: number; reps: number }>;\n  };\n}\n\nexport interface WorkoutSessionData {\n  workoutName: string;\n  routineId?: number | null;\n  sessionId?: number | null;\n  startTime: string;\n  exercises: SessionExerciseData[];\n  cardio?: {\n    type: string;\n    time: string;\n    speed?: number;\n    incline?: number;\n  };\n}\n\nconst STORAGE_KEY = 'current_workout_session';\n\nexport function isSessionMode(value: string | null | undefined): value is SessionMode {\n  return value === SESSION_MODES.progress\n    || value === SESSION_MODES.maintenance\n    || value === SESSION_MODES.light;\n}\n\nexport function resolveSessionMode(\n  value: string | null | undefined,\n  fallback: SessionMode = SESSION_MODES.progress\n): SessionMode {\n  return isSessionMode(value) ? value : fallback;\n}\n\nexport function initWorkoutSession(\n  workoutName: string,\n  routineId?: number | null\n): void {\n  const session: WorkoutSessionData = {\n    workoutName,\n    routineId: routineId ?? null,\n    sessionId: null,\n    startTime: new Date().toISOString(),\n    exercises: [],\n  };\n  if (typeof window !== 'undefined') {\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(session));\n  }\n}\n\nexport function ensureWorkoutSession(\n  workoutName: string,\n  routineId?: number | null\n): void {\n  const existing = getWorkoutSession();\n  const normalizedRoutineId = routineId ?? null;\n  if (!existing) {\n    initWorkoutSession(workoutName, normalizedRoutineId);\n    return;\n  }\n  if (existing.workoutName !== workoutName || (existing.routineId ?? null) !== normalizedRoutineId) {\n    initWorkoutSession(workoutName, normalizedRoutineId);\n  }\n}\n\nexport function getWorkoutSession(): WorkoutSessionData | null {\n  if (typeof window === 'undefined') return null;\n  const data = localStorage.getItem(STORAGE_KEY);\n  if (!data) return null;\n  const parsed = JSON.parse(data) as WorkoutSessionData;\n  const rawRoutineId = (parsed as { routineId?: unknown }).routineId;\n  const nextRoutineId = typeof rawRoutineId === 'number' ? rawRoutineId : Number(rawRoutineId);\n  parsed.routineId = Number.isFinite(nextRoutineId) ? nextRoutineId : null;\n  const rawSessionId = (parsed as { sessionId?: unknown }).sessionId;\n  const nextSessionId = typeof rawSessionId === 'number' ? rawSessionId : Number(rawSessionId);\n  parsed.sessionId = Number.isFinite(nextSessionId) ? nextSessionId : null;\n  return parsed;\n}\n\nexport function setWorkoutSessionId(sessionId: number): void {\n  if (typeof window === 'undefined') return;\n  const session = getWorkoutSession();\n  if (!session) return;\n  if (session.sessionId === sessionId) return;\n  session.sessionId = sessionId;\n  localStorage.setItem(STORAGE_KEY, JSON.stringify(session));\n}\n\nexport function addExerciseToSession(exercise: SessionExerciseData): void {\n  const session = getWorkoutSession();\n  if (!session) return;\n\n  session.exercises.push(exercise);\n  if (typeof window !== 'undefined') {\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(session));\n  }\n}\n\nexport function addCardioToSession(cardio: { type: string; time: string; speed?: number; incline?: number }): void {\n  const session = getWorkoutSession();\n  if (!session) return;\n\n  session.cardio = cardio;\n  if (typeof window !== 'undefined') {\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(session));\n  }\n}\n\nexport function clearWorkoutSession(): void {\n  if (typeof window !== 'undefined') {\n    localStorage.removeItem(STORAGE_KEY);\n  }\n}\n","import type { WorkoutPlan } from '@/lib/types';\n\nconst SESSION_PREFIX = 'session_workout_override';\nconst WARNING_PREFIX = 'session_workout_change_ack';\nconst TARGETS_META_PREFIX = 'session_workout_targets_meta';\n\ntype TargetsSource = 'ai' | 'fallback' | null;\n\nexport type SessionTargetsMeta = {\n  encouragement: string | null;\n  goalSummary: string | null;\n  trendSummary: string | null;\n  source: TargetsSource;\n  sessionMode?: string | null;\n};\n\nfunction buildKey(prefix: string, workoutName: string, routineId?: string | null): string {\n  const safeName = encodeURIComponent(workoutName);\n  const safeRoutine = routineId ? encodeURIComponent(routineId) : 'default';\n  return `${prefix}:${safeName}:${safeRoutine}`;\n}\n\nexport function loadSessionWorkout(workoutName: string, routineId?: string | null): WorkoutPlan | null {\n  if (typeof window === 'undefined') return null;\n  const key = buildKey(SESSION_PREFIX, workoutName, routineId);\n  const stored = sessionStorage.getItem(key);\n  if (!stored) return null;\n  try {\n    return JSON.parse(stored) as WorkoutPlan;\n  } catch (error) {\n    console.error('Failed to parse session workout override:', error);\n    return null;\n  }\n}\n\nexport function saveSessionWorkout(plan: WorkoutPlan, routineId?: string | null): void {\n  if (typeof window === 'undefined') return;\n  const key = buildKey(SESSION_PREFIX, plan.name, routineId);\n  sessionStorage.setItem(key, JSON.stringify(plan));\n}\n\nexport function clearSessionWorkout(workoutName: string, routineId?: string | null): void {\n  if (typeof window === 'undefined') return;\n  const key = buildKey(SESSION_PREFIX, workoutName, routineId);\n  sessionStorage.removeItem(key);\n}\n\nexport function loadSessionTargetsMeta(\n  workoutName: string,\n  routineId?: string | null\n): SessionTargetsMeta | null {\n  if (typeof window === 'undefined') return null;\n  const key = buildKey(TARGETS_META_PREFIX, workoutName, routineId);\n  const stored = sessionStorage.getItem(key);\n  if (!stored) return null;\n  try {\n    return JSON.parse(stored) as SessionTargetsMeta;\n  } catch (error) {\n    console.error('Failed to parse session targets meta:', error);\n    return null;\n  }\n}\n\nexport function saveSessionTargetsMeta(\n  workoutName: string,\n  routineId: string | null | undefined,\n  meta: SessionTargetsMeta | null\n): void {\n  if (typeof window === 'undefined') return;\n  const key = buildKey(TARGETS_META_PREFIX, workoutName, routineId);\n  if (!meta) {\n    sessionStorage.removeItem(key);\n    return;\n  }\n  sessionStorage.setItem(key, JSON.stringify(meta));\n}\n\nexport function clearSessionTargetsMeta(workoutName: string, routineId?: string | null): void {\n  if (typeof window === 'undefined') return;\n  const key = buildKey(TARGETS_META_PREFIX, workoutName, routineId);\n  sessionStorage.removeItem(key);\n}\n\nexport function hasChangeWarningAck(workoutName: string, routineId?: string | null): boolean {\n  if (typeof window === 'undefined') return false;\n  const key = buildKey(WARNING_PREFIX, workoutName, routineId);\n  return sessionStorage.getItem(key) === '1';\n}\n\nexport function acknowledgeChangeWarning(workoutName: string, routineId?: string | null): void {\n  if (typeof window === 'undefined') return;\n  const key = buildKey(WARNING_PREFIX, workoutName, routineId);\n  sessionStorage.setItem(key, '1');\n}\n","const FALLBACK_FORM_TIPS = 'No form tips yet.';\n\nexport function getFormTips(tips?: string | null): string {\n  if (typeof tips !== 'string') {\n    return FALLBACK_FORM_TIPS;\n  }\n\n  const trimmed = tips.trim();\n  return trimmed.length > 0 ? trimmed : FALLBACK_FORM_TIPS;\n}\n\nexport function getVideoUrl(name?: string | null, videoUrl?: string | null): string {\n  if (typeof videoUrl === 'string' && videoUrl.trim().length > 0) {\n    return videoUrl.trim();\n  }\n\n  const baseName = typeof name === 'string' && name.trim().length > 0 ? name.trim() : 'exercise';\n  const query = `${baseName} form`;\n  return `https://www.youtube.com/results?search_query=${encodeURIComponent(query)}`;\n}\n","'use client';\n\nimport { useRouter } from 'next/navigation';\nimport Link from 'next/link';\n\ninterface WorkoutNavHeaderProps {\n  exitUrl: string;\n  previousUrl: string | null;\n  onPrevious?: () => void; // Optional callback for internal state changes\n  skipUrl?: string; // Optional skip button on right side\n  skipLabel?: string;\n  onSkip?: () => void;\n  // For review mode - show Next instead of Skip\n  nextLabel?: string;\n  onNext?: () => void;\n}\n\n/**\n * Unified navigation header for workout flow\n * Shows exit button and previous button on left, optional skip/next on right\n */\nexport default function WorkoutNavHeader({\n  exitUrl,\n  previousUrl,\n  onPrevious,\n  skipUrl,\n  skipLabel = 'Skip',\n  onSkip,\n  nextLabel = 'Next',\n  onNext,\n}: WorkoutNavHeaderProps) {\n  const router = useRouter();\n\n  const handlePrevious = () => {\n    if (onPrevious) {\n      // Use callback for internal navigation (within same page)\n      onPrevious();\n    } else if (previousUrl) {\n      // Navigate to previous URL\n      router.push(previousUrl);\n    }\n  };\n\n  const handleSkip = () => {\n    if (onSkip) {\n      onSkip();\n    } else if (skipUrl) {\n      router.push(skipUrl);\n    }\n  };\n\n  const canGoPrevious = !!previousUrl || !!onPrevious;\n  const showSkip = skipUrl || onSkip;\n  const showNext = !!onNext;\n\n  return (\n    <div className=\"flex justify-between items-center mb-6\">\n      {/* Left side: Exit and Previous */}\n      <div className=\"flex items-center gap-4\">\n        <Link\n          href={exitUrl}\n          className=\"text-red-400 hover:text-red-300 font-medium\"\n        >\n          Exit\n        </Link>\n        <button\n          onClick={handlePrevious}\n          disabled={!canGoPrevious}\n          className={`font-medium ${\n            canGoPrevious\n              ? 'text-blue-400 hover:text-blue-300'\n              : 'text-zinc-600 cursor-not-allowed'\n          }`}\n        >\n          ‚Üê Previous\n        </button>\n      </div>\n\n      {/* Right side: Next (review mode) or Skip */}\n      {showNext ? (\n        <button\n          onClick={onNext}\n          className=\"text-blue-400 hover:text-blue-300 font-medium\"\n        >\n          {nextLabel} ‚Üí\n        </button>\n      ) : showSkip ? (\n        <button\n          onClick={handleSkip}\n          className=\"text-zinc-400 hover:text-zinc-300\"\n        >\n          {skipLabel} ‚Üí\n        </button>\n      ) : null}\n    </div>\n  );\n}\n","'use client';\n\nimport { useEffect, useMemo, useState } from 'react';\n\ntype AutosaveDetail = {\n  status: 'saving' | 'success' | 'error';\n  eventType?: string;\n  at?: number;\n};\n\ntype AutosaveState = Omit<AutosaveDetail, 'status'> & {\n  status: AutosaveDetail['status'] | 'idle';\n};\n\nexport default function AutosaveBadge({ className = '' }: { className?: string }) {\n  const [state, setState] = useState<AutosaveState>({ status: 'idle' });\n\n  useEffect(() => {\n    const handler = (event: Event) => {\n      const detail = (event as CustomEvent<AutosaveDetail>).detail;\n      if (!detail) return;\n      setState({ ...detail });\n    };\n\n    window.addEventListener('workout-autosave', handler);\n    return () => window.removeEventListener('workout-autosave', handler);\n  }, []);\n\n  const timeLabel = useMemo(() => {\n    if (!state.at) return '';\n    return new Date(state.at).toLocaleTimeString('en-US', {\n      hour: 'numeric',\n      minute: '2-digit',\n    });\n  }, [state.at]);\n\n  const { label, badgeClass } = useMemo(() => {\n    switch (state.status) {\n      case 'saving':\n        return { label: 'Autosave: saving‚Ä¶', badgeClass: 'text-amber-300 border-amber-500/40' };\n      case 'success':\n        return { label: `Autosave: saved ${timeLabel}`, badgeClass: 'text-emerald-300 border-emerald-500/40' };\n      case 'error':\n        return { label: `Autosave: failed ${timeLabel}`, badgeClass: 'text-red-300 border-red-500/40' };\n      default:\n        return { label: 'Autosave: idle', badgeClass: 'text-zinc-400 border-zinc-600/40' };\n    }\n  }, [state.status, timeLabel]);\n\n  return (\n    <div\n      className={`rounded-full border px-3 py-1 text-xs font-semibold ${badgeClass} ${className}`}\n      aria-live=\"polite\"\n    >\n      {label}\n    </div>\n  );\n}\n","import { getWorkoutSession, setWorkoutSessionId } from '@/lib/workout-session';\n\ntype AutosaveEvent =\n  | {\n      type: 'start' | 'stretch' | 'exercise_skip' | 'exercise_end';\n      phase?: 'pre' | 'post';\n      index?: number;\n    }\n  | {\n      type: 'single_set';\n      exerciseName: string;\n      setIndex: number;\n      weight: number;\n      reps: number;\n      isWarmup?: boolean;\n    }\n  | {\n      type: 'b2b_set';\n      exerciseName: string;\n      partnerName: string;\n      setIndex: number;\n      weight: number;\n      reps: number;\n      partnerWeight: number;\n      partnerReps: number;\n    };\n\ntype AutosaveStatus = 'saving' | 'success' | 'error';\n\nfunction emitAutosave(status: AutosaveStatus, eventType: string) {\n  if (typeof window === 'undefined') return;\n  window.dispatchEvent(new CustomEvent('workout-autosave', {\n    detail: {\n      status,\n      eventType,\n      at: Date.now(),\n    }\n  }));\n}\n\nexport async function autosaveWorkout(event: AutosaveEvent): Promise<void> {\n  if (typeof window === 'undefined') return;\n  const session = getWorkoutSession();\n  if (!session) return;\n\n  emitAutosave('saving', event.type);\n\n  try {\n    const response = await fetch('/api/workout-autosave', {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({\n        sessionId: session.sessionId ?? null,\n        workoutName: session.workoutName,\n        routineId: session.routineId ?? null,\n        startTime: session.startTime,\n        event,\n      }),\n    });\n\n    if (!response.ok) {\n      emitAutosave('error', event.type);\n      return;\n    }\n\n    const data = await response.json();\n    if (typeof data?.sessionId === 'number') {\n      setWorkoutSessionId(data.sessionId);\n    }\n    emitAutosave('success', event.type);\n  } catch (error) {\n    console.error('Autosave failed:', error);\n    emitAutosave('error', event.type);\n  }\n}\n","'use client';\n\nimport { useState, useEffect, useCallback, useRef } from 'react';\n\ninterface TimerProps {\n  timerSeconds: number; // Explicit timer value in seconds, 0 means no timer\n  onComplete?: () => void;\n}\n\nexport default function Timer({ timerSeconds, onComplete }: TimerProps) {\n  // Don't render anything if no timer is needed\n  if (!timerSeconds || timerSeconds <= 0) {\n    return null;\n  }\n\n  return <TimerContent timerSeconds={timerSeconds} onComplete={onComplete} />;\n}\n\nfunction TimerContent({ timerSeconds, onComplete }: { timerSeconds: number; onComplete?: () => void }) {\n  const totalSeconds = timerSeconds;\n  const [secondsLeft, setSecondsLeft] = useState(totalSeconds);\n  const [isRunning, setIsRunning] = useState(false);\n  const [hasStarted, setHasStarted] = useState(false);\n  const endTimeRef = useRef<number | null>(null);\n  const didCompleteRef = useRef(false);\n\n  useEffect(() => {\n    // Reset timer when timerSeconds changes\n    setSecondsLeft(timerSeconds);\n    setIsRunning(false);\n    setHasStarted(false);\n    endTimeRef.current = null;\n    didCompleteRef.current = false;\n  }, [timerSeconds]);\n\n  const updateRemaining = useCallback(() => {\n    if (!endTimeRef.current) return;\n    const remainingMs = endTimeRef.current - Date.now();\n    const nextSeconds = Math.max(0, Math.ceil(remainingMs / 1000));\n    setSecondsLeft(nextSeconds);\n    if (nextSeconds === 0) {\n      setIsRunning(false);\n      if (!didCompleteRef.current) {\n        didCompleteRef.current = true;\n        onComplete?.();\n      }\n    }\n  }, [onComplete]);\n\n  useEffect(() => {\n    if (!isRunning) return;\n    updateRemaining();\n    const interval = setInterval(updateRemaining, 250);\n    return () => clearInterval(interval);\n  }, [isRunning, updateRemaining]);\n\n  useEffect(() => {\n    const handleVisibility = () => {\n      if (document.visibilityState === 'visible') {\n        updateRemaining();\n      }\n    };\n    const handleFocus = () => {\n      updateRemaining();\n    };\n\n    document.addEventListener('visibilitychange', handleVisibility);\n    window.addEventListener('focus', handleFocus);\n\n    return () => {\n      document.removeEventListener('visibilitychange', handleVisibility);\n      window.removeEventListener('focus', handleFocus);\n    };\n  }, [updateRemaining]);\n\n  const handleStart = useCallback(() => {\n    const baseSeconds = secondsLeft === 0 ? totalSeconds : secondsLeft;\n    if (baseSeconds <= 0) return;\n    if (secondsLeft === 0) {\n      setSecondsLeft(baseSeconds);\n    }\n    didCompleteRef.current = false;\n    endTimeRef.current = Date.now() + baseSeconds * 1000;\n    setIsRunning(true);\n    setHasStarted(true);\n  }, [secondsLeft, totalSeconds]);\n\n  const handlePause = useCallback(() => {\n    if (endTimeRef.current) {\n      const remainingMs = endTimeRef.current - Date.now();\n      const nextSeconds = Math.max(0, Math.ceil(remainingMs / 1000));\n      setSecondsLeft(nextSeconds);\n    }\n    endTimeRef.current = null;\n    setIsRunning(false);\n  }, []);\n\n  const handleReset = useCallback(() => {\n    setIsRunning(false);\n    setSecondsLeft(totalSeconds);\n    setHasStarted(false);\n    endTimeRef.current = null;\n    didCompleteRef.current = false;\n  }, [totalSeconds]);\n\n  // Format seconds as MM:SS\n  const formatTime = (seconds: number): string => {\n    const mins = Math.floor(seconds / 60);\n    const secs = seconds % 60;\n    return `${mins}:${secs.toString().padStart(2, '0')}`;\n  };\n\n  return (\n    <div className=\"bg-zinc-900 rounded-lg p-4 mb-4\">\n      {/* Timer Display */}\n      <div className=\"text-center mb-4\">\n        <div className={`text-5xl font-bold font-mono ${\n          secondsLeft <= 5 && isRunning ? 'text-red-500 animate-pulse' : 'text-white'\n        }`}>\n          {formatTime(secondsLeft)}\n        </div>\n        {secondsLeft === 0 && hasStarted && (\n          <div className=\"text-blue-300 text-lg font-semibold mt-2\">\n            Complete!\n          </div>\n        )}\n      </div>\n\n      {/* Control Buttons */}\n      <div className=\"flex gap-3 justify-center\">\n        {!isRunning ? (\n          <button\n            onClick={handleStart}\n            className=\"bg-blue-800 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-semibold transition-colors flex items-center gap-2\"\n          >\n            <span className=\"text-xl\">‚ñ∂</span>\n            {hasStarted && secondsLeft > 0 ? 'Resume' : secondsLeft === 0 ? 'Restart' : 'Start Timer'}\n          </button>\n        ) : (\n          <button\n            onClick={handlePause}\n            className=\"bg-yellow-600 hover:bg-yellow-700 text-white px-6 py-3 rounded-lg font-semibold transition-colors flex items-center gap-2\"\n          >\n            <span className=\"text-xl\">‚è∏</span>\n            Pause\n          </button>\n        )}\n        {hasStarted && (\n          <button\n            onClick={handleReset}\n            className=\"bg-zinc-700 hover:bg-zinc-600 text-white px-4 py-3 rounded-lg font-semibold transition-colors\"\n          >\n            Reset\n          </button>\n        )}\n      </div>\n    </div>\n  );\n}\n","'use client';\n\nimport Timer from './Timer';\nimport { formatStretchTimer } from '@/lib/stretch-utils';\nimport { getFormTips, getVideoUrl } from '@/lib/workout-media';\n\nexport interface StretchData {\n  name: string;\n  timerSeconds?: number;\n  tips?: string | null;\n  videoUrl?: string | null;\n}\n\ninterface StretchCardProps {\n  stretch: StretchData;\n  /** Unique key for timer reset when stretch changes */\n  timerKey?: number;\n  /** Border color variant */\n  variant?: 'pre' | 'post';\n}\n\n/**\n * Reusable stretch card component for displaying stretch information.\n * Used in both pre-workout and post-workout stretch pages.\n */\nexport default function StretchCard({\n  stretch,\n  timerKey = 0,\n  variant = 'pre',\n}: StretchCardProps) {\n  const borderColor = 'border-blue-800';\n  const emoji = variant === 'pre' ? 'üèÉ' : 'üßò';\n  const tips = getFormTips(stretch.tips);\n  const videoHref = getVideoUrl(stretch.name, stretch.videoUrl);\n  const timerSeconds = stretch.timerSeconds || 0;\n  const timerLabel = formatStretchTimer(timerSeconds);\n\n  return (\n    <div className={`bg-zinc-800 rounded-lg p-8 border-2 ${borderColor} mb-8`}>\n      <div className=\"text-center mb-6\">\n        <div className=\"text-6xl mb-4\">{emoji}</div>\n        <h2 className=\"text-3xl font-bold text-white mb-4\">{stretch.name}</h2>\n        <div className=\"text-xl text-blue-300 font-semibold mb-4\">{timerLabel}</div>\n      </div>\n\n      {/* Timer - only shows if stretch has a timer value */}\n      <Timer key={timerKey} timerSeconds={timerSeconds} />\n\n      <div className=\"bg-zinc-900 rounded-lg p-4 mb-6\">\n        <div className=\"text-zinc-400 text-sm mb-2\">Tips:</div>\n        <p className=\"text-zinc-200 text-lg leading-relaxed\">{tips}</p>\n      </div>\n\n      <a\n        href={videoHref}\n        target=\"_blank\"\n        rel=\"noopener noreferrer\"\n        className=\"block w-full bg-red-600 hover:bg-red-700 text-white text-center py-3 rounded-lg text-lg font-semibold transition-colors\"\n      >\n        üì∫ Watch Video\n      </a>\n    </div>\n  );\n}\n","/**\n * Full-screen loading indicator\n * Used across workout pages for consistent loading UX\n */\nexport default function LoadingScreen() {\n  return (\n    <div className=\"min-h-screen bg-zinc-900 flex items-center justify-center p-4\">\n      <div className=\"text-white text-2xl\">Loading...</div>\n    </div>\n  );\n}\n","import Link from 'next/link';\n\ninterface ErrorScreenProps {\n  /** The error message to display */\n  message?: string;\n  /** URL to navigate back to (defaults to routines) */\n  backUrl?: string;\n  /** Text for the back link */\n  backText?: string;\n}\n\n/**\n * Full-screen error display\n * Used across workout pages for consistent error UX\n */\nexport default function ErrorScreen({\n  message = 'Something went wrong',\n  backUrl = '/routines',\n  backText = 'Back to routines',\n}: ErrorScreenProps) {\n  return (\n    <div className=\"min-h-screen bg-zinc-900 flex items-center justify-center p-4\">\n      <div className=\"text-center\">\n        <div className=\"text-white text-2xl mb-4\">{message}</div>\n        <Link href={backUrl} className=\"text-blue-400 hover:text-blue-300\">\n          {backText}\n        </Link>\n      </div>\n    </div>\n  );\n}\n","'use client';\n\nimport { useEffect, useRef, useState, Suspense } from 'react';\nimport { useParams, useRouter, useSearchParams } from 'next/navigation';\nimport { WorkoutPlan, Stretch } from '@/lib/types';\nimport { ensureWorkoutSession } from '@/lib/workout-session';\nimport { autosaveWorkout } from '@/lib/workout-autosave';\nimport WorkoutNavHeader from '@/app/components/WorkoutNavHeader';\nimport StretchCard from '@/app/components/StretchCard';\nimport StretchSelector from '@/app/components/StretchSelector';\nimport LoadingScreen from '@/app/components/LoadingScreen';\nimport ErrorScreen from '@/app/components/ErrorScreen';\nimport AutosaveBadge from '@/app/components/AutosaveBadge';\nimport { acknowledgeChangeWarning, hasChangeWarningAck, loadSessionWorkout, saveSessionWorkout } from '@/lib/session-workout';\nimport {\n  loadWorkoutBootstrapCache,\n  saveWorkoutBootstrapCache,\n  type WorkoutBootstrapPayload,\n} from '@/lib/workout-bootstrap';\n\ntype StretchOption = {\n  id: number;\n  name: string;\n  timer_seconds?: number | null;\n  muscle_groups: string | null;\n  video_url: string | null;\n  tips: string | null;\n};\n\nfunction StretchesContent() {\n  const params = useParams();\n  const router = useRouter();\n  const searchParams = useSearchParams();\n  const [workout, setWorkout] = useState<WorkoutPlan | null>(null);\n  const [currentIndex, setCurrentIndex] = useState(0);\n  const [loading, setLoading] = useState(true);\n  const [showStretchSelector, setShowStretchSelector] = useState(false);\n  const [stretchActionMode, setStretchActionMode] = useState<'add' | 'replace' | null>(null);\n  const [showChangeWarning, setShowChangeWarning] = useState(false);\n  const pendingChangeRef = useRef<(() => void) | null>(null);\n\n  // Get routineId from URL params (for public/favorited routines)\n  const routineIdParam = searchParams.get('routineId');\n\n  useEffect(() => {\n    async function fetchWorkout() {\n      try {\n        const routineIdValue = routineIdParam ? Number(routineIdParam) : null;\n        const routineId = Number.isNaN(routineIdValue) ? null : routineIdValue;\n        const decodedName = decodeURIComponent(params.workoutName as string);\n        const cached = loadWorkoutBootstrapCache({\n          workoutName: decodedName,\n          routineId: routineIdParam,\n        });\n\n        let baseWorkout: WorkoutPlan | null = null;\n\n        if (cached) {\n          baseWorkout = cached.workout;\n        } else {\n          let apiUrl = `/api/workout/${params.workoutName}?bootstrap=1`;\n          if (routineIdParam) {\n            apiUrl += `&routineId=${routineIdParam}`;\n          }\n          const response = await fetch(apiUrl);\n          if (!response.ok) {\n            throw new Error('Workout not found');\n          }\n          const data = await response.json();\n          baseWorkout = data.workout as WorkoutPlan;\n          const payload: WorkoutBootstrapPayload = {\n            workout: baseWorkout,\n            settings: data.settings,\n            lastSetSummaries: data.lastSetSummaries || {},\n            lastWorkoutReport: data.lastWorkoutReport || null,\n            routineMeta: data.routineMeta,\n          };\n          saveWorkoutBootstrapCache({\n            workoutName: decodedName,\n            routineId: routineIdParam ?? (payload.routineMeta?.id ? String(payload.routineMeta.id) : null),\n            payload,\n          });\n        }\n\n        if (!baseWorkout) {\n          throw new Error('Workout not found');\n        }\n        const sessionWorkout = loadSessionWorkout(baseWorkout.name, routineIdParam);\n        const resolvedWorkout = sessionWorkout || baseWorkout;\n        setWorkout(resolvedWorkout);\n        // Ensure workout session exists when workout is loaded\n        ensureWorkoutSession(resolvedWorkout.name, routineId);\n\n        // Check for index in URL (for navigation from other sections)\n        const indexParam = searchParams.get('index');\n        if (indexParam) {\n          const idx = parseInt(indexParam, 10);\n          const stretchCount = resolvedWorkout.preWorkoutStretches?.length || 0;\n          if (!isNaN(idx) && idx >= 0 && idx < stretchCount) {\n            setCurrentIndex(idx);\n          }\n        }\n      } catch (error) {\n        console.error('Error fetching workout:', error);\n      } finally {\n        setLoading(false);\n      }\n    }\n\n    fetchWorkout();\n  }, [params.workoutName, searchParams, routineIdParam]);\n\n  if (loading) {\n    return <LoadingScreen />;\n  }\n\n  if (!workout) {\n    return <ErrorScreen message=\"Workout not found\" />;\n  }\n\n  const stretches = workout.preWorkoutStretches || [];\n  const workoutName = encodeURIComponent(workout.name);\n\n  // Build query string for passing routineId\n  const routineQueryParams = new URLSearchParams();\n  if (routineIdParam) routineQueryParams.set('routineId', routineIdParam);\n  const routineQuery = routineQueryParams.toString() ? `?${routineQueryParams.toString()}` : '';\n\n  const runWithChangeWarning = (action: () => void) => {\n    if (hasChangeWarningAck(workout.name, routineIdParam)) {\n      action();\n      return;\n    }\n    pendingChangeRef.current = action;\n    setShowChangeWarning(true);\n  };\n\n  const handleWarningContinue = () => {\n    acknowledgeChangeWarning(workout.name, routineIdParam);\n    setShowChangeWarning(false);\n    const action = pendingChangeRef.current;\n    pendingChangeRef.current = null;\n    action?.();\n  };\n\n  const handleWarningCancel = () => {\n    pendingChangeRef.current = null;\n    setShowChangeWarning(false);\n  };\n\n  const openStretchSelector = (mode: 'add' | 'replace') => {\n    runWithChangeWarning(() => {\n      setStretchActionMode(mode);\n      setShowStretchSelector(true);\n    });\n  };\n\n  const handleSelectStretch = (stretch: StretchOption) => {\n    if (!stretchActionMode) return;\n    const updatedStretch: Stretch = {\n      name: stretch.name,\n      timerSeconds: stretch.timer_seconds ?? 0,\n      videoUrl: stretch.video_url || '',\n      tips: stretch.tips || ''\n    };\n\n    const updatedStretches = [...stretches];\n    const insertIndex = Math.min(currentIndex + 1, updatedStretches.length);\n\n    if (stretchActionMode === 'add') {\n      updatedStretches.splice(insertIndex, 0, updatedStretch);\n    } else {\n      updatedStretches[currentIndex] = updatedStretch;\n    }\n\n    const updatedWorkout = { ...workout, preWorkoutStretches: updatedStretches };\n    setWorkout(updatedWorkout);\n    saveSessionWorkout(updatedWorkout, routineIdParam);\n    setStretchActionMode(null);\n    setShowStretchSelector(false);\n  };\n\n  // If no stretches, show message and skip to exercises\n  if (stretches.length === 0) {\n    return (\n      <div className=\"min-h-screen bg-zinc-900 flex flex-col items-center justify-center p-4\">\n        <div className=\"text-white text-2xl mb-4\">No pre-workout stretches</div>\n        <div className=\"w-full max-w-xs space-y-3\">\n          <button\n            onClick={() => openStretchSelector('add')}\n            className=\"w-full bg-blue-800 hover:bg-blue-700 text-white px-6 py-3 rounded-lg text-base font-semibold transition-colors\"\n          >\n            + Add Stretch\n          </button>\n          <button\n            onClick={() => router.push(`/workout/${workoutName}/active${routineQuery}`)}\n            className=\"w-full bg-blue-800 hover:bg-blue-700 text-white px-6 py-3 rounded-lg text-base font-semibold transition-colors\"\n          >\n            Start Exercises ‚Üí\n          </button>\n        </div>\n\n        {showChangeWarning && (\n          <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/70 p-4\">\n            <div className=\"w-full max-w-md rounded-lg border border-zinc-700 bg-zinc-900 p-6 text-white\">\n              <h3 className=\"text-lg font-semibold mb-2\">Session-only change</h3>\n              <p className=\"text-sm text-zinc-300 mb-6\">\n                This edit only applies to today&apos;s workout. Edit the routine to make a permanent change.\n              </p>\n              <div className=\"grid grid-cols-2 gap-3\">\n                <button\n                  onClick={handleWarningCancel}\n                  className=\"rounded-lg bg-zinc-700 py-2 text-sm font-semibold text-white hover:bg-zinc-600\"\n                >\n                  Cancel\n                </button>\n                <button\n                  onClick={handleWarningContinue}\n                className=\"rounded-lg bg-blue-800 py-2 text-sm font-semibold text-white hover:bg-blue-700\"\n                >\n                  Continue\n                </button>\n              </div>\n            </div>\n          </div>\n        )}\n\n        {showStretchSelector && (\n          <StretchSelector\n            title=\"Add Stretch\"\n            filterType=\"pre_workout\"\n            onCancel={() => {\n              setShowStretchSelector(false);\n              setStretchActionMode(null);\n            }}\n            onSelect={handleSelectStretch}\n          />\n        )}\n      </div>\n    );\n  }\n\n  const currentStretch = stretches[currentIndex];\n\n  // Calculate total workout items for progress\n  const postStretchCount = (workout.postWorkoutStretches || []).length;\n  const totalItems =\n    stretches.length +\n    workout.exercises.length +\n    1 + // cardio (always count it for progress)\n    postStretchCount;\n  const currentProgress = currentIndex + 1;\n  const progressPercentage = (currentProgress / totalItems) * 100;\n\n  const handleNext = () => {\n    void autosaveWorkout({ type: 'stretch', phase: 'pre', index: currentIndex });\n    if (currentIndex < stretches.length - 1) {\n      setCurrentIndex(currentIndex + 1);\n    } else {\n      // Move to exercises\n      router.push(`/workout/${workoutName}/active${routineQuery}`);\n    }\n  };\n\n  const handlePrevious = () => {\n    if (currentIndex > 0) {\n      setCurrentIndex(currentIndex - 1);\n    }\n    // At index 0, previous is disabled (no previous section)\n  };\n\n  const handleSkipAll = () => {\n    router.push(`/workout/${workoutName}/active${routineQuery}`);\n  };\n\n  return (\n    <div className=\"min-h-screen bg-zinc-900 p-4\">\n      <div className=\"max-w-2xl mx-auto\">\n        {/* Navigation */}\n        <WorkoutNavHeader\n          exitUrl={`/workout/${workoutName}${routineQuery}`}\n          previousUrl={null} // Handle internally\n          onPrevious={currentIndex > 0 ? handlePrevious : undefined}\n          skipLabel=\"Skip All\"\n          onSkip={handleSkipAll}\n        />\n        <div className=\"flex justify-end mb-4\">\n          <AutosaveBadge />\n        </div>\n\n        {/* Title */}\n        <div className=\"text-center mb-4\">\n          <h1 className=\"text-2xl font-bold text-white mb-2\">PRE-WORKOUT STRETCH</h1>\n          <div className=\"text-zinc-400 text-lg\">\n            {currentIndex + 1} of {stretches.length}\n          </div>\n        </div>\n\n        {/* Progress Bar */}\n        <div className=\"mb-8\">\n          <div className=\"h-2 bg-zinc-800 rounded-full overflow-hidden\">\n            <div\n                className=\"h-full bg-blue-700 transition-all duration-300\"\n              style={{ width: `${progressPercentage}%` }}\n            />\n          </div>\n          <div className=\"text-zinc-500 text-sm text-center mt-2\">\n            Overall Progress: {currentProgress} / {totalItems}\n          </div>\n        </div>\n\n        <div className=\"grid grid-cols-2 gap-3 mb-6\">\n          <button\n            onClick={() => openStretchSelector('add')}\n            className=\"bg-blue-900/80 hover:bg-blue-800 text-white py-2 rounded-lg text-sm font-semibold transition-colors\"\n          >\n            + Add Stretch\n          </button>\n          <button\n            onClick={() => openStretchSelector('replace')}\n            className=\"bg-blue-900/80 hover:bg-blue-800 text-white py-2 rounded-lg text-sm font-semibold transition-colors\"\n          >\n            ‚Ü∫ Replace Stretch\n          </button>\n        </div>\n\n        {/* Stretch Card */}\n        <StretchCard\n          stretch={currentStretch}\n          timerKey={currentIndex}\n          variant=\"pre\"\n        />\n\n        {/* Navigation Buttons */}\n        <div className=\"grid grid-cols-2 gap-4\">\n          <button\n            onClick={handlePrevious}\n            disabled={currentIndex === 0}\n            className={`py-4 rounded-lg text-lg font-semibold transition-colors ${\n              currentIndex === 0\n                ? 'bg-zinc-800 text-zinc-600 cursor-not-allowed'\n                : 'bg-zinc-700 hover:bg-zinc-600 text-white'\n            }`}\n          >\n            ‚Üê Previous\n          </button>\n          <button\n            onClick={handleNext}\n            className=\"bg-blue-800 hover:bg-blue-700 text-white py-4 rounded-lg text-lg font-semibold transition-colors\"\n          >\n            {currentIndex < stretches.length - 1 ? 'Next Stretch ‚Üí' : 'Start Exercises ‚Üí'}\n          </button>\n        </div>\n\n        {showChangeWarning && (\n          <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/70 p-4\">\n            <div className=\"w-full max-w-md rounded-lg border border-zinc-700 bg-zinc-900 p-6 text-white\">\n              <h3 className=\"text-lg font-semibold mb-2\">Session-only change</h3>\n              <p className=\"text-sm text-zinc-300 mb-6\">\n                This edit only applies to today&apos;s workout. Edit the routine to make a permanent change.\n              </p>\n              <div className=\"grid grid-cols-2 gap-3\">\n                <button\n                  onClick={handleWarningCancel}\n                  className=\"rounded-lg bg-zinc-700 py-2 text-sm font-semibold text-white hover:bg-zinc-600\"\n                >\n                  Cancel\n                </button>\n                <button\n                  onClick={handleWarningContinue}\n                className=\"rounded-lg bg-blue-800 py-2 text-sm font-semibold text-white hover:bg-blue-700\"\n                >\n                  Continue\n                </button>\n              </div>\n            </div>\n          </div>\n        )}\n\n        {showStretchSelector && (\n          <StretchSelector\n            title={stretchActionMode === 'replace' ? 'Replace Stretch' : 'Add Stretch'}\n            filterType=\"pre_workout\"\n            onCancel={() => {\n              setShowStretchSelector(false);\n              setStretchActionMode(null);\n            }}\n            onSelect={handleSelectStretch}\n          />\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport default function StretchesPage() {\n  return (\n    <Suspense fallback={<LoadingScreen />}>\n      <StretchesContent />\n    </Suspense>\n  );\n}\n"],"names":["module","exports","require","vendored","HooksClientContext","ServerInsertedHtml"],"mappings":"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","ignoreList":[0,1]}