module.exports=[56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},36313,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.HooksClientContext},18341,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.ServerInsertedHtml},6459,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(38246);function f({onComplete:a}){let[d,e]=(0,c.useState)(""),[f,g]=(0,c.useState)(""),[h,i]=(0,c.useState)(!1),j=async b=>{b.preventDefault(),g("");let c=d.trim(),e=c.length<3?"Username must be at least 3 characters":c.length>20?"Username must be 20 characters or less":/^[a-zA-Z0-9_]+$/.test(c)?null:"Username can only contain letters, numbers, and underscores";if(e)return void g(e);i(!0);try{let b=await fetch("/api/user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:c})}),d=await b.json();if(!b.ok)return void g(d.error||"Failed to set username");a(d.username)}catch(a){g("An error occurred. Please try again.")}finally{i(!1)}};return(0,b.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 p-4",children:(0,b.jsxs)("div",{className:"bg-zinc-800 rounded-xl p-8 max-w-md w-full border border-zinc-700",children:[(0,b.jsx)("h2",{className:"text-2xl font-bold text-white mb-2 text-center",children:"Set your username"}),(0,b.jsx)("p",{className:"text-zinc-400 text-center mb-6",children:"Choose a username to identify yourself when sharing routines with others."}),(0,b.jsxs)("form",{onSubmit:j,children:[(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("label",{htmlFor:"username",className:"block text-sm font-medium text-zinc-300 mb-2",children:"Username"}),(0,b.jsx)("input",{id:"username",type:"text",value:d,onChange:a=>{e(a.target.value),g("")},placeholder:"Enter your username",className:"w-full bg-zinc-700 text-white px-4 py-3 rounded-lg border border-zinc-600 focus:outline-none focus:border-green-500 placeholder-zinc-500",autoFocus:!0,disabled:h}),(0,b.jsx)("p",{className:"text-xs text-zinc-500 mt-1",children:"3-20 characters. Letters, numbers, and underscores only."})]}),f&&(0,b.jsx)("div",{className:"mb-4 text-red-400 text-sm text-center",children:f}),(0,b.jsx)("button",{type:"submit",disabled:h||!d.trim(),className:"w-full bg-green-600 hover:bg-green-700 disabled:bg-zinc-600 disabled:cursor-not-allowed text-white font-bold py-3 rounded-lg transition-colors",children:h?"Setting username...":"Continue"})]})]})})}function g(){let a=(0,d.useRouter)(),[g,h]=(0,c.useState)([]),[i,j]=(0,c.useState)([]),[k,l]=(0,c.useState)([]),[m,n]=(0,c.useState)(!0),[o,p]=(0,c.useState)(null),[q,r]=(0,c.useState)(!1),[s,t]=(0,c.useState)(!1),[u,v]=(0,c.useState)(null),[w,x]=(0,c.useState)(!1);async function y(){try{let a=await fetch("/api/user");if(a.ok){let b=await a.json();p(b),b.hasUsername?z():r(!0)}}catch(a){console.error("Error fetching user info:",a),z()}}async function z(){try{let a=await fetch("/api/routines"),b=await a.json();h(b.routines||[]);let c=await fetch("/api/routines/favorites"),d=await c.json();j(d.routines||[]);let e=await fetch("/api/routines/public"),f=await e.json();l((f.routines||[]).slice(0,3))}catch(a){console.error("Error fetching routines:",a)}finally{n(!1)}}async function A(a){try{(await fetch(`/api/routines/${a}/favorite`,{method:"DELETE"})).ok&&j(i.filter(b=>b.id!==a))}catch(a){console.error("Error removing favorite:",a)}}async function B(){if(u&&!w){x(!0);try{if(!(await fetch(`/api/routines/${u.id}`,{method:"DELETE"})).ok)throw Error("Failed to delete routine");h(a=>a.filter(a=>a.id!==u.id)),v(null)}catch(a){console.error("Error deleting routine:",a),alert("Failed to delete routine. Please try again.")}finally{x(!1)}}}if((0,c.useEffect)(()=>{y()},[]),q)return(0,b.jsx)(f,{onComplete:function(a){p(b=>b?{...b,username:a,hasUsername:!0}:null),r(!1),z()}});if(m)return(0,b.jsx)("div",{className:"min-h-screen bg-zinc-900 flex items-center justify-center p-4",children:(0,b.jsx)("div",{className:"text-white text-2xl",children:"Loading..."})});let C=(a,c)=>{let d=a.last_workout_date||null,f=function(a){if(!a)return"Never";let b=new Date(/^\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}/.test(a)?`${a.replace(" ","T")}Z`:/^\d{4}-\d{2}-\d{2}$/.test(a)?`${a}T00:00:00Z`:a);return Number.isNaN(b.getTime())?"Unknown":b.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}(d),g=encodeURIComponent(a.name),h=`/workout/${g}?routineId=${a.id}&preview=1`;return(0,b.jsxs)("div",{className:"bg-zinc-800 hover:bg-zinc-700 transition-colors rounded-lg p-6 border-2 border-zinc-700",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between gap-3 mb-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-2xl font-semibold text-white",children:a.name}),(0,b.jsxs)("div",{className:"text-zinc-400 text-sm",children:[!c&&a.creator_username&&(0,b.jsxs)("span",{children:["by @",a.creator_username]}),!c&&!a.creator_username&&a.creator_name&&(0,b.jsxs)("span",{children:["by ",a.creator_name]}),c&&a.description&&a.description,c&&!a.description&&"Â "]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsxs)("div",{className:"text-sm text-zinc-500 whitespace-nowrap shrink-0",children:["Last:"," ",(0,b.jsx)("span",{className:d?"text-blue-300":"text-zinc-600",children:f})]}),!c&&(0,b.jsx)("button",{onClick:()=>A(a.id),className:"text-red-400 hover:text-red-300 p-1",title:"Remove from favorites",children:(0,b.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})})})]})]}),(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,b.jsxs)(e.default,{href:h,className:"px-4 py-2 rounded-lg font-medium bg-red-900 hover:bg-red-800 text-red-100 transition-colors inline-flex items-center gap-2",children:[(0,b.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",children:(0,b.jsx)("path",{d:"M6.5 4.8a1 1 0 0 1 1 0l10 6a1 1 0 0 1 0 1.8l-10 6A1 1 0 0 1 6 17.8V6.2a1 1 0 0 1 .5-1.4z"})}),"Start"]}),c&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(e.default,{href:`/routines/${a.id}/edit`,className:"px-4 py-2 rounded-lg font-medium bg-blue-800 hover:bg-blue-700 text-white transition-colors inline-flex items-center gap-2",children:[(0,b.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",children:(0,b.jsx)("path",{d:"M4 17.3V20h2.7l8-8-2.7-2.7-8 8zm15.7-9.6a1 1 0 0 0 0-1.4l-2-2a1 1 0 0 0-1.4 0l-1.6 1.6L18.1 9l1.6-1.3z"})}),"Edit"]}),(0,b.jsx)("button",{onClick:()=>v(a),className:"ml-auto p-2.5 text-red-700 hover:text-red-600","aria-label":"Delete routine",title:"Delete routine",children:(0,b.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,b.jsx)("path",{d:"M19.5 6h-15"}),(0,b.jsx)("path",{d:"M8.5 6V4.5a1.5 1.5 0 0 1 1.5-1.5h4a1.5 1.5 0 0 1 1.5 1.5V6"}),(0,b.jsx)("path",{d:"M6.5 6l1 13a2 2 0 0 0 2 2h5a2 2 0 0 0 2-2l1-13"}),(0,b.jsx)("path",{d:"M10 11v6"}),(0,b.jsx)("path",{d:"M14 11v6"})]})})]})]})]},`routine-${a.id}`)};return(0,b.jsx)("div",{className:"min-h-screen bg-zinc-900 p-4",children:(0,b.jsxs)("main",{className:"max-w-2xl mx-auto py-8",children:[(0,b.jsx)("div",{className:"flex justify-end mb-4",children:(0,b.jsx)(e.default,{href:"/profile",className:"inline-flex items-center justify-center rounded-full border border-zinc-700 bg-zinc-800 p-3 text-zinc-200 transition-colors hover:border-emerald-600 hover:text-emerald-300","aria-label":"Open profile",title:"Profile",children:(0,b.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",children:(0,b.jsx)("path",{d:"M12 12c2.7 0 4.9-2.2 4.9-4.9S14.7 2.2 12 2.2 7.1 4.4 7.1 7.1 9.3 12 12 12zm0 2.4c-3.2 0-9.6 1.6-9.6 4.8v2.6h19.2v-2.6c0-3.2-6.4-4.8-9.6-4.8z"})})})}),(0,b.jsxs)("div",{className:"mb-8",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-white",children:"My Routines"}),(0,b.jsx)("p",{className:"text-sm text-zinc-400",children:"Build, track, and favorite workouts you want to run again."}),o?.username&&(0,b.jsxs)("p",{className:"mt-2 text-sm text-zinc-500",children:["Signed in as ",(0,b.jsxs)("span",{className:"text-emerald-300",children:["@",o.username]})]})]}),(0,b.jsx)("button",{onClick:()=>t(!0),className:"mb-3 block w-full bg-purple-900 hover:bg-purple-800 text-white text-center py-4 rounded-lg text-lg font-bold transition-colors",children:"+ Create New Routine"}),(0,b.jsx)("div",{className:"mb-8",children:(0,b.jsx)(e.default,{href:"/routines/import",className:"block w-full rounded-lg bg-slate-800 hover:bg-slate-700 text-slate-200 px-4 py-3 text-center text-sm font-semibold transition-colors",children:"Import Routine from JSON"})}),(0,b.jsxs)("div",{className:"mb-8",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold text-zinc-300 mb-4",children:"My Routines"}),(0,b.jsx)("div",{className:"space-y-4",children:0===g.length?(0,b.jsx)("div",{className:"text-center text-zinc-500 text-lg py-4",children:"No routines yet. Create one above or browse public routines."}):g.map(a=>C(a,!0))})]}),i.length>0&&(0,b.jsxs)("div",{className:"mb-8",children:[(0,b.jsxs)("h2",{className:"text-xl font-semibold text-zinc-300 mb-4 flex items-center gap-2",children:[(0,b.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-red-300",fill:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})}),"Favorited Routines"]}),(0,b.jsx)("div",{className:"space-y-4",children:i.map(a=>C(a,!1))})]}),k.length>0&&(0,b.jsxs)("div",{className:"mt-8 pt-8 border-t border-zinc-700",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold text-zinc-300 mb-4",children:"Discover Public Routines"}),(0,b.jsx)(e.default,{href:"/routines/browse",className:"mb-4 block w-full bg-purple-900 hover:bg-purple-800 text-white text-center py-3 rounded-lg font-semibold transition-colors",children:"Browse All Public Routines"}),(0,b.jsx)("div",{className:"space-y-3",children:k.map(a=>(0,b.jsx)("div",{className:"bg-zinc-800 rounded-lg p-4 border border-zinc-700",children:(0,b.jsx)("div",{className:"flex items-center justify-between",children:(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-white",children:a.name}),(0,b.jsxs)("p",{className:"text-sm text-zinc-400",children:["by ",(0,b.jsxs)("span",{className:"text-purple-300",children:["@",a.creator_username||a.creator_name||"Anonymous"]})]})]})})},`public-${a.id}`))})]}),s&&(0,b.jsx)("div",{className:"fixed inset-0 z-50 bg-black/70 flex items-center justify-center p-4",children:(0,b.jsxs)("div",{className:"w-full max-w-md bg-zinc-900 border border-zinc-700 rounded-xl p-6",children:[(0,b.jsx)("h2",{className:"text-2xl font-bold text-white mb-2",children:"Create a new routine"}),(0,b.jsx)("p",{className:"text-zinc-400 text-sm mb-6",children:"Choose how you want to build your next workout."}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)("button",{onClick:()=>a.push("/routines/builder"),className:"w-full bg-green-700 hover:bg-green-600 text-white py-3 rounded-lg text-lg font-semibold",children:"Manual Builder"}),(0,b.jsx)("button",{onClick:()=>a.push("/routines/ai"),className:"w-full bg-emerald-800 hover:bg-emerald-700 text-white py-3 rounded-lg text-lg font-semibold",children:"AI-Assisted"}),(0,b.jsx)("button",{onClick:()=>t(!1),className:"w-full bg-zinc-800 hover:bg-zinc-700 text-zinc-200 py-3 rounded-lg text-sm font-semibold",children:"Cancel"})]})]})}),u&&(0,b.jsx)("div",{className:"fixed inset-0 z-50 bg-black/70 flex items-center justify-center p-4",children:(0,b.jsxs)("div",{className:"w-full max-w-md bg-zinc-900 border border-zinc-700 rounded-xl p-6",children:[(0,b.jsx)("h2",{className:"text-2xl font-bold text-white mb-2",children:"Delete Routine"}),(0,b.jsxs)("p",{className:"text-zinc-400 text-sm mb-6",children:['This will permanently delete "',u.name,'".']}),(0,b.jsxs)("div",{className:"flex gap-3",children:[(0,b.jsx)("button",{onClick:B,className:"flex-1 bg-red-800 hover:bg-red-700 text-white py-3 rounded-lg text-sm font-semibold",disabled:w,children:w?"Deleting...":"Delete"}),(0,b.jsx)("button",{onClick:function(){w||v(null)},className:"flex-1 bg-zinc-800 hover:bg-zinc-700 text-zinc-200 py-3 rounded-lg text-sm font-semibold",disabled:w,children:"Cancel"})]})]})})]})})}a.s(["default",()=>g],6459)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__a5f437f9._.js.map