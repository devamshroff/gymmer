{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/devamshroff/Documents/SWE%20Career/projects/gymmer/lib/constants.ts"],"sourcesContent":["// lib/constants.ts\n\n// Exercise type identifiers used across workouts, routines, and storage.\nexport const EXERCISE_TYPES = {\n  single: 'single',\n  b2b: 'b2b',\n  circuit: 'circuit',\n} as const;\n\nexport type ExerciseType = typeof EXERCISE_TYPES[keyof typeof EXERCISE_TYPES];\n\n// Exercise history display modes (primary metric axis).\nexport const EXERCISE_HISTORY_DISPLAY_MODES = {\n  weight: 'weight',\n  reps: 'reps',\n} as const;\n\nexport type ExerciseHistoryDisplayMode =\n  typeof EXERCISE_HISTORY_DISPLAY_MODES[keyof typeof EXERCISE_HISTORY_DISPLAY_MODES];\n\n// Exercise history aggregation modes (how points are summarized).\nexport const EXERCISE_HISTORY_AGGREGATION_MODES = {\n  max: 'max',\n  avg: 'avg',\n} as const;\n\nexport type ExerciseHistoryAggregationMode =\n  typeof EXERCISE_HISTORY_AGGREGATION_MODES[keyof typeof EXERCISE_HISTORY_AGGREGATION_MODES];\n\n// Exercise tracking primary metrics (how we interpret the numeric value).\nexport const EXERCISE_PRIMARY_METRICS = {\n  weight: 'weight',\n  height: 'height',\n  time: 'time',\n  distance: 'distance',\n  repsOnly: 'reps_only',\n} as const;\n\nexport type ExercisePrimaryMetric =\n  typeof EXERCISE_PRIMARY_METRICS[keyof typeof EXERCISE_PRIMARY_METRICS];\n\n// Workout session modes (preview-only target selection).\nexport const SESSION_MODES = {\n  progress: 'progress',\n  maintenance: 'maintenance',\n  light: 'light',\n} as const;\n\nexport type SessionMode = typeof SESSION_MODES[keyof typeof SESSION_MODES];\n\nexport const SESSION_MODE_LABELS: Record<SessionMode, string> = {\n  [SESSION_MODES.progress]: 'Progress',\n  [SESSION_MODES.maintenance]: 'Maintenance',\n  [SESSION_MODES.light]: 'Light',\n};\n\nexport const SESSION_MODE_DESCRIPTIONS: Record<SessionMode, string> = {\n  [SESSION_MODES.progress]: 'Push for small, steady improvements.',\n  [SESSION_MODES.maintenance]: 'Hold steady and focus on form.',\n  [SESSION_MODES.light]: 'Easy effort today.',\n};\n"],"names":[],"mappings":"AAAA,mBAAmB;AAEnB,yEAAyE;;;;;;;;;;;;;;;;;AAClE,MAAM,iBAAiB;IAC5B,QAAQ;IACR,KAAK;IACL,SAAS;AACX;AAKO,MAAM,iCAAiC;IAC5C,QAAQ;IACR,MAAM;AACR;AAMO,MAAM,qCAAqC;IAChD,KAAK;IACL,KAAK;AACP;AAMO,MAAM,2BAA2B;IACtC,QAAQ;IACR,QAAQ;IACR,MAAM;IACN,UAAU;IACV,UAAU;AACZ;AAMO,MAAM,gBAAgB;IAC3B,UAAU;IACV,aAAa;IACb,OAAO;AACT;AAIO,MAAM,sBAAmD;IAC9D,CAAC,cAAc,QAAQ,CAAC,EAAE;IAC1B,CAAC,cAAc,WAAW,CAAC,EAAE;IAC7B,CAAC,cAAc,KAAK,CAAC,EAAE;AACzB;AAEO,MAAM,4BAAyD;IACpE,CAAC,cAAc,QAAQ,CAAC,EAAE;IAC1B,CAAC,cAAc,WAAW,CAAC,EAAE;IAC7B,CAAC,cAAc,KAAK,CAAC,EAAE;AACzB"}},
    {"offset": {"line": 64, "column": 0}, "map": {"version":3,"sources":["file:///Users/devamshroff/Documents/SWE%20Career/projects/gymmer/lib/workout-session.ts"],"sourcesContent":["// lib/workout-session.ts\n// Client-side storage for current workout session\n\nimport { EXERCISE_TYPES, SESSION_MODES, type ExercisePrimaryMetric, type SessionMode } from '@/lib/constants';\n\nexport interface SessionExerciseData {\n  name: string;\n  type: typeof EXERCISE_TYPES.single | typeof EXERCISE_TYPES.b2b;\n  isMachine?: boolean;\n  primaryMetric?: ExercisePrimaryMetric;\n  metricUnit?: string | null;\n  warmup?: { weight: number; reps: number };\n  sets: Array<{ weight: number; reps: number }>;\n  b2bPartner?: {\n    name: string;\n    isMachine?: boolean;\n    primaryMetric?: ExercisePrimaryMetric;\n    metricUnit?: string | null;\n    warmup?: { weight: number; reps: number };\n    sets: Array<{ weight: number; reps: number }>;\n  };\n}\n\nexport interface WorkoutSessionData {\n  workoutName: string;\n  routineId?: number | null;\n  sessionId?: number | null;\n  startTime: string;\n  exercises: SessionExerciseData[];\n  cardio?: {\n    type: string;\n    time: string;\n    speed?: number;\n    incline?: number;\n  };\n}\n\nconst STORAGE_KEY = 'current_workout_session';\n\nexport function isSessionMode(value: string | null | undefined): value is SessionMode {\n  return value === SESSION_MODES.progress\n    || value === SESSION_MODES.maintenance\n    || value === SESSION_MODES.light;\n}\n\nexport function resolveSessionMode(\n  value: string | null | undefined,\n  fallback: SessionMode = SESSION_MODES.progress\n): SessionMode {\n  return isSessionMode(value) ? value : fallback;\n}\n\nexport function initWorkoutSession(\n  workoutName: string,\n  routineId?: number | null\n): void {\n  const session: WorkoutSessionData = {\n    workoutName,\n    routineId: routineId ?? null,\n    sessionId: null,\n    startTime: new Date().toISOString(),\n    exercises: [],\n  };\n  if (typeof window !== 'undefined') {\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(session));\n  }\n}\n\nexport function ensureWorkoutSession(\n  workoutName: string,\n  routineId?: number | null\n): void {\n  const existing = getWorkoutSession();\n  const normalizedRoutineId = routineId ?? null;\n  if (!existing) {\n    initWorkoutSession(workoutName, normalizedRoutineId);\n    return;\n  }\n  if (existing.workoutName !== workoutName || (existing.routineId ?? null) !== normalizedRoutineId) {\n    initWorkoutSession(workoutName, normalizedRoutineId);\n  }\n}\n\nexport function getWorkoutSession(): WorkoutSessionData | null {\n  if (typeof window === 'undefined') return null;\n  const data = localStorage.getItem(STORAGE_KEY);\n  if (!data) return null;\n  const parsed = JSON.parse(data) as WorkoutSessionData;\n  const rawRoutineId = (parsed as { routineId?: unknown }).routineId;\n  const nextRoutineId = typeof rawRoutineId === 'number' ? rawRoutineId : Number(rawRoutineId);\n  parsed.routineId = Number.isFinite(nextRoutineId) ? nextRoutineId : null;\n  const rawSessionId = (parsed as { sessionId?: unknown }).sessionId;\n  const nextSessionId = typeof rawSessionId === 'number' ? rawSessionId : Number(rawSessionId);\n  parsed.sessionId = Number.isFinite(nextSessionId) ? nextSessionId : null;\n  return parsed;\n}\n\nexport function setWorkoutSessionId(sessionId: number): void {\n  if (typeof window === 'undefined') return;\n  const session = getWorkoutSession();\n  if (!session) return;\n  if (session.sessionId === sessionId) return;\n  session.sessionId = sessionId;\n  localStorage.setItem(STORAGE_KEY, JSON.stringify(session));\n}\n\nexport function addExerciseToSession(exercise: SessionExerciseData): void {\n  const session = getWorkoutSession();\n  if (!session) return;\n\n  session.exercises.push(exercise);\n  if (typeof window !== 'undefined') {\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(session));\n  }\n}\n\nexport function addCardioToSession(cardio: { type: string; time: string; speed?: number; incline?: number }): void {\n  const session = getWorkoutSession();\n  if (!session) return;\n\n  session.cardio = cardio;\n  if (typeof window !== 'undefined') {\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(session));\n  }\n}\n\nexport function clearWorkoutSession(): void {\n  if (typeof window !== 'undefined') {\n    localStorage.removeItem(STORAGE_KEY);\n  }\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;AAAA,yBAAyB;AACzB,kDAAkD;AAElD;;AAkCA,MAAM,cAAc;AAEb,SAAS,cAAc,KAAgC;IAC5D,OAAO,UAAU,oIAAa,CAAC,QAAQ,IAClC,UAAU,oIAAa,CAAC,WAAW,IACnC,UAAU,oIAAa,CAAC,KAAK;AACpC;AAEO,SAAS,mBACd,KAAgC,EAChC,WAAwB,oIAAa,CAAC,QAAQ;IAE9C,OAAO,cAAc,SAAS,QAAQ;AACxC;AAEO,SAAS,mBACd,WAAmB,EACnB,SAAyB;IAEzB,MAAM,UAA8B;QAClC;QACA,WAAW,aAAa;QACxB,WAAW;QACX,WAAW,IAAI,OAAO,WAAW;QACjC,WAAW,EAAE;IACf;IACA,wCAAmC;QACjC,aAAa,OAAO,CAAC,aAAa,KAAK,SAAS,CAAC;IACnD;AACF;AAEO,SAAS,qBACd,WAAmB,EACnB,SAAyB;IAEzB,MAAM,WAAW;IACjB,MAAM,sBAAsB,aAAa;IACzC,IAAI,CAAC,UAAU;QACb,mBAAmB,aAAa;QAChC;IACF;IACA,IAAI,SAAS,WAAW,KAAK,eAAe,CAAC,SAAS,SAAS,IAAI,IAAI,MAAM,qBAAqB;QAChG,mBAAmB,aAAa;IAClC;AACF;AAEO,SAAS;IACd;;IACA,MAAM,OAAO,aAAa,OAAO,CAAC;IAClC,IAAI,CAAC,MAAM,OAAO;IAClB,MAAM,SAAS,KAAK,KAAK,CAAC;IAC1B,MAAM,eAAe,AAAC,OAAmC,SAAS;IAClE,MAAM,gBAAgB,OAAO,iBAAiB,WAAW,eAAe,OAAO;IAC/E,OAAO,SAAS,GAAG,OAAO,QAAQ,CAAC,iBAAiB,gBAAgB;IACpE,MAAM,eAAe,AAAC,OAAmC,SAAS;IAClE,MAAM,gBAAgB,OAAO,iBAAiB,WAAW,eAAe,OAAO;IAC/E,OAAO,SAAS,GAAG,OAAO,QAAQ,CAAC,iBAAiB,gBAAgB;IACpE,OAAO;AACT;AAEO,SAAS,oBAAoB,SAAiB;IACnD;;IACA,MAAM,UAAU;IAChB,IAAI,CAAC,SAAS;IACd,IAAI,QAAQ,SAAS,KAAK,WAAW;IACrC,QAAQ,SAAS,GAAG;IACpB,aAAa,OAAO,CAAC,aAAa,KAAK,SAAS,CAAC;AACnD;AAEO,SAAS,qBAAqB,QAA6B;IAChE,MAAM,UAAU;IAChB,IAAI,CAAC,SAAS;IAEd,QAAQ,SAAS,CAAC,IAAI,CAAC;IACvB,wCAAmC;QACjC,aAAa,OAAO,CAAC,aAAa,KAAK,SAAS,CAAC;IACnD;AACF;AAEO,SAAS,mBAAmB,MAAwE;IACzG,MAAM,UAAU;IAChB,IAAI,CAAC,SAAS;IAEd,QAAQ,MAAM,GAAG;IACjB,wCAAmC;QACjC,aAAa,OAAO,CAAC,aAAa,KAAK,SAAS,CAAC;IACnD;AACF;AAEO,SAAS;IACd,wCAAmC;QACjC,aAAa,UAAU,CAAC;IAC1B;AACF"}},
    {"offset": {"line": 169, "column": 0}, "map": {"version":3,"sources":["file:///Users/devamshroff/Documents/SWE%20Career/projects/gymmer/lib/workout-autosave.ts"],"sourcesContent":["import { getWorkoutSession, setWorkoutSessionId } from '@/lib/workout-session';\n\ntype AutosaveEvent =\n  | {\n      type: 'start' | 'stretch' | 'exercise_skip' | 'exercise_end';\n      phase?: 'pre' | 'post';\n      index?: number;\n    }\n  | {\n      type: 'single_set';\n      exerciseName: string;\n      setIndex: number;\n      weight: number;\n      reps: number;\n      isWarmup?: boolean;\n    }\n  | {\n      type: 'b2b_set';\n      exerciseName: string;\n      partnerName: string;\n      setIndex: number;\n      weight: number;\n      reps: number;\n      partnerWeight: number;\n      partnerReps: number;\n    };\n\ntype AutosaveStatus = 'saving' | 'success' | 'error';\n\nfunction emitAutosave(status: AutosaveStatus, eventType: string) {\n  if (typeof window === 'undefined') return;\n  window.dispatchEvent(new CustomEvent('workout-autosave', {\n    detail: {\n      status,\n      eventType,\n      at: Date.now(),\n    }\n  }));\n}\n\nexport async function autosaveWorkout(event: AutosaveEvent): Promise<void> {\n  if (typeof window === 'undefined') return;\n  const session = getWorkoutSession();\n  if (!session) return;\n\n  emitAutosave('saving', event.type);\n\n  try {\n    const response = await fetch('/api/workout-autosave', {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({\n        sessionId: session.sessionId ?? null,\n        workoutName: session.workoutName,\n        routineId: session.routineId ?? null,\n        startTime: session.startTime,\n        event,\n      }),\n    });\n\n    if (!response.ok) {\n      emitAutosave('error', event.type);\n      return;\n    }\n\n    const data = await response.json();\n    if (typeof data?.sessionId === 'number') {\n      setWorkoutSessionId(data.sessionId);\n    }\n    emitAutosave('success', event.type);\n  } catch (error) {\n    console.error('Autosave failed:', error);\n    emitAutosave('error', event.type);\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;;AA6BA,SAAS,aAAa,MAAsB,EAAE,SAAiB;IAC7D;;IACA,OAAO,aAAa,CAAC,IAAI,YAAY,oBAAoB;QACvD,QAAQ;YACN;YACA;YACA,IAAI,KAAK,GAAG;QACd;IACF;AACF;AAEO,eAAe,gBAAgB,KAAoB;IACxD;;IACA,MAAM,UAAU,IAAA,iJAAiB;IACjC,IAAI,CAAC,SAAS;IAEd,aAAa,UAAU,MAAM,IAAI;IAEjC,IAAI;QACF,MAAM,WAAW,MAAM,MAAM,yBAAyB;YACpD,QAAQ;YACR,SAAS;gBAAE,gBAAgB;YAAmB;YAC9C,MAAM,KAAK,SAAS,CAAC;gBACnB,WAAW,QAAQ,SAAS,IAAI;gBAChC,aAAa,QAAQ,WAAW;gBAChC,WAAW,QAAQ,SAAS,IAAI;gBAChC,WAAW,QAAQ,SAAS;gBAC5B;YACF;QACF;QAEA,IAAI,CAAC,SAAS,EAAE,EAAE;YAChB,aAAa,SAAS,MAAM,IAAI;YAChC;QACF;QAEA,MAAM,OAAO,MAAM,SAAS,IAAI;QAChC,IAAI,OAAO,MAAM,cAAc,UAAU;YACvC,IAAA,mJAAmB,EAAC,KAAK,SAAS;QACpC;QACA,aAAa,WAAW,MAAM,IAAI;IACpC,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,oBAAoB;QAClC,aAAa,SAAS,MAAM,IAAI;IAClC;AACF"}},
    {"offset": {"line": 227, "column": 0}, "map": {"version":3,"sources":["file:///Users/devamshroff/Documents/SWE%20Career/projects/gymmer/app/components/QuickExerciseForm.tsx"],"sourcesContent":["'use client';\n\nimport { useState } from 'react';\nimport { EXERCISE_PRIMARY_METRICS } from '@/lib/constants';\nimport type { ExercisePrimaryMetric } from '@/lib/constants';\n\ninterface QuickExerciseFormProps {\n  onSubmit: (exercise: {\n    name: string;\n    videoUrl?: string;\n    tips?: string;\n    equipment?: string;\n    difficulty?: string;\n    primaryMetric?: ExercisePrimaryMetric;\n    metricUnit?: string;\n  }) => Promise<void>;\n  onCancel: () => void;\n}\n\nexport default function QuickExerciseForm({ onSubmit, onCancel }: QuickExerciseFormProps) {\n  const [name, setName] = useState('');\n  const [videoUrl, setVideoUrl] = useState('');\n  const [tips, setTips] = useState('');\n  const [equipment, setEquipment] = useState('');\n  const [primaryMetric, setPrimaryMetric] = useState<ExercisePrimaryMetric>(EXERCISE_PRIMARY_METRICS.weight);\n  const [metricUnit, setMetricUnit] = useState('sec');\n  const [submitting, setSubmitting] = useState(false);\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!name.trim()) return;\n\n    setSubmitting(true);\n    try {\n      await onSubmit({\n        name: name.trim(),\n        videoUrl: videoUrl.trim() || undefined,\n        tips: tips.trim() || undefined,\n        equipment: equipment || undefined,\n        primaryMetric,\n        metricUnit: (primaryMetric === EXERCISE_PRIMARY_METRICS.time\n          || primaryMetric === EXERCISE_PRIMARY_METRICS.distance)\n          ? metricUnit.trim()\n          : undefined\n      });\n    } finally {\n      setSubmitting(false);\n    }\n  };\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4 z-50\">\n      <div className=\"bg-zinc-800 rounded-lg p-6 max-w-md w-full border-2 border-green-600\">\n        <h2 className=\"text-2xl font-bold text-white mb-4\">Create New Exercise</h2>\n\n        <form onSubmit={handleSubmit} className=\"space-y-4\">\n          {/* Exercise Name - Required */}\n          <div>\n            <label className=\"text-zinc-300 text-sm font-semibold block mb-2\">\n              Exercise Name <span className=\"text-red-500\">*</span>\n            </label>\n            <input\n              type=\"text\"\n              value={name}\n              onChange={(e) => setName(e.target.value)}\n              placeholder=\"e.g., Barbell Bench Press\"\n              className=\"w-full bg-zinc-900 text-white px-4 py-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500\"\n              required\n              autoFocus\n            />\n          </div>\n\n          {/* Equipment - Optional */}\n          <div>\n            <label className=\"text-zinc-300 text-sm font-semibold block mb-2\">\n              Equipment\n            </label>\n            <select\n              value={equipment}\n              onChange={(e) => setEquipment(e.target.value)}\n              className=\"w-full bg-zinc-900 text-white px-4 py-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 appearance-none cursor-pointer\"\n              style={{\n                backgroundImage: `url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3E%3Cpath stroke='%23ffffff' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3E%3C/svg%3E\")`,\n                backgroundPosition: 'right 0.5rem center',\n                backgroundRepeat: 'no-repeat',\n                backgroundSize: '1.5em 1.5em',\n                paddingRight: '2.5rem'\n              }}\n            >\n              <option value=\"\">Select equipment (optional)</option>\n              <option value=\"Barbell\">Barbell</option>\n              <option value=\"Dumbbells\">Dumbbells</option>\n              <option value=\"Bodyweight\">Bodyweight</option>\n              <option value=\"Machine\">Machine</option>\n              <option value=\"Cable\">Cable</option>\n              <option value=\"Bands\">Bands</option>\n              <option value=\"Other\">Other</option>\n            </select>\n          </div>\n\n          {/* Tracking Metric */}\n          <div>\n            <label className=\"text-zinc-300 text-sm font-semibold block mb-2\">\n              Tracking Metric\n            </label>\n            <select\n              value={primaryMetric}\n              onChange={(e) => {\n                const nextMetric = e.target.value as ExercisePrimaryMetric;\n                setPrimaryMetric(nextMetric);\n                if (nextMetric === EXERCISE_PRIMARY_METRICS.time) {\n                  setMetricUnit('sec');\n                } else if (nextMetric === EXERCISE_PRIMARY_METRICS.distance) {\n                  setMetricUnit('m');\n                }\n              }}\n              className=\"w-full bg-zinc-900 text-white px-4 py-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 appearance-none cursor-pointer\"\n              style={{\n                backgroundImage: `url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3E%3Cpath stroke='%23ffffff' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3E%3C/svg%3E\")`,\n                backgroundPosition: 'right 0.5rem center',\n                backgroundRepeat: 'no-repeat',\n                backgroundSize: '1.5em 1.5em',\n                paddingRight: '2.5rem'\n              }}\n            >\n              <option value={EXERCISE_PRIMARY_METRICS.weight}>Weight</option>\n              <option value={EXERCISE_PRIMARY_METRICS.height}>Height</option>\n              <option value={EXERCISE_PRIMARY_METRICS.time}>Time</option>\n              <option value={EXERCISE_PRIMARY_METRICS.distance}>Distance</option>\n              <option value={EXERCISE_PRIMARY_METRICS.repsOnly}>Reps only</option>\n            </select>\n            {primaryMetric === EXERCISE_PRIMARY_METRICS.height && (\n              <p className=\"text-zinc-500 text-xs mt-2\">\n                Uses your profile height unit (in or cm).\n              </p>\n            )}\n          </div>\n\n          {(primaryMetric === EXERCISE_PRIMARY_METRICS.time\n            || primaryMetric === EXERCISE_PRIMARY_METRICS.distance) && (\n            <div>\n              <label className=\"text-zinc-300 text-sm font-semibold block mb-2\">\n                Unit\n              </label>\n              <select\n                value={metricUnit}\n                onChange={(e) => setMetricUnit(e.target.value)}\n                className=\"w-full bg-zinc-900 text-white px-4 py-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 appearance-none cursor-pointer\"\n                style={{\n                  backgroundImage: `url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3E%3Cpath stroke='%23ffffff' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3E%3C/svg%3E\")`,\n                  backgroundPosition: 'right 0.5rem center',\n                  backgroundRepeat: 'no-repeat',\n                  backgroundSize: '1.5em 1.5em',\n                  paddingRight: '2.5rem'\n                }}\n              >\n                {primaryMetric === EXERCISE_PRIMARY_METRICS.time ? (\n                  <>\n                    <option value=\"sec\">sec</option>\n                    <option value=\"min\">min</option>\n                  </>\n                ) : (\n                  <>\n                    <option value=\"m\">m</option>\n                    <option value=\"km\">km</option>\n                    <option value=\"yd\">yd</option>\n                    <option value=\"mi\">mi</option>\n                  </>\n                )}\n              </select>\n            </div>\n          )}\n\n          {/* Video URL - Optional */}\n          <div>\n            <label className=\"text-zinc-300 text-sm font-semibold block mb-2\">\n              Video URL\n            </label>\n            <p className=\"text-zinc-500 text-xs mb-2\">\n              If left empty, will default to YouTube search for \"{name || 'exercise name'}\"\n            </p>\n            <input\n              type=\"url\"\n              value={videoUrl}\n              onChange={(e) => setVideoUrl(e.target.value)}\n              placeholder=\"https://youtube.com/...\"\n              className=\"w-full bg-zinc-900 text-white px-4 py-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500\"\n            />\n          </div>\n\n          {/* Tips - Optional */}\n          <div>\n            <label className=\"text-zinc-300 text-sm font-semibold block mb-2\">\n              Tips\n            </label>\n            <textarea\n              value={tips}\n              onChange={(e) => setTips(e.target.value)}\n              placeholder=\"Form tips, cues, etc.\"\n              rows={3}\n              className=\"w-full bg-zinc-900 text-white px-4 py-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 resize-none\"\n            />\n          </div>\n\n          {/* Buttons */}\n          <div className=\"grid grid-cols-2 gap-3 pt-2\">\n            <button\n              type=\"button\"\n              onClick={onCancel}\n              className=\"bg-zinc-700 hover:bg-zinc-600 text-white py-3 rounded-lg font-semibold transition-colors\"\n            >\n              Cancel\n            </button>\n            <button\n              type=\"submit\"\n              disabled={!name.trim() || submitting}\n              className=\"bg-green-600 hover:bg-green-700 disabled:bg-green-800 disabled:cursor-not-allowed text-white py-3 rounded-lg font-bold transition-colors\"\n            >\n              {submitting ? 'Creating...' : 'Create & Select'}\n            </button>\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 720, "column": 0}, "map": {"version":3,"sources":["file:///Users/devamshroff/Documents/SWE%20Career/projects/gymmer/lib/muscle-tags.ts"],"sourcesContent":["export const MUSCLE_GROUP_TAGS = [\n  'lower body compound',\n  'upper body compound',\n  'full body compound',\n  'chest',\n  'back',\n  'shoulders',\n  'biceps',\n  'triceps',\n  'forearms',\n  'core',\n  'lower back',\n  'glutes',\n  'quads',\n  'hamstrings',\n  'calves',\n  'hip flexors',\n  'adductors',\n  'abductors',\n  'unknown',\n] as const;\n\nexport const STRETCH_MUSCLE_TAGS = [...MUSCLE_GROUP_TAGS] as const;\n\nexport const MUSCLE_GROUP_ORDER = [...MUSCLE_GROUP_TAGS];\nexport const STRETCH_MUSCLE_ORDER = [...STRETCH_MUSCLE_TAGS];\n\nexport function normalizeTypeList(\n  value: unknown,\n  allowed?: readonly string[],\n  maxItems = 2\n): string[] {\n  const entries = Array.isArray(value)\n    ? value\n    : typeof value === 'string'\n      ? [value]\n      : [];\n  if (entries.length === 0) return [];\n  const cleaned = entries\n    .map((item) => (typeof item === 'string' ? item.trim().toLowerCase() : ''))\n    .filter(Boolean);\n  const filtered = allowed ? cleaned.filter((tag) => allowed.includes(tag)) : cleaned;\n  const unique: string[] = [];\n  for (const tag of filtered) {\n    if (!unique.includes(tag)) {\n      unique.push(tag);\n    }\n    if (unique.length >= maxItems) break;\n  }\n  return unique;\n}\n\nexport function parseTagJson(\n  value: string | null | undefined,\n  allowed?: readonly string[],\n  maxItems = 2\n): string[] {\n  if (!value) return [];\n  try {\n    const parsed = JSON.parse(value);\n    return normalizeTypeList(parsed, allowed, maxItems);\n  } catch {\n    return [];\n  }\n}\n\nexport function formatTypeLabel(value: string): string {\n  return value\n    .split(' ')\n    .map((word) => (word ? word[0].toUpperCase() + word.slice(1) : word))\n    .join(' ');\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;AAAO,MAAM,oBAAoB;IAC/B;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;CACD;AAEM,MAAM,sBAAsB;OAAI;CAAkB;AAElD,MAAM,qBAAqB;OAAI;CAAkB;AACjD,MAAM,uBAAuB;OAAI;CAAoB;AAErD,SAAS,kBACd,KAAc,EACd,OAA2B,EAC3B,WAAW,CAAC;IAEZ,MAAM,UAAU,MAAM,OAAO,CAAC,SAC1B,QACA,OAAO,UAAU,WACf;QAAC;KAAM,GACP,EAAE;IACR,IAAI,QAAQ,MAAM,KAAK,GAAG,OAAO,EAAE;IACnC,MAAM,UAAU,QACb,GAAG,CAAC,CAAC,OAAU,OAAO,SAAS,WAAW,KAAK,IAAI,GAAG,WAAW,KAAK,IACtE,MAAM,CAAC;IACV,MAAM,WAAW,UAAU,QAAQ,MAAM,CAAC,CAAC,MAAQ,QAAQ,QAAQ,CAAC,QAAQ;IAC5E,MAAM,SAAmB,EAAE;IAC3B,KAAK,MAAM,OAAO,SAAU;QAC1B,IAAI,CAAC,OAAO,QAAQ,CAAC,MAAM;YACzB,OAAO,IAAI,CAAC;QACd;QACA,IAAI,OAAO,MAAM,IAAI,UAAU;IACjC;IACA,OAAO;AACT;AAEO,SAAS,aACd,KAAgC,EAChC,OAA2B,EAC3B,WAAW,CAAC;IAEZ,IAAI,CAAC,OAAO,OAAO,EAAE;IACrB,IAAI;QACF,MAAM,SAAS,KAAK,KAAK,CAAC;QAC1B,OAAO,kBAAkB,QAAQ,SAAS;IAC5C,EAAE,OAAM;QACN,OAAO,EAAE;IACX;AACF;AAEO,SAAS,gBAAgB,KAAa;IAC3C,OAAO,MACJ,KAAK,CAAC,KACN,GAAG,CAAC,CAAC,OAAU,OAAO,IAAI,CAAC,EAAE,CAAC,WAAW,KAAK,KAAK,KAAK,CAAC,KAAK,MAC9D,IAAI,CAAC;AACV"}},
    {"offset": {"line": 801, "column": 0}, "map": {"version":3,"sources":["file:///Users/devamshroff/Documents/SWE%20Career/projects/gymmer/app/components/ExerciseSelector.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect } from 'react';\nimport QuickExerciseForm from './QuickExerciseForm';\nimport { MUSCLE_GROUP_ORDER, formatTypeLabel, parseTagJson, MUSCLE_GROUP_TAGS } from '@/lib/muscle-tags';\n\ninterface Exercise {\n  id: number;\n  name: string;\n  video_url: string | null;\n  tips: string | null;\n  equipment: string | null;\n  is_bodyweight?: number | null;\n  is_machine?: number | null;\n  primary_metric?: string | null;\n  metric_unit?: string | null;\n  muscle_groups?: string | null;\n}\n\ninterface ExerciseSelectorProps {\n  onSelect: (exercise: Exercise) => void;\n  onCancel: () => void;\n  title?: string;\n}\n\nconst FALLBACK_GROUP = 'other';\n\nfunction getMuscleGroups(exercise: Exercise): string[] {\n  return parseTagJson(exercise.muscle_groups, MUSCLE_GROUP_TAGS);\n}\n\nfunction groupExercisesByType(items: Exercise[]): Array<{ type: string; exercises: Exercise[] }> {\n  const grouped = new Map<string, Exercise[]>();\n  const sorted = [...items].sort((a, b) => a.name.localeCompare(b.name));\n\n  for (const exercise of sorted) {\n    const tags = getMuscleGroups(exercise);\n    const keys = tags.length > 0 ? tags : [FALLBACK_GROUP];\n    for (const key of keys) {\n      const list = grouped.get(key);\n      if (list) {\n        list.push(exercise);\n      } else {\n        grouped.set(key, [exercise]);\n      }\n    }\n  }\n\n  const order = [...MUSCLE_GROUP_ORDER, FALLBACK_GROUP];\n  const keys = Array.from(grouped.keys()).sort((a, b) => {\n    const aIndex = order.indexOf(a);\n    const bIndex = order.indexOf(b);\n    if (aIndex === -1 && bIndex === -1) return a.localeCompare(b);\n    if (aIndex === -1) return 1;\n    if (bIndex === -1) return -1;\n    return aIndex - bIndex;\n  });\n\n  return keys.map((key) => ({ type: key, exercises: grouped.get(key) || [] }));\n}\n\nexport default function ExerciseSelector({ onSelect, onCancel, title }: ExerciseSelectorProps) {\n  const [exercises, setExercises] = useState<Exercise[]>([]);\n  const [searchQuery, setSearchQuery] = useState('');\n  const [loading, setLoading] = useState(true);\n  const [showCreateForm, setShowCreateForm] = useState(false);\n\n  useEffect(() => {\n    fetchExercises();\n  }, []);\n\n  const fetchExercises = async () => {\n    try {\n      const response = await fetch('/api/exercises');\n      const data = await response.json();\n      setExercises(data.exercises);\n    } catch (error) {\n      console.error('Error fetching exercises:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleCreateExercise = async (exerciseData: any) => {\n    try {\n      const response = await fetch('/api/exercises', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(exerciseData)\n      });\n\n      if (!response.ok) {\n        throw new Error('Failed to create exercise');\n      }\n\n      const data = await response.json();\n\n      // Fetch updated list\n      await fetchExercises();\n\n      // Find the newly created exercise and select it\n      const newExercise = exercises.find(e => e.id === data.id) || {\n        id: data.id,\n        name: exerciseData.name,\n        video_url: exerciseData.videoUrl || null,\n        tips: exerciseData.tips || null,\n        equipment: exerciseData.equipment || null,\n        is_bodyweight: typeof data.is_bodyweight === 'number' ? data.is_bodyweight : null,\n        primary_metric: typeof data.primary_metric === 'string' ? data.primary_metric : null,\n        metric_unit: typeof data.metric_unit === 'string' ? data.metric_unit : null\n      };\n\n      onSelect(newExercise);\n    } catch (error) {\n      console.error('Error creating exercise:', error);\n      alert('Failed to create exercise. Please try again.');\n    }\n  };\n\n  const filteredExercises = exercises.filter((exercise) => {\n    if (!searchQuery) return true;\n    const query = searchQuery.toLowerCase();\n    const tagText = getMuscleGroups(exercise).join(' ').toLowerCase();\n    return exercise.name.toLowerCase().includes(query) || tagText.includes(query);\n  });\n  const groupedExercises = groupExercisesByType(filteredExercises);\n\n  if (showCreateForm) {\n    return (\n      <QuickExerciseForm\n        onSubmit={handleCreateExercise}\n        onCancel={() => setShowCreateForm(false)}\n      />\n    );\n  }\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4 z-50\">\n      <div className=\"bg-zinc-800 rounded-lg p-6 max-w-3xl w-full max-h-[90vh] flex flex-col border-2 border-blue-600\">\n        <h2 className=\"text-2xl font-bold text-white mb-4\">{title || 'Select Exercise'}</h2>\n\n        {/* Search & Create */}\n        <div className=\"mb-4 space-y-3\">\n          <input\n            type=\"text\"\n            value={searchQuery}\n            onChange={(e) => setSearchQuery(e.target.value)}\n            placeholder=\"Search exercises or muscle groups...\"\n            className=\"w-full bg-zinc-900 text-white px-4 py-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            autoFocus\n          />\n\n          <button\n            onClick={() => setShowCreateForm(true)}\n            className=\"w-full bg-green-600 hover:bg-green-700 text-white py-3 rounded-lg font-bold transition-colors\"\n          >\n            + Create New Exercise\n          </button>\n        </div>\n\n        {/* Exercise List */}\n        <div className=\"flex-1 overflow-y-auto mb-4 space-y-2\">\n          {loading ? (\n            <div className=\"text-center text-zinc-400 py-8\">Loading exercises...</div>\n          ) : groupedExercises.length === 0 ? (\n            <div className=\"text-center text-zinc-400 py-8\">\n              {searchQuery ? 'No exercises found' : 'No exercises available'}\n            </div>\n          ) : (\n            <div className=\"space-y-4\">\n              {groupedExercises.map(({ type, exercises: groupExercises }) => (\n                <div key={type} className=\"space-y-2\">\n                  <div className=\"text-xs uppercase tracking-wide text-zinc-400\">\n                    {formatTypeLabel(type)}\n                  </div>\n                  {groupExercises.map((exercise) => (\n                    <button\n                      key={exercise.id}\n                      onClick={() => onSelect(exercise)}\n                      className=\"w-full bg-zinc-900 hover:bg-zinc-700 text-left p-4 rounded-lg transition-colors border-2 border-zinc-700 hover:border-blue-500\"\n                    >\n                      <div>\n                        <div className=\"text-white font-semibold\">{exercise.name}</div>\n                        {exercise.equipment && (\n                          <div className=\"text-zinc-400 text-sm mt-1\">{exercise.equipment}</div>\n                        )}\n                      </div>\n                    </button>\n                  ))}\n                </div>\n              ))}\n            </div>\n          )}\n        </div>\n\n        {/* Cancel Button */}\n        <button\n          onClick={onCancel}\n          className=\"w-full bg-zinc-700 hover:bg-zinc-600 text-white py-3 rounded-lg font-semibold transition-colors\"\n        >\n          Cancel\n        </button>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1080, "column": 0}, "map": {"version":3,"sources":["file:///Users/devamshroff/Documents/SWE%20Career/projects/gymmer/app/components/SupersetSelector.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect } from 'react';\nimport QuickExerciseForm from './QuickExerciseForm';\nimport { MUSCLE_GROUP_ORDER, formatTypeLabel, parseTagJson, MUSCLE_GROUP_TAGS } from '@/lib/muscle-tags';\n\ninterface Exercise {\n  id: number;\n  name: string;\n  video_url: string | null;\n  tips: string | null;\n  equipment: string | null;\n  is_bodyweight?: number | null;\n  is_machine?: number | null;\n  primary_metric?: string | null;\n  metric_unit?: string | null;\n  muscle_groups?: string | null;\n}\n\ninterface SupersetSelectorProps {\n  onSelect: (exercise1: Exercise, exercise2: Exercise) => void;\n  onCancel: () => void;\n}\n\nconst FALLBACK_GROUP = 'other';\n\nfunction getMuscleGroups(exercise: Exercise): string[] {\n  return parseTagJson(exercise.muscle_groups, MUSCLE_GROUP_TAGS);\n}\n\nfunction groupExercisesByType(items: Exercise[]): Array<{ type: string; exercises: Exercise[] }> {\n  const grouped = new Map<string, Exercise[]>();\n  const sorted = [...items].sort((a, b) => a.name.localeCompare(b.name));\n\n  for (const exercise of sorted) {\n    const tags = getMuscleGroups(exercise);\n    const keys = tags.length > 0 ? tags : [FALLBACK_GROUP];\n    for (const key of keys) {\n      const list = grouped.get(key);\n      if (list) {\n        list.push(exercise);\n      } else {\n        grouped.set(key, [exercise]);\n      }\n    }\n  }\n\n  const order = [...MUSCLE_GROUP_ORDER, FALLBACK_GROUP];\n  const keys = Array.from(grouped.keys()).sort((a, b) => {\n    const aIndex = order.indexOf(a);\n    const bIndex = order.indexOf(b);\n    if (aIndex === -1 && bIndex === -1) return a.localeCompare(b);\n    if (aIndex === -1) return 1;\n    if (bIndex === -1) return -1;\n    return aIndex - bIndex;\n  });\n\n  return keys.map((key) => ({ type: key, exercises: grouped.get(key) || [] }));\n}\n\nexport default function SupersetSelector({ onSelect, onCancel }: SupersetSelectorProps) {\n  const [exercises, setExercises] = useState<Exercise[]>([]);\n  const [searchQuery1, setSearchQuery1] = useState('');\n  const [searchQuery2, setSearchQuery2] = useState('');\n  const [loading, setLoading] = useState(true);\n  const [exercise1, setExercise1] = useState<Exercise | null>(null);\n  const [exercise2, setExercise2] = useState<Exercise | null>(null);\n  const [showCreateForm, setShowCreateForm] = useState(false);\n  const [createTarget, setCreateTarget] = useState<'exercise1' | 'exercise2' | null>(null);\n\n  useEffect(() => {\n    fetchExercises();\n  }, []);\n\n  const fetchExercises = async () => {\n    try {\n      const response = await fetch('/api/exercises');\n      const data = await response.json();\n      setExercises(data.exercises);\n    } catch (error) {\n      console.error('Error fetching exercises:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleCreateExercise = async (exerciseData: any) => {\n    try {\n      const response = await fetch('/api/exercises', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(exerciseData)\n      });\n\n      if (!response.ok) {\n        throw new Error('Failed to create exercise');\n      }\n\n      const data = await response.json();\n      await fetchExercises();\n\n      const newExercise: Exercise = {\n        id: data.id,\n        name: exerciseData.name,\n        video_url: exerciseData.videoUrl || null,\n        tips: exerciseData.tips || null,\n        equipment: exerciseData.equipment || null,\n        primary_metric: typeof data.primary_metric === 'string' ? data.primary_metric : null,\n        metric_unit: typeof data.metric_unit === 'string' ? data.metric_unit : null\n      };\n\n      if (createTarget === 'exercise1') {\n        setExercise1(newExercise);\n        setSearchQuery1('');\n      } else if (createTarget === 'exercise2') {\n        setExercise2(newExercise);\n        setSearchQuery2('');\n      }\n\n      setShowCreateForm(false);\n      setCreateTarget(null);\n    } catch (error) {\n      console.error('Error creating exercise:', error);\n      alert('Failed to create exercise. Please try again.');\n    }\n  };\n\n  const filteredExercises1 = exercises.filter((exercise) => {\n    if (!searchQuery1) return true;\n    const query = searchQuery1.toLowerCase();\n    const tagText = getMuscleGroups(exercise).join(' ').toLowerCase();\n    return exercise.name.toLowerCase().includes(query) || tagText.includes(query);\n  });\n\n  const filteredExercises2 = exercises.filter((exercise) => {\n    if (!searchQuery2) return true;\n    const query = searchQuery2.toLowerCase();\n    const tagText = getMuscleGroups(exercise).join(' ').toLowerCase();\n    return exercise.name.toLowerCase().includes(query) || tagText.includes(query);\n  });\n\n  const groupedExercises1 = groupExercisesByType(filteredExercises1);\n  const groupedExercises2 = groupExercisesByType(filteredExercises2);\n\n  const handleConfirm = () => {\n    if (exercise1 && exercise2) {\n      onSelect(exercise1, exercise2);\n    }\n  };\n\n  if (showCreateForm) {\n    return (\n      <QuickExerciseForm\n        onSubmit={handleCreateExercise}\n        onCancel={() => {\n          setShowCreateForm(false);\n          setCreateTarget(null);\n        }}\n      />\n    );\n  }\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4 z-50\">\n      <div className=\"bg-zinc-800 rounded-lg p-6 max-w-4xl w-full max-h-[90vh] flex flex-col border-2 border-purple-600\">\n        <h2 className=\"text-2xl font-bold text-white mb-4\">Create Superset</h2>\n        <p className=\"text-zinc-400 text-sm mb-4\">Select two exercises to pair together</p>\n\n        <div className=\"flex-1 overflow-hidden flex gap-4 mb-4\">\n          {/* Exercise 1 Selection */}\n          <div className=\"flex-1 flex flex-col min-h-0\">\n            <div className=\"mb-2\">\n              <div className=\"text-purple-400 text-sm font-bold mb-2\">Exercise 1</div>\n              {exercise1 ? (\n                <div className=\"bg-purple-900/30 border-2 border-purple-500 rounded-lg p-3 flex items-center justify-between\">\n                  <span className=\"text-white font-semibold\">{exercise1.name}</span>\n                  <button\n                    onClick={() => setExercise1(null)}\n                    className=\"text-purple-300 hover:text-white text-sm\"\n                  >\n                    Change\n                  </button>\n                </div>\n              ) : (\n                <div className=\"space-y-2\">\n                  <input\n                    type=\"text\"\n                    value={searchQuery1}\n                    onChange={(e) => setSearchQuery1(e.target.value)}\n                    placeholder=\"Search exercises or muscle groups...\"\n                    className=\"w-full bg-zinc-900 text-white px-3 py-2 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-purple-500\"\n                    autoFocus\n                  />\n                  <button\n                    onClick={() => {\n                      setCreateTarget('exercise1');\n                      setShowCreateForm(true);\n                    }}\n                    className=\"w-full bg-green-600 hover:bg-green-700 text-white py-2 rounded-lg text-sm font-semibold transition-colors\"\n                  >\n                    + Create New Exercise\n                  </button>\n                </div>\n              )}\n            </div>\n\n            {!exercise1 && (\n              <div className=\"flex-1 overflow-y-auto space-y-2\">\n                {loading ? (\n                  <div className=\"text-center text-zinc-400 py-4\">Loading...</div>\n                ) : groupedExercises1.length === 0 ? (\n                  <div className=\"text-center text-zinc-400 py-4\">No exercises found</div>\n                ) : (\n                  <div className=\"space-y-4\">\n                    {groupedExercises1.map(({ type, exercises: groupExercises }) => (\n                      <div key={type} className=\"space-y-2\">\n                        <div className=\"text-[10px] uppercase tracking-wide text-zinc-400\">\n                          {formatTypeLabel(type)}\n                        </div>\n                        {groupExercises.map((exercise) => (\n                          <button\n                            key={exercise.id}\n                            onClick={() => setExercise1(exercise)}\n                            className=\"w-full bg-zinc-900 hover:bg-zinc-700 text-left p-3 rounded-lg transition-colors border border-zinc-700 hover:border-purple-500\"\n                          >\n                            <div className=\"text-white text-sm font-semibold\">{exercise.name}</div>\n                            {exercise.equipment && (\n                              <div className=\"text-zinc-400 text-xs mt-1\">{exercise.equipment}</div>\n                            )}\n                          </button>\n                        ))}\n                      </div>\n                    ))}\n                  </div>\n                )}\n              </div>\n            )}\n          </div>\n\n          {/* Divider */}\n          <div className=\"flex items-center\">\n            <div className=\"text-purple-400 text-2xl font-bold\">+</div>\n          </div>\n\n          {/* Exercise 2 Selection */}\n          <div className=\"flex-1 flex flex-col min-h-0\">\n            <div className=\"mb-2\">\n              <div className=\"text-purple-400 text-sm font-bold mb-2\">Exercise 2</div>\n              {exercise2 ? (\n                <div className=\"bg-purple-900/30 border-2 border-purple-500 rounded-lg p-3 flex items-center justify-between\">\n                  <span className=\"text-white font-semibold\">{exercise2.name}</span>\n                  <button\n                    onClick={() => setExercise2(null)}\n                    className=\"text-purple-300 hover:text-white text-sm\"\n                  >\n                    Change\n                  </button>\n                </div>\n              ) : (\n                <div className=\"space-y-2\">\n                  <input\n                    type=\"text\"\n                    value={searchQuery2}\n                    onChange={(e) => setSearchQuery2(e.target.value)}\n                    placeholder=\"Search exercises or muscle groups...\"\n                    className=\"w-full bg-zinc-900 text-white px-3 py-2 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-purple-500\"\n                  />\n                  <button\n                    onClick={() => {\n                      setCreateTarget('exercise2');\n                      setShowCreateForm(true);\n                    }}\n                    className=\"w-full bg-green-600 hover:bg-green-700 text-white py-2 rounded-lg text-sm font-semibold transition-colors\"\n                  >\n                    + Create New Exercise\n                  </button>\n                </div>\n              )}\n            </div>\n\n            {!exercise2 && (\n              <div className=\"flex-1 overflow-y-auto space-y-2\">\n                {loading ? (\n                  <div className=\"text-center text-zinc-400 py-4\">Loading...</div>\n                ) : groupedExercises2.length === 0 ? (\n                  <div className=\"text-center text-zinc-400 py-4\">No exercises found</div>\n                ) : (\n                  <div className=\"space-y-4\">\n                    {groupedExercises2.map(({ type, exercises: groupExercises }) => (\n                      <div key={type} className=\"space-y-2\">\n                        <div className=\"text-[10px] uppercase tracking-wide text-zinc-400\">\n                          {formatTypeLabel(type)}\n                        </div>\n                        {groupExercises.map((exercise) => (\n                          <button\n                            key={exercise.id}\n                            onClick={() => setExercise2(exercise)}\n                            className=\"w-full bg-zinc-900 hover:bg-zinc-700 text-left p-3 rounded-lg transition-colors border border-zinc-700 hover:border-purple-500\"\n                          >\n                            <div className=\"text-white text-sm font-semibold\">{exercise.name}</div>\n                            {exercise.equipment && (\n                              <div className=\"text-zinc-400 text-xs mt-1\">{exercise.equipment}</div>\n                            )}\n                          </button>\n                        ))}\n                      </div>\n                    ))}\n                  </div>\n                )}\n              </div>\n            )}\n          </div>\n        </div>\n\n        {/* Action Buttons */}\n        <div className=\"flex gap-3\">\n          <button\n            onClick={onCancel}\n            className=\"flex-1 bg-zinc-700 hover:bg-zinc-600 text-white py-3 rounded-lg font-semibold transition-colors\"\n          >\n            Cancel\n          </button>\n          <button\n            onClick={handleConfirm}\n            disabled={!exercise1 || !exercise2}\n            className=\"flex-1 bg-purple-600 hover:bg-purple-700 disabled:bg-purple-900 disabled:cursor-not-allowed text-white py-3 rounded-lg font-bold transition-colors\"\n          >\n            Add Superset\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;;;AAJA;;;;AAwBA,MAAM,iBAAiB;AAEvB,SAAS,gBAAgB,QAAkB;IACzC,OAAO,IAAA,wIAAY,EAAC,SAAS,aAAa,EAAE,6IAAiB;AAC/D;AAEA,SAAS,qBAAqB,KAAiB;IAC7C,MAAM,UAAU,IAAI;IACpB,MAAM,SAAS;WAAI;KAAM,CAAC,IAAI,CAAC,CAAC,GAAG,IAAM,EAAE,IAAI,CAAC,aAAa,CAAC,EAAE,IAAI;IAEpE,KAAK,MAAM,YAAY,OAAQ;QAC7B,MAAM,OAAO,gBAAgB;QAC7B,MAAM,OAAO,KAAK,MAAM,GAAG,IAAI,OAAO;YAAC;SAAe;QACtD,KAAK,MAAM,OAAO,KAAM;YACtB,MAAM,OAAO,QAAQ,GAAG,CAAC;YACzB,IAAI,MAAM;gBACR,KAAK,IAAI,CAAC;YACZ,OAAO;gBACL,QAAQ,GAAG,CAAC,KAAK;oBAAC;iBAAS;YAC7B;QACF;IACF;IAEA,MAAM,QAAQ;WAAI,8IAAkB;QAAE;KAAe;IACrD,MAAM,OAAO,MAAM,IAAI,CAAC,QAAQ,IAAI,IAAI,IAAI,CAAC,CAAC,GAAG;QAC/C,MAAM,SAAS,MAAM,OAAO,CAAC;QAC7B,MAAM,SAAS,MAAM,OAAO,CAAC;QAC7B,IAAI,WAAW,CAAC,KAAK,WAAW,CAAC,GAAG,OAAO,EAAE,aAAa,CAAC;QAC3D,IAAI,WAAW,CAAC,GAAG,OAAO;QAC1B,IAAI,WAAW,CAAC,GAAG,OAAO,CAAC;QAC3B,OAAO,SAAS;IAClB;IAEA,OAAO,KAAK,GAAG,CAAC,CAAC,MAAQ,CAAC;YAAE,MAAM;YAAK,WAAW,QAAQ,GAAG,CAAC,QAAQ,EAAE;QAAC,CAAC;AAC5E;AAEe,SAAS,iBAAiB,EAAE,QAAQ,EAAE,QAAQ,EAAyB;;IACpF,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,yKAAQ,EAAa,EAAE;IACzD,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,yKAAQ,EAAC;IACjD,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,yKAAQ,EAAC;IACjD,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC;IACvC,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,yKAAQ,EAAkB;IAC5D,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,yKAAQ,EAAkB;IAC5D,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,IAAA,yKAAQ,EAAC;IACrD,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,yKAAQ,EAAmC;IAEnF,IAAA,0KAAS;sCAAC;YACR;QACF;qCAAG,EAAE;IAEL,MAAM,iBAAiB;QACrB,IAAI;YACF,MAAM,WAAW,MAAM,MAAM;YAC7B,MAAM,OAAO,MAAM,SAAS,IAAI;YAChC,aAAa,KAAK,SAAS;QAC7B,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,6BAA6B;QAC7C,SAAU;YACR,WAAW;QACb;IACF;IAEA,MAAM,uBAAuB,OAAO;QAClC,IAAI;YACF,MAAM,WAAW,MAAM,MAAM,kBAAkB;gBAC7C,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;YACvB;YAEA,IAAI,CAAC,SAAS,EAAE,EAAE;gBAChB,MAAM,IAAI,MAAM;YAClB;YAEA,MAAM,OAAO,MAAM,SAAS,IAAI;YAChC,MAAM;YAEN,MAAM,cAAwB;gBAC5B,IAAI,KAAK,EAAE;gBACX,MAAM,aAAa,IAAI;gBACvB,WAAW,aAAa,QAAQ,IAAI;gBACpC,MAAM,aAAa,IAAI,IAAI;gBAC3B,WAAW,aAAa,SAAS,IAAI;gBACrC,gBAAgB,OAAO,KAAK,cAAc,KAAK,WAAW,KAAK,cAAc,GAAG;gBAChF,aAAa,OAAO,KAAK,WAAW,KAAK,WAAW,KAAK,WAAW,GAAG;YACzE;YAEA,IAAI,iBAAiB,aAAa;gBAChC,aAAa;gBACb,gBAAgB;YAClB,OAAO,IAAI,iBAAiB,aAAa;gBACvC,aAAa;gBACb,gBAAgB;YAClB;YAEA,kBAAkB;YAClB,gBAAgB;QAClB,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,4BAA4B;YAC1C,MAAM;QACR;IACF;IAEA,MAAM,qBAAqB,UAAU,MAAM,CAAC,CAAC;QAC3C,IAAI,CAAC,cAAc,OAAO;QAC1B,MAAM,QAAQ,aAAa,WAAW;QACtC,MAAM,UAAU,gBAAgB,UAAU,IAAI,CAAC,KAAK,WAAW;QAC/D,OAAO,SAAS,IAAI,CAAC,WAAW,GAAG,QAAQ,CAAC,UAAU,QAAQ,QAAQ,CAAC;IACzE;IAEA,MAAM,qBAAqB,UAAU,MAAM,CAAC,CAAC;QAC3C,IAAI,CAAC,cAAc,OAAO;QAC1B,MAAM,QAAQ,aAAa,WAAW;QACtC,MAAM,UAAU,gBAAgB,UAAU,IAAI,CAAC,KAAK,WAAW;QAC/D,OAAO,SAAS,IAAI,CAAC,WAAW,GAAG,QAAQ,CAAC,UAAU,QAAQ,QAAQ,CAAC;IACzE;IAEA,MAAM,oBAAoB,qBAAqB;IAC/C,MAAM,oBAAoB,qBAAqB;IAE/C,MAAM,gBAAgB;QACpB,IAAI,aAAa,WAAW;YAC1B,SAAS,WAAW;QACtB;IACF;IAEA,IAAI,gBAAgB;QAClB,qBACE,6LAAC,qJAAiB;YAChB,UAAU;YACV,UAAU;gBACR,kBAAkB;gBAClB,gBAAgB;YAClB;;;;;;IAGN;IAEA,qBACE,6LAAC;QAAI,WAAU;kBACb,cAAA,6LAAC;YAAI,WAAU;;8BACb,6LAAC;oBAAG,WAAU;8BAAqC;;;;;;8BACnD,6LAAC;oBAAE,WAAU;8BAA6B;;;;;;8BAE1C,6LAAC;oBAAI,WAAU;;sCAEb,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;oCAAI,WAAU;;sDACb,6LAAC;4CAAI,WAAU;sDAAyC;;;;;;wCACvD,0BACC,6LAAC;4CAAI,WAAU;;8DACb,6LAAC;oDAAK,WAAU;8DAA4B,UAAU,IAAI;;;;;;8DAC1D,6LAAC;oDACC,SAAS,IAAM,aAAa;oDAC5B,WAAU;8DACX;;;;;;;;;;;iEAKH,6LAAC;4CAAI,WAAU;;8DACb,6LAAC;oDACC,MAAK;oDACL,OAAO;oDACP,UAAU,CAAC,IAAM,gBAAgB,EAAE,MAAM,CAAC,KAAK;oDAC/C,aAAY;oDACZ,WAAU;oDACV,SAAS;;;;;;8DAEX,6LAAC;oDACC,SAAS;wDACP,gBAAgB;wDAChB,kBAAkB;oDACpB;oDACA,WAAU;8DACX;;;;;;;;;;;;;;;;;;gCAON,CAAC,2BACA,6LAAC;oCAAI,WAAU;8CACZ,wBACC,6LAAC;wCAAI,WAAU;kDAAiC;;;;;+CAC9C,kBAAkB,MAAM,KAAK,kBAC/B,6LAAC;wCAAI,WAAU;kDAAiC;;;;;6DAEhD,6LAAC;wCAAI,WAAU;kDACZ,kBAAkB,GAAG,CAAC,CAAC,EAAE,IAAI,EAAE,WAAW,cAAc,EAAE,iBACzD,6LAAC;gDAAe,WAAU;;kEACxB,6LAAC;wDAAI,WAAU;kEACZ,IAAA,2IAAe,EAAC;;;;;;oDAElB,eAAe,GAAG,CAAC,CAAC,yBACnB,6LAAC;4DAEC,SAAS,IAAM,aAAa;4DAC5B,WAAU;;8EAEV,6LAAC;oEAAI,WAAU;8EAAoC,SAAS,IAAI;;;;;;gEAC/D,SAAS,SAAS,kBACjB,6LAAC;oEAAI,WAAU;8EAA8B,SAAS,SAAS;;;;;;;2DAN5D,SAAS,EAAE;;;;;;+CANZ;;;;;;;;;;;;;;;;;;;;;sCAyBtB,6LAAC;4BAAI,WAAU;sCACb,cAAA,6LAAC;gCAAI,WAAU;0CAAqC;;;;;;;;;;;sCAItD,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;oCAAI,WAAU;;sDACb,6LAAC;4CAAI,WAAU;sDAAyC;;;;;;wCACvD,0BACC,6LAAC;4CAAI,WAAU;;8DACb,6LAAC;oDAAK,WAAU;8DAA4B,UAAU,IAAI;;;;;;8DAC1D,6LAAC;oDACC,SAAS,IAAM,aAAa;oDAC5B,WAAU;8DACX;;;;;;;;;;;iEAKH,6LAAC;4CAAI,WAAU;;8DACb,6LAAC;oDACC,MAAK;oDACL,OAAO;oDACP,UAAU,CAAC,IAAM,gBAAgB,EAAE,MAAM,CAAC,KAAK;oDAC/C,aAAY;oDACZ,WAAU;;;;;;8DAEZ,6LAAC;oDACC,SAAS;wDACP,gBAAgB;wDAChB,kBAAkB;oDACpB;oDACA,WAAU;8DACX;;;;;;;;;;;;;;;;;;gCAON,CAAC,2BACA,6LAAC;oCAAI,WAAU;8CACZ,wBACC,6LAAC;wCAAI,WAAU;kDAAiC;;;;;+CAC9C,kBAAkB,MAAM,KAAK,kBAC/B,6LAAC;wCAAI,WAAU;kDAAiC;;;;;6DAEhD,6LAAC;wCAAI,WAAU;kDACZ,kBAAkB,GAAG,CAAC,CAAC,EAAE,IAAI,EAAE,WAAW,cAAc,EAAE,iBACzD,6LAAC;gDAAe,WAAU;;kEACxB,6LAAC;wDAAI,WAAU;kEACZ,IAAA,2IAAe,EAAC;;;;;;oDAElB,eAAe,GAAG,CAAC,CAAC,yBACnB,6LAAC;4DAEC,SAAS,IAAM,aAAa;4DAC5B,WAAU;;8EAEV,6LAAC;oEAAI,WAAU;8EAAoC,SAAS,IAAI;;;;;;gEAC/D,SAAS,SAAS,kBACjB,6LAAC;oEAAI,WAAU;8EAA8B,SAAS,SAAS;;;;;;;2DAN5D,SAAS,EAAE;;;;;;+CANZ;;;;;;;;;;;;;;;;;;;;;;;;;;;8BA0BxB,6LAAC;oBAAI,WAAU;;sCACb,6LAAC;4BACC,SAAS;4BACT,WAAU;sCACX;;;;;;sCAGD,6LAAC;4BACC,SAAS;4BACT,UAAU,CAAC,aAAa,CAAC;4BACzB,WAAU;sCACX;;;;;;;;;;;;;;;;;;;;;;;AAOX;GAjRwB;KAAA"}},
    {"offset": {"line": 1636, "column": 0}, "map": {"version":3,"sources":["file:///Users/devamshroff/Documents/SWE%20Career/projects/gymmer/lib/workout-media.ts"],"sourcesContent":["const FALLBACK_FORM_TIPS = 'No form tips yet.';\n\nexport function getFormTips(tips?: string | null): string {\n  if (typeof tips !== 'string') {\n    return FALLBACK_FORM_TIPS;\n  }\n\n  const trimmed = tips.trim();\n  return trimmed.length > 0 ? trimmed : FALLBACK_FORM_TIPS;\n}\n\nexport function getVideoUrl(name?: string | null, videoUrl?: string | null): string {\n  if (typeof videoUrl === 'string' && videoUrl.trim().length > 0) {\n    return videoUrl.trim();\n  }\n\n  const baseName = typeof name === 'string' && name.trim().length > 0 ? name.trim() : 'exercise';\n  const query = `${baseName} form`;\n  return `https://www.youtube.com/results?search_query=${encodeURIComponent(query)}`;\n}\n"],"names":[],"mappings":";;;;;;AAAA,MAAM,qBAAqB;AAEpB,SAAS,YAAY,IAAoB;IAC9C,IAAI,OAAO,SAAS,UAAU;QAC5B,OAAO;IACT;IAEA,MAAM,UAAU,KAAK,IAAI;IACzB,OAAO,QAAQ,MAAM,GAAG,IAAI,UAAU;AACxC;AAEO,SAAS,YAAY,IAAoB,EAAE,QAAwB;IACxE,IAAI,OAAO,aAAa,YAAY,SAAS,IAAI,GAAG,MAAM,GAAG,GAAG;QAC9D,OAAO,SAAS,IAAI;IACtB;IAEA,MAAM,WAAW,OAAO,SAAS,YAAY,KAAK,IAAI,GAAG,MAAM,GAAG,IAAI,KAAK,IAAI,KAAK;IACpF,MAAM,QAAQ,GAAG,SAAS,KAAK,CAAC;IAChC,OAAO,CAAC,6CAA6C,EAAE,mBAAmB,QAAQ;AACpF"}},
    {"offset": {"line": 1665, "column": 0}, "map": {"version":3,"sources":["file:///Users/devamshroff/Documents/SWE%20Career/projects/gymmer/lib/session-workout.ts"],"sourcesContent":["import type { WorkoutPlan } from '@/lib/types';\n\nconst SESSION_PREFIX = 'session_workout_override';\nconst WARNING_PREFIX = 'session_workout_change_ack';\nconst TARGETS_META_PREFIX = 'session_workout_targets_meta';\n\ntype TargetsSource = 'ai' | 'fallback' | null;\n\nexport type SessionTargetsMeta = {\n  encouragement: string | null;\n  goalSummary: string | null;\n  trendSummary: string | null;\n  source: TargetsSource;\n  sessionMode?: string | null;\n};\n\nfunction buildKey(prefix: string, workoutName: string, routineId?: string | null): string {\n  const safeName = encodeURIComponent(workoutName);\n  const safeRoutine = routineId ? encodeURIComponent(routineId) : 'default';\n  return `${prefix}:${safeName}:${safeRoutine}`;\n}\n\nexport function loadSessionWorkout(workoutName: string, routineId?: string | null): WorkoutPlan | null {\n  if (typeof window === 'undefined') return null;\n  const key = buildKey(SESSION_PREFIX, workoutName, routineId);\n  const stored = sessionStorage.getItem(key);\n  if (!stored) return null;\n  try {\n    return JSON.parse(stored) as WorkoutPlan;\n  } catch (error) {\n    console.error('Failed to parse session workout override:', error);\n    return null;\n  }\n}\n\nexport function saveSessionWorkout(plan: WorkoutPlan, routineId?: string | null): void {\n  if (typeof window === 'undefined') return;\n  const key = buildKey(SESSION_PREFIX, plan.name, routineId);\n  sessionStorage.setItem(key, JSON.stringify(plan));\n}\n\nexport function clearSessionWorkout(workoutName: string, routineId?: string | null): void {\n  if (typeof window === 'undefined') return;\n  const key = buildKey(SESSION_PREFIX, workoutName, routineId);\n  sessionStorage.removeItem(key);\n}\n\nexport function loadSessionTargetsMeta(\n  workoutName: string,\n  routineId?: string | null\n): SessionTargetsMeta | null {\n  if (typeof window === 'undefined') return null;\n  const key = buildKey(TARGETS_META_PREFIX, workoutName, routineId);\n  const stored = sessionStorage.getItem(key);\n  if (!stored) return null;\n  try {\n    return JSON.parse(stored) as SessionTargetsMeta;\n  } catch (error) {\n    console.error('Failed to parse session targets meta:', error);\n    return null;\n  }\n}\n\nexport function saveSessionTargetsMeta(\n  workoutName: string,\n  routineId: string | null | undefined,\n  meta: SessionTargetsMeta | null\n): void {\n  if (typeof window === 'undefined') return;\n  const key = buildKey(TARGETS_META_PREFIX, workoutName, routineId);\n  if (!meta) {\n    sessionStorage.removeItem(key);\n    return;\n  }\n  sessionStorage.setItem(key, JSON.stringify(meta));\n}\n\nexport function clearSessionTargetsMeta(workoutName: string, routineId?: string | null): void {\n  if (typeof window === 'undefined') return;\n  const key = buildKey(TARGETS_META_PREFIX, workoutName, routineId);\n  sessionStorage.removeItem(key);\n}\n\nexport function hasChangeWarningAck(workoutName: string, routineId?: string | null): boolean {\n  if (typeof window === 'undefined') return false;\n  const key = buildKey(WARNING_PREFIX, workoutName, routineId);\n  return sessionStorage.getItem(key) === '1';\n}\n\nexport function acknowledgeChangeWarning(workoutName: string, routineId?: string | null): void {\n  if (typeof window === 'undefined') return;\n  const key = buildKey(WARNING_PREFIX, workoutName, routineId);\n  sessionStorage.setItem(key, '1');\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;AAEA,MAAM,iBAAiB;AACvB,MAAM,iBAAiB;AACvB,MAAM,sBAAsB;AAY5B,SAAS,SAAS,MAAc,EAAE,WAAmB,EAAE,SAAyB;IAC9E,MAAM,WAAW,mBAAmB;IACpC,MAAM,cAAc,YAAY,mBAAmB,aAAa;IAChE,OAAO,GAAG,OAAO,CAAC,EAAE,SAAS,CAAC,EAAE,aAAa;AAC/C;AAEO,SAAS,mBAAmB,WAAmB,EAAE,SAAyB;IAC/E;;IACA,MAAM,MAAM,SAAS,gBAAgB,aAAa;IAClD,MAAM,SAAS,eAAe,OAAO,CAAC;IACtC,IAAI,CAAC,QAAQ,OAAO;IACpB,IAAI;QACF,OAAO,KAAK,KAAK,CAAC;IACpB,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,6CAA6C;QAC3D,OAAO;IACT;AACF;AAEO,SAAS,mBAAmB,IAAiB,EAAE,SAAyB;IAC7E;;IACA,MAAM,MAAM,SAAS,gBAAgB,KAAK,IAAI,EAAE;IAChD,eAAe,OAAO,CAAC,KAAK,KAAK,SAAS,CAAC;AAC7C;AAEO,SAAS,oBAAoB,WAAmB,EAAE,SAAyB;IAChF;;IACA,MAAM,MAAM,SAAS,gBAAgB,aAAa;IAClD,eAAe,UAAU,CAAC;AAC5B;AAEO,SAAS,uBACd,WAAmB,EACnB,SAAyB;IAEzB;;IACA,MAAM,MAAM,SAAS,qBAAqB,aAAa;IACvD,MAAM,SAAS,eAAe,OAAO,CAAC;IACtC,IAAI,CAAC,QAAQ,OAAO;IACpB,IAAI;QACF,OAAO,KAAK,KAAK,CAAC;IACpB,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,yCAAyC;QACvD,OAAO;IACT;AACF;AAEO,SAAS,uBACd,WAAmB,EACnB,SAAoC,EACpC,IAA+B;IAE/B;;IACA,MAAM,MAAM,SAAS,qBAAqB,aAAa;IACvD,IAAI,CAAC,MAAM;QACT,eAAe,UAAU,CAAC;QAC1B;IACF;IACA,eAAe,OAAO,CAAC,KAAK,KAAK,SAAS,CAAC;AAC7C;AAEO,SAAS,wBAAwB,WAAmB,EAAE,SAAyB;IACpF;;IACA,MAAM,MAAM,SAAS,qBAAqB,aAAa;IACvD,eAAe,UAAU,CAAC;AAC5B;AAEO,SAAS,oBAAoB,WAAmB,EAAE,SAAyB;IAChF;;IACA,MAAM,MAAM,SAAS,gBAAgB,aAAa;IAClD,OAAO,eAAe,OAAO,CAAC,SAAS;AACzC;AAEO,SAAS,yBAAyB,WAAmB,EAAE,SAAyB;IACrF;;IACA,MAAM,MAAM,SAAS,gBAAgB,aAAa;IAClD,eAAe,OAAO,CAAC,KAAK;AAC9B"}},
    {"offset": {"line": 1764, "column": 0}, "map": {"version":3,"sources":["file:///Users/devamshroff/Documents/SWE%20Career/projects/gymmer/app/components/WorkoutNavHeader.tsx"],"sourcesContent":["'use client';\n\nimport { useRouter } from 'next/navigation';\nimport Link from 'next/link';\n\ninterface WorkoutNavHeaderProps {\n  exitUrl: string;\n  previousUrl: string | null;\n  onPrevious?: () => void; // Optional callback for internal state changes\n  skipUrl?: string; // Optional skip button on right side\n  skipLabel?: string;\n  onSkip?: () => void;\n  // For review mode - show Next instead of Skip\n  nextLabel?: string;\n  onNext?: () => void;\n}\n\n/**\n * Unified navigation header for workout flow\n * Shows exit button and previous button on left, optional skip/next on right\n */\nexport default function WorkoutNavHeader({\n  exitUrl,\n  previousUrl,\n  onPrevious,\n  skipUrl,\n  skipLabel = 'Skip',\n  onSkip,\n  nextLabel = 'Next',\n  onNext,\n}: WorkoutNavHeaderProps) {\n  const router = useRouter();\n\n  const handlePrevious = () => {\n    if (onPrevious) {\n      // Use callback for internal navigation (within same page)\n      onPrevious();\n    } else if (previousUrl) {\n      // Navigate to previous URL\n      router.push(previousUrl);\n    }\n  };\n\n  const handleSkip = () => {\n    if (onSkip) {\n      onSkip();\n    } else if (skipUrl) {\n      router.push(skipUrl);\n    }\n  };\n\n  const canGoPrevious = !!previousUrl || !!onPrevious;\n  const showSkip = skipUrl || onSkip;\n  const showNext = !!onNext;\n\n  return (\n    <div className=\"flex justify-between items-center mb-6\">\n      {/* Left side: Exit and Previous */}\n      <div className=\"flex items-center gap-4\">\n        <Link\n          href={exitUrl}\n          className=\"text-red-400 hover:text-red-300 font-medium\"\n        >\n          Exit\n        </Link>\n        <button\n          onClick={handlePrevious}\n          disabled={!canGoPrevious}\n          className={`font-medium ${\n            canGoPrevious\n              ? 'text-blue-400 hover:text-blue-300'\n              : 'text-zinc-600 cursor-not-allowed'\n          }`}\n        >\n           Previous\n        </button>\n      </div>\n\n      {/* Right side: Next (review mode) or Skip */}\n      {showNext ? (\n        <button\n          onClick={onNext}\n          className=\"text-blue-400 hover:text-blue-300 font-medium\"\n        >\n          {nextLabel} \n        </button>\n      ) : showSkip ? (\n        <button\n          onClick={handleSkip}\n          className=\"text-zinc-400 hover:text-zinc-300\"\n        >\n          {skipLabel} \n        </button>\n      ) : null}\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;;;AAHA;;;AAqBe,SAAS,iBAAiB,EACvC,OAAO,EACP,WAAW,EACX,UAAU,EACV,OAAO,EACP,YAAY,MAAM,EAClB,MAAM,EACN,YAAY,MAAM,EAClB,MAAM,EACgB;;IACtB,MAAM,SAAS,IAAA,kJAAS;IAExB,MAAM,iBAAiB;QACrB,IAAI,YAAY;YACd,0DAA0D;YAC1D;QACF,OAAO,IAAI,aAAa;YACtB,2BAA2B;YAC3B,OAAO,IAAI,CAAC;QACd;IACF;IAEA,MAAM,aAAa;QACjB,IAAI,QAAQ;YACV;QACF,OAAO,IAAI,SAAS;YAClB,OAAO,IAAI,CAAC;QACd;IACF;IAEA,MAAM,gBAAgB,CAAC,CAAC,eAAe,CAAC,CAAC;IACzC,MAAM,WAAW,WAAW;IAC5B,MAAM,WAAW,CAAC,CAAC;IAEnB,qBACE,6LAAC;QAAI,WAAU;;0BAEb,6LAAC;gBAAI,WAAU;;kCACb,6LAAC,0KAAI;wBACH,MAAM;wBACN,WAAU;kCACX;;;;;;kCAGD,6LAAC;wBACC,SAAS;wBACT,UAAU,CAAC;wBACX,WAAW,CAAC,YAAY,EACtB,gBACI,sCACA,oCACJ;kCACH;;;;;;;;;;;;YAMF,yBACC,6LAAC;gBACC,SAAS;gBACT,WAAU;;oBAET;oBAAU;;;;;;uBAEX,yBACF,6LAAC;gBACC,SAAS;gBACT,WAAU;;oBAET;oBAAU;;;;;;uBAEX;;;;;;;AAGV;GA3EwB;;QAUP,kJAAS;;;KAVF"}},
    {"offset": {"line": 1874, "column": 0}, "map": {"version":3,"sources":["file:///Users/devamshroff/Documents/SWE%20Career/projects/gymmer/lib/units.ts"],"sourcesContent":["export const WEIGHT_UNITS = {\n  lbs: 'lbs',\n  kg: 'kg',\n} as const;\n\nexport type WeightUnit = typeof WEIGHT_UNITS[keyof typeof WEIGHT_UNITS];\n\nexport const HEIGHT_UNITS = {\n  in: 'in',\n  cm: 'cm',\n} as const;\n\nexport type HeightUnit = typeof HEIGHT_UNITS[keyof typeof HEIGHT_UNITS];\n\nexport const DEFAULT_WEIGHT_UNIT: WeightUnit = WEIGHT_UNITS.lbs;\nexport const DEFAULT_HEIGHT_UNIT: HeightUnit = HEIGHT_UNITS.in;\n\nconst KG_PER_LB = 0.45359237;\nconst CM_PER_IN = 2.54;\n\nexport function isWeightUnit(value: unknown): value is WeightUnit {\n  return value === WEIGHT_UNITS.lbs || value === WEIGHT_UNITS.kg;\n}\n\nexport function isHeightUnit(value: unknown): value is HeightUnit {\n  return value === HEIGHT_UNITS.in || value === HEIGHT_UNITS.cm;\n}\n\nexport function normalizeWeightUnit(value: unknown): WeightUnit {\n  return isWeightUnit(value) ? value : DEFAULT_WEIGHT_UNIT;\n}\n\nexport function normalizeHeightUnit(value: unknown): HeightUnit {\n  return isHeightUnit(value) ? value : DEFAULT_HEIGHT_UNIT;\n}\n\nexport function convertWeightFromStorage(weight: number, unit: WeightUnit): number {\n  if (!Number.isFinite(weight)) return 0;\n  return unit === WEIGHT_UNITS.kg ? weight * KG_PER_LB : weight;\n}\n\nexport function convertWeightToStorage(weight: number, unit: WeightUnit): number {\n  if (!Number.isFinite(weight)) return 0;\n  return unit === WEIGHT_UNITS.kg ? weight / KG_PER_LB : weight;\n}\n\nexport function convertHeightFromStorage(height: number, unit: HeightUnit): number {\n  if (!Number.isFinite(height)) return 0;\n  return unit === HEIGHT_UNITS.cm ? height * CM_PER_IN : height;\n}\n\nexport function convertHeightToStorage(height: number, unit: HeightUnit): number {\n  if (!Number.isFinite(height)) return 0;\n  return unit === HEIGHT_UNITS.cm ? height / CM_PER_IN : height;\n}\n\nexport function formatDisplayNumber(value: number): string {\n  if (!Number.isFinite(value)) return '0';\n  const rounded = Math.round(value * 10) / 10;\n  return Number.isInteger(rounded) ? rounded.toString() : rounded.toFixed(1);\n}\n\nexport function formatWeightValue(weight: number, unit: WeightUnit): string {\n  return formatDisplayNumber(convertWeightFromStorage(weight, unit));\n}\n\nexport function formatWeightDisplay(weight: number, unit: WeightUnit, isMachine?: boolean): string {\n  if (isMachine) {\n    if (weight <= 0) return 'Machine';\n    return `+${formatWeightValue(weight, unit)} ${unit}`;\n  }\n  return `${formatWeightValue(weight, unit)} ${unit}`;\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAO,MAAM,eAAe;IAC1B,KAAK;IACL,IAAI;AACN;AAIO,MAAM,eAAe;IAC1B,IAAI;IACJ,IAAI;AACN;AAIO,MAAM,sBAAkC,aAAa,GAAG;AACxD,MAAM,sBAAkC,aAAa,EAAE;AAE9D,MAAM,YAAY;AAClB,MAAM,YAAY;AAEX,SAAS,aAAa,KAAc;IACzC,OAAO,UAAU,aAAa,GAAG,IAAI,UAAU,aAAa,EAAE;AAChE;AAEO,SAAS,aAAa,KAAc;IACzC,OAAO,UAAU,aAAa,EAAE,IAAI,UAAU,aAAa,EAAE;AAC/D;AAEO,SAAS,oBAAoB,KAAc;IAChD,OAAO,aAAa,SAAS,QAAQ;AACvC;AAEO,SAAS,oBAAoB,KAAc;IAChD,OAAO,aAAa,SAAS,QAAQ;AACvC;AAEO,SAAS,yBAAyB,MAAc,EAAE,IAAgB;IACvE,IAAI,CAAC,OAAO,QAAQ,CAAC,SAAS,OAAO;IACrC,OAAO,SAAS,aAAa,EAAE,GAAG,SAAS,YAAY;AACzD;AAEO,SAAS,uBAAuB,MAAc,EAAE,IAAgB;IACrE,IAAI,CAAC,OAAO,QAAQ,CAAC,SAAS,OAAO;IACrC,OAAO,SAAS,aAAa,EAAE,GAAG,SAAS,YAAY;AACzD;AAEO,SAAS,yBAAyB,MAAc,EAAE,IAAgB;IACvE,IAAI,CAAC,OAAO,QAAQ,CAAC,SAAS,OAAO;IACrC,OAAO,SAAS,aAAa,EAAE,GAAG,SAAS,YAAY;AACzD;AAEO,SAAS,uBAAuB,MAAc,EAAE,IAAgB;IACrE,IAAI,CAAC,OAAO,QAAQ,CAAC,SAAS,OAAO;IACrC,OAAO,SAAS,aAAa,EAAE,GAAG,SAAS,YAAY;AACzD;AAEO,SAAS,oBAAoB,KAAa;IAC/C,IAAI,CAAC,OAAO,QAAQ,CAAC,QAAQ,OAAO;IACpC,MAAM,UAAU,KAAK,KAAK,CAAC,QAAQ,MAAM;IACzC,OAAO,OAAO,SAAS,CAAC,WAAW,QAAQ,QAAQ,KAAK,QAAQ,OAAO,CAAC;AAC1E;AAEO,SAAS,kBAAkB,MAAc,EAAE,IAAgB;IAChE,OAAO,oBAAoB,yBAAyB,QAAQ;AAC9D;AAEO,SAAS,oBAAoB,MAAc,EAAE,IAAgB,EAAE,SAAmB;IACvF,IAAI,WAAW;QACb,IAAI,UAAU,GAAG,OAAO;QACxB,OAAO,CAAC,CAAC,EAAE,kBAAkB,QAAQ,MAAM,CAAC,EAAE,MAAM;IACtD;IACA,OAAO,GAAG,kBAAkB,QAAQ,MAAM,CAAC,EAAE,MAAM;AACrD"}},
    {"offset": {"line": 1968, "column": 0}, "map": {"version":3,"sources":["file:///Users/devamshroff/Documents/SWE%20Career/projects/gymmer/lib/metric-utils.ts"],"sourcesContent":["import { EXERCISE_PRIMARY_METRICS } from '@/lib/constants';\nimport type { ExercisePrimaryMetric } from '@/lib/constants';\nimport {\n  convertHeightFromStorage,\n  convertHeightToStorage,\n  convertWeightFromStorage,\n  convertWeightToStorage,\n  formatDisplayNumber,\n  formatWeightDisplay,\n} from '@/lib/units';\nimport type { HeightUnit, WeightUnit } from '@/lib/units';\n\ntype MetricUnit = string | null | undefined;\n\nexport function isPrimaryMetric(value: unknown): value is ExercisePrimaryMetric {\n  return Object.values(EXERCISE_PRIMARY_METRICS).includes(value as ExercisePrimaryMetric);\n}\n\nexport function resolvePrimaryMetric(\n  primaryMetric: unknown,\n  isBodyweight?: boolean\n): ExercisePrimaryMetric {\n  if (isPrimaryMetric(primaryMetric)) return primaryMetric;\n  if (isBodyweight) return EXERCISE_PRIMARY_METRICS.repsOnly;\n  return EXERCISE_PRIMARY_METRICS.weight;\n}\n\nexport function resolveMetricUnit(\n  primaryMetric: ExercisePrimaryMetric,\n  metricUnit: MetricUnit,\n  weightUnit: WeightUnit,\n  heightUnit: HeightUnit\n): string | null {\n  switch (primaryMetric) {\n    case EXERCISE_PRIMARY_METRICS.weight:\n      return weightUnit;\n    case EXERCISE_PRIMARY_METRICS.height:\n      return heightUnit;\n    case EXERCISE_PRIMARY_METRICS.time:\n      return metricUnit || 'sec';\n    case EXERCISE_PRIMARY_METRICS.distance:\n      return metricUnit || 'm';\n    default:\n      return null;\n  }\n}\n\nexport function getDefaultMetricUnit(primaryMetric: ExercisePrimaryMetric): string | null {\n  switch (primaryMetric) {\n    case EXERCISE_PRIMARY_METRICS.weight:\n      return 'lbs';\n    case EXERCISE_PRIMARY_METRICS.height:\n      return 'in';\n    case EXERCISE_PRIMARY_METRICS.time:\n      return 'sec';\n    case EXERCISE_PRIMARY_METRICS.distance:\n      return 'm';\n    default:\n      return null;\n  }\n}\n\nexport function assertPrimaryMetric(value: unknown): asserts value is ExercisePrimaryMetric {\n  if (!isPrimaryMetric(value)) {\n    throw new Error('primaryMetric is required');\n  }\n}\n\nexport function getMetricLabel(\n  primaryMetric: ExercisePrimaryMetric,\n  metricUnit: MetricUnit,\n  weightUnit: WeightUnit,\n  heightUnit: HeightUnit,\n  isMachine?: boolean\n): string {\n  const resolvedUnit = resolveMetricUnit(primaryMetric, metricUnit, weightUnit, heightUnit);\n  switch (primaryMetric) {\n    case EXERCISE_PRIMARY_METRICS.weight:\n      return isMachine ? `Added Weight (${resolvedUnit})` : `Weight (${resolvedUnit})`;\n    case EXERCISE_PRIMARY_METRICS.height:\n      return `Height (${resolvedUnit})`;\n    case EXERCISE_PRIMARY_METRICS.time:\n      return `Time (${resolvedUnit})`;\n    case EXERCISE_PRIMARY_METRICS.distance:\n      return `Distance (${resolvedUnit})`;\n    case EXERCISE_PRIMARY_METRICS.repsOnly:\n      return 'Reps';\n    default:\n      return 'Value';\n  }\n}\n\nexport function convertMetricFromStorage(\n  value: number,\n  primaryMetric: ExercisePrimaryMetric,\n  weightUnit: WeightUnit,\n  heightUnit: HeightUnit\n): number {\n  if (!Number.isFinite(value)) return 0;\n  if (primaryMetric === EXERCISE_PRIMARY_METRICS.weight) {\n    return convertWeightFromStorage(value, weightUnit);\n  }\n  if (primaryMetric === EXERCISE_PRIMARY_METRICS.height) {\n    return convertHeightFromStorage(value, heightUnit);\n  }\n  return value;\n}\n\nexport function convertMetricToStorage(\n  value: number,\n  primaryMetric: ExercisePrimaryMetric,\n  weightUnit: WeightUnit,\n  heightUnit: HeightUnit\n): number {\n  if (!Number.isFinite(value)) return 0;\n  if (primaryMetric === EXERCISE_PRIMARY_METRICS.weight) {\n    return convertWeightToStorage(value, weightUnit);\n  }\n  if (primaryMetric === EXERCISE_PRIMARY_METRICS.height) {\n    return convertHeightToStorage(value, heightUnit);\n  }\n  return value;\n}\n\nexport function formatMetricDisplay(\n  value: number,\n  primaryMetric: ExercisePrimaryMetric,\n  metricUnit: MetricUnit,\n  weightUnit: WeightUnit,\n  heightUnit: HeightUnit,\n  isMachine?: boolean\n): string {\n  if (primaryMetric === EXERCISE_PRIMARY_METRICS.weight) {\n    return formatWeightDisplay(value, weightUnit, isMachine);\n  }\n  const resolvedUnit = resolveMetricUnit(primaryMetric, metricUnit, weightUnit, heightUnit);\n  const displayValue = convertMetricFromStorage(value, primaryMetric, weightUnit, heightUnit);\n  return resolvedUnit ? `${formatDisplayNumber(displayValue)} ${resolvedUnit}` : formatDisplayNumber(displayValue);\n}\n\nexport function formatMetricInputValue(\n  value: number,\n  primaryMetric: ExercisePrimaryMetric,\n  weightUnit: WeightUnit,\n  heightUnit: HeightUnit,\n  allowBlank = false\n): string {\n  if (allowBlank && value === 0) return '';\n  const displayValue = convertMetricFromStorage(value, primaryMetric, weightUnit, heightUnit);\n  return formatDisplayNumber(displayValue);\n}\n\nexport function parseMetricInput(\n  value: string,\n  primaryMetric: ExercisePrimaryMetric,\n  weightUnit: WeightUnit,\n  heightUnit: HeightUnit\n): number | null {\n  if (value === '') return 0;\n  const num = parseFloat(value);\n  if (!Number.isFinite(num)) return null;\n  return convertMetricToStorage(num, primaryMetric, weightUnit, heightUnit);\n}\n\nexport function isRepsOnlyMetric(primaryMetric: ExercisePrimaryMetric): boolean {\n  return primaryMetric === EXERCISE_PRIMARY_METRICS.repsOnly;\n}\n\nexport function isWeightMetric(primaryMetric: ExercisePrimaryMetric): boolean {\n  return primaryMetric === EXERCISE_PRIMARY_METRICS.weight;\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2110, "column": 0}, "map": {"version":3,"sources":["file:///Users/devamshroff/Documents/SWE%20Career/projects/gymmer/app/components/ExerciseHistoryModal.tsx"],"sourcesContent":["'use client';\n\nimport { useEffect, useMemo, useState } from 'react';\nimport {\n  EXERCISE_HISTORY_AGGREGATION_MODES,\n  EXERCISE_HISTORY_DISPLAY_MODES,\n  ExerciseHistoryAggregationMode,\n  ExerciseHistoryDisplayMode,\n} from '@/lib/constants';\nimport {\n  DEFAULT_HEIGHT_UNIT,\n  DEFAULT_WEIGHT_UNIT,\n} from '@/lib/units';\nimport type { HeightUnit, WeightUnit } from '@/lib/units';\nimport {\n  convertMetricFromStorage,\n  getMetricLabel,\n  isRepsOnlyMetric,\n  isWeightMetric,\n  resolveMetricUnit,\n  resolvePrimaryMetric,\n} from '@/lib/metric-utils';\n\ntype HistoryRange = 'week' | 'month' | 'all';\ntype WeightMode = ExerciseHistoryAggregationMode;\n\ntype HistoryPoint = {\n  day: string;\n  weight_max: number | null;\n  weight_avg: number | null;\n  volume: number | null;\n  reps_max: number | null;\n  reps_avg: number | null;\n  reps_total: number | null;\n};\n\ntype ExerciseHistorySeries = {\n  display_mode: ExerciseHistoryDisplayMode;\n  is_machine?: boolean;\n  primary_metric?: string | null;\n  metric_unit?: string | null;\n  points: HistoryPoint[];\n};\n\ntype ExerciseHistoryModalProps = {\n  open: boolean;\n  onClose: () => void;\n  exerciseNames: string[];\n  title?: string;\n  targets?: Record<string, { weight?: number | null; reps?: number | null }>;\n  weightUnit?: WeightUnit;\n  heightUnit?: HeightUnit;\n};\n\nconst RANGE_LABELS: Record<HistoryRange, string> = {\n  week: '1W',\n  month: '1M',\n  all: 'All',\n};\n\nfunction formatDayLabel(day: string): string {\n  const date = new Date(`${day}T00:00:00Z`);\n  if (Number.isNaN(date.getTime())) return day;\n  return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });\n}\n\nfunction formatNumber(value: number): string {\n  const rounded = Math.round(value * 10) / 10;\n  if (rounded >= 1000000) return `${(rounded / 1000000).toFixed(1)}M`;\n  if (rounded >= 1000) return `${(rounded / 1000).toFixed(1)}k`;\n  return Number.isInteger(rounded) ? rounded.toString() : rounded.toFixed(1);\n}\n\nfunction buildLinePath(points: Array<{ x: number; y: number }>): string {\n  if (points.length === 0) return '';\n  return points.map((point, index) => `${index === 0 ? 'M' : 'L'} ${point.x} ${point.y}`).join(' ');\n}\n\nfunction LineChart({\n  points,\n  weightMode,\n  mode,\n  primaryMetric,\n  metricUnit,\n  targetValue,\n  isMachine,\n  weightUnit,\n  heightUnit,\n}: {\n  points: HistoryPoint[];\n  weightMode: WeightMode;\n  mode: ExerciseHistoryDisplayMode;\n  primaryMetric: ReturnType<typeof resolvePrimaryMetric>;\n  metricUnit: string | null;\n  targetValue?: number | null;\n  isMachine?: boolean;\n  weightUnit: WeightUnit;\n  heightUnit: HeightUnit;\n}) {\n  const [tooltip, setTooltip] = useState<{ x: number; y: number; label: string } | null>(null);\n  const width = 720;\n  const height = 280;\n  const margin = { top: 16, right: 64, bottom: 40, left: 64 };\n  const plotWidth = width - margin.left - margin.right;\n  const plotHeight = height - margin.top - margin.bottom;\n\n  const isRepsPrimary = mode === EXERCISE_HISTORY_DISPLAY_MODES.reps || isRepsOnlyMetric(primaryMetric);\n  const isWeightPrimary = isWeightMetric(primaryMetric);\n  const isMachineWeight = !!isMachine && isWeightPrimary;\n  const resolvedUnit = resolveMetricUnit(primaryMetric, metricUnit, weightUnit, heightUnit);\n  const secondaryUnit = resolvedUnit ?? weightUnit;\n  const unitSuffix = resolvedUnit ? ` ${resolvedUnit}` : '';\n  const convertPrimaryValue = (value: number | null) => (\n    value === null ? null : convertMetricFromStorage(value, primaryMetric, weightUnit, heightUnit)\n  );\n  const useVolume = !isRepsPrimary && isWeightPrimary;\n  const primaryValues = points\n    .map((point) => {\n      if (isRepsPrimary) {\n        return weightMode === EXERCISE_HISTORY_AGGREGATION_MODES.max ? point.reps_max : point.reps_avg;\n      }\n      const rawValue = weightMode === EXERCISE_HISTORY_AGGREGATION_MODES.max ? point.weight_max : point.weight_avg;\n      return convertPrimaryValue(rawValue);\n    })\n    .filter((value): value is number => value !== null);\n  const displayTargetValue = targetValue == null\n    ? null\n    : convertMetricFromStorage(targetValue, primaryMetric, weightUnit, heightUnit);\n  const hasTargetValue = displayTargetValue !== null && Number.isFinite(displayTargetValue) && displayTargetValue > 0;\n  if (hasTargetValue) {\n    primaryValues.push(displayTargetValue);\n  }\n  const secondaryValues = points\n    .map((point) => {\n      if (isRepsPrimary || !useVolume) {\n        return point.reps_total;\n      }\n      return convertPrimaryValue(point.volume);\n    })\n    .filter((value): value is number => value !== null);\n\n  let primaryMin = primaryValues.length ? Math.min(...primaryValues) : 0;\n  let primaryMax = primaryValues.length ? Math.max(...primaryValues) : 1;\n  let secondaryMin = secondaryValues.length ? Math.min(...secondaryValues) : 0;\n  let secondaryMax = secondaryValues.length ? Math.max(...secondaryValues) : 1;\n\n  if (primaryMax === primaryMin) {\n    const pad = Math.max(1, Math.abs(primaryMax) * 0.2);\n    primaryMin -= pad;\n    primaryMax += pad;\n  }\n  if (secondaryMax === secondaryMin) {\n    const pad = Math.max(1, Math.abs(secondaryMax) * 0.2);\n    secondaryMin -= pad;\n    secondaryMax += pad;\n  }\n  if (isMachineWeight) {\n    primaryMin = 0;\n    if (primaryMax <= primaryMin) {\n      primaryMax = primaryMin + 1;\n    }\n  }\n\n  const primaryRange = primaryMax - primaryMin || 1;\n  const secondaryRange = secondaryMax - secondaryMin || 1;\n\n  const stepX = points.length > 1 ? plotWidth / (points.length - 1) : 0;\n  const basePoints = points.map((point, index) => {\n    const primaryValue = isRepsPrimary\n      ? (weightMode === EXERCISE_HISTORY_AGGREGATION_MODES.max ? point.reps_max : point.reps_avg)\n      : convertPrimaryValue(\n        weightMode === EXERCISE_HISTORY_AGGREGATION_MODES.max ? point.weight_max : point.weight_avg\n      );\n    const secondaryValue = isRepsPrimary || !useVolume\n      ? point.reps_total\n      : convertPrimaryValue(point.volume);\n    const baseX = margin.left + index * stepX;\n    const hasPrimary = primaryValue !== null;\n    const hasSecondary = secondaryValue !== null;\n    const offset = hasPrimary && hasSecondary ? 6 : 0;\n    return {\n      baseX,\n      primaryValue,\n      secondaryValue,\n      primaryX: baseX - offset,\n      secondaryX: baseX + offset\n    };\n  });\n\n  const primaryPoints = basePoints\n    .map((point) => {\n      if (point.primaryValue === null) return null;\n      const y = margin.top + plotHeight - ((point.primaryValue - primaryMin) / primaryRange) * plotHeight;\n      return { x: point.primaryX, y, value: point.primaryValue };\n    })\n    .filter((point): point is { x: number; y: number; value: number } => point !== null);\n\n  const secondaryPoints = basePoints\n    .map((point) => {\n      if (point.secondaryValue === null) return null;\n      const y = margin.top + plotHeight - ((point.secondaryValue - secondaryMin) / secondaryRange) * plotHeight;\n      return { x: point.secondaryX, y, value: point.secondaryValue };\n    })\n    .filter((point): point is { x: number; y: number; value: number } => point !== null);\n\n  const primaryPath = buildLinePath(primaryPoints.map(({ x, y }) => ({ x, y })));\n  const secondaryPath = buildLinePath(secondaryPoints.map(({ x, y }) => ({ x, y })));\n  const primaryLabel = getMetricLabel(primaryMetric, metricUnit, weightUnit, heightUnit, isMachineWeight);\n  const secondaryLabel = isRepsPrimary\n    ? 'Total Reps'\n    : (useVolume ? `Volume (${secondaryUnit})` : 'Total Reps');\n  const formatPrimaryValue = (value: number) => {\n    if (isRepsPrimary) return formatNumber(value);\n    if (!isMachineWeight) return `${formatNumber(value)}${unitSuffix}`;\n    return value === 0 ? 'Machine' : `+${formatNumber(value)}${unitSuffix}`;\n  };\n  const formatSecondaryValue = (value: number) => (\n    isRepsPrimary || !useVolume\n      ? formatNumber(value)\n      : `${formatNumber(value)}${unitSuffix}`\n  );\n\n  const labelIndexes = points.length <= 1 ? [0] : [0, Math.floor((points.length - 1) / 2), points.length - 1];\n  const labelIndexesUnique = Array.from(new Set(labelIndexes)).filter((idx) => points[idx]);\n\n  const tooltipLabel = tooltip?.label || '';\n  const tooltipWidth = Math.min(width - 16, Math.max(56, tooltipLabel.length * 7 + 18));\n  const tooltipHeight = 24;\n  const tooltipX = tooltip\n    ? Math.min(Math.max(tooltip.x + 10, 8), width - tooltipWidth - 8)\n    : 0;\n  const tooltipY = tooltip\n    ? Math.max(8, tooltip.y - tooltipHeight - 10)\n    : 0;\n\n  const targetY = hasTargetValue\n    ? margin.top + plotHeight - (((displayTargetValue as number) - primaryMin) / primaryRange) * plotHeight\n    : null;\n  const targetLabel = hasTargetValue\n    ? (isMachineWeight\n      ? `Target +${formatNumber(displayTargetValue as number)}${unitSuffix}`\n      : `Target ${formatNumber(displayTargetValue as number)}${unitSuffix}`)\n    : '';\n\n  return (\n    <div className=\"w-full overflow-x-auto\">\n      <svg viewBox={`0 0 ${width} ${height}`} className=\"w-full min-w-[520px]\">\n        <rect x={0} y={0} width={width} height={height} rx={16} fill=\"#0f172a\" />\n\n        <g stroke=\"#1f2937\" strokeWidth={1}>\n          {[0, 0.5, 1].map((ratio) => {\n            const y = margin.top + plotHeight - ratio * plotHeight;\n            return <line key={ratio} x1={margin.left} y1={y} x2={width - margin.right} y2={y} />;\n          })}\n        </g>\n\n        {hasTargetValue && targetY !== null && (\n          <>\n            <line\n              x1={margin.left}\n              y1={targetY}\n              x2={width - margin.right}\n              y2={targetY}\n              stroke=\"#f59e0b\"\n              strokeWidth={2}\n              strokeDasharray=\"6 6\"\n            />\n            <text\n              x={width - margin.right - 6}\n              y={Math.max(margin.top + 12, targetY - 6)}\n              fill=\"#f59e0b\"\n              fontSize=\"12\"\n              textAnchor=\"end\"\n            >\n              {targetLabel}\n            </text>\n          </>\n        )}\n\n        <g fill=\"#94a3b8\" fontSize=\"12\">\n          <text x={margin.left - 12} y={margin.top + 10} textAnchor=\"end\">\n            {formatPrimaryValue(primaryMax)}\n          </text>\n          <text x={margin.left - 12} y={margin.top + plotHeight} textAnchor=\"end\">\n            {formatPrimaryValue(primaryMin)}\n          </text>\n          <text x={width - margin.right + 12} y={margin.top + 10} textAnchor=\"start\">\n            {formatNumber(secondaryMax)}\n          </text>\n          <text x={width - margin.right + 12} y={margin.top + plotHeight} textAnchor=\"start\">\n            {formatNumber(secondaryMin)}\n          </text>\n        </g>\n\n        {primaryPath && (\n          <path d={primaryPath} fill=\"none\" stroke=\"#38bdf8\" strokeWidth={3} />\n        )}\n        {secondaryPath && (\n          <path d={secondaryPath} fill=\"none\" stroke=\"#22c55e\" strokeWidth={3} />\n        )}\n\n        {tooltip && (\n          <g>\n            <rect\n              x={tooltipX}\n              y={tooltipY}\n              width={tooltipWidth}\n              height={tooltipHeight}\n              rx={6}\n              fill=\"#111827\"\n              stroke=\"#374151\"\n              strokeWidth={1}\n            />\n            <text\n              x={tooltipX + 9}\n              y={tooltipY + 16}\n              fill=\"#e2e8f0\"\n              fontSize=\"12\"\n            >\n              {tooltipLabel}\n            </text>\n          </g>\n        )}\n\n        <g fill=\"#e2e8f0\">\n          {primaryPoints.map((point, index) => (\n            <circle\n              key={`w-${index}`}\n              cx={point.x}\n              cy={point.y}\n              r={4}\n              fill=\"#38bdf8\"\n              onMouseEnter={() => setTooltip({ x: point.x, y: point.y, label: `${primaryLabel}: ${formatPrimaryValue(point.value)}` })}\n              onMouseMove={() => setTooltip({ x: point.x, y: point.y, label: `${primaryLabel}: ${formatPrimaryValue(point.value)}` })}\n              onMouseLeave={() => setTooltip(null)}\n            />\n          ))}\n          {secondaryPoints.map((point, index) => (\n            <circle\n              key={`v-${index}`}\n              cx={point.x}\n              cy={point.y}\n              r={4}\n              fill=\"#22c55e\"\n              onMouseEnter={() => setTooltip({ x: point.x, y: point.y, label: `${secondaryLabel}: ${formatSecondaryValue(point.value)}` })}\n              onMouseMove={() => setTooltip({ x: point.x, y: point.y, label: `${secondaryLabel}: ${formatSecondaryValue(point.value)}` })}\n              onMouseLeave={() => setTooltip(null)}\n            />\n          ))}\n        </g>\n\n        <g fill=\"#94a3b8\" fontSize=\"12\">\n          {labelIndexesUnique.map((index) => {\n            const x = margin.left + index * stepX;\n            const label = formatDayLabel(points[index].day);\n            return (\n              <text key={index} x={x} y={height - 12} textAnchor=\"middle\">\n                {label}\n              </text>\n            );\n          })}\n        </g>\n\n        <g fill=\"#94a3b8\" fontSize=\"12\">\n          <text x={margin.left} y={height - 4} textAnchor=\"start\">\n            {primaryLabel}\n          </text>\n          <text x={width - margin.right} y={height - 4} textAnchor=\"end\">\n            {secondaryLabel}\n          </text>\n        </g>\n      </svg>\n    </div>\n  );\n}\n\nfunction LoadingCard({ name }: { name: string }) {\n  return (\n    <div className=\"bg-zinc-800 rounded-xl p-4 border border-zinc-700 animate-pulse\">\n      <div className=\"h-5 w-40 bg-zinc-700 rounded mb-4\" />\n      <div className=\"h-40 bg-zinc-900 rounded-lg border border-zinc-700\" />\n      <div className=\"mt-4 flex justify-between\">\n        <div className=\"h-3 w-16 bg-zinc-700 rounded\" />\n        <div className=\"h-3 w-16 bg-zinc-700 rounded\" />\n      </div>\n      <div className=\"mt-2 text-xs text-zinc-500\">Loading {name}...</div>\n    </div>\n  );\n}\n\nexport default function ExerciseHistoryModal({\n  open,\n  onClose,\n  exerciseNames,\n  title = 'Exercise History',\n  targets,\n  weightUnit,\n  heightUnit,\n}: ExerciseHistoryModalProps) {\n  const resolvedWeightUnit = weightUnit ?? DEFAULT_WEIGHT_UNIT;\n  const resolvedHeightUnit = heightUnit ?? DEFAULT_HEIGHT_UNIT;\n  const [range, setRange] = useState<HistoryRange>('month');\n  const [weightMode, setWeightMode] = useState<WeightMode>(EXERCISE_HISTORY_AGGREGATION_MODES.max);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [history, setHistory] = useState<Record<string, ExerciseHistorySeries>>({});\n\n  const namesKey = useMemo(() => exerciseNames.join('|'), [exerciseNames]);\n\n  useEffect(() => {\n    if (!open) return;\n\n    const controller = new AbortController();\n    const fetchHistory = async () => {\n      setLoading(true);\n      setError(null);\n      try {\n        const params = new URLSearchParams({ range });\n        exerciseNames.forEach((name) => params.append('name', name));\n        const response = await fetch(`/api/exercise-history?${params.toString()}`, {\n          signal: controller.signal,\n        });\n        if (!response.ok) {\n          throw new Error('Failed to load exercise history');\n        }\n        const data = await response.json();\n        setHistory(data.history || {});\n      } catch (err: any) {\n        if (err?.name === 'AbortError') return;\n        setError(err?.message || 'Failed to load history');\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchHistory();\n    return () => controller.abort();\n  }, [open, range, namesKey, exerciseNames]);\n\n  useEffect(() => {\n    if (!open) return;\n    const handleKeyDown = (event: KeyboardEvent) => {\n      if (event.key === 'Escape') {\n        onClose();\n      }\n    };\n    window.addEventListener('keydown', handleKeyDown);\n    return () => window.removeEventListener('keydown', handleKeyDown);\n  }, [open, onClose]);\n\n  if (!open) return null;\n\n  return (\n    <div\n      className=\"fixed inset-0 z-50 bg-black/70 flex items-center justify-center p-4\"\n      onClick={onClose}\n    >\n      <div\n        className=\"bg-zinc-900 border border-zinc-700 rounded-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto\"\n        onClick={(event) => event.stopPropagation()}\n      >\n        <div className=\"p-6 border-b border-zinc-800 flex items-start justify-between gap-4\">\n          <div>\n            <h2 className=\"text-2xl font-bold text-white\">{title}</h2>\n            <div className=\"text-zinc-400 text-sm\">Primary metric trends</div>\n          </div>\n          <button\n            onClick={onClose}\n            className=\"text-zinc-300 hover:text-white bg-zinc-800 hover:bg-zinc-700 px-3 py-2 rounded-lg\"\n          >\n            Close\n          </button>\n        </div>\n\n        <div className=\"p-6 space-y-6\">\n          <div className=\"flex flex-wrap items-center justify-between gap-4\">\n            <div className=\"flex gap-2\">\n              {(['week', 'month', 'all'] as HistoryRange[]).map((value) => (\n                <button\n                  key={value}\n                  onClick={() => setRange(value)}\n                  className={`px-3 py-2 rounded-lg text-sm font-semibold border ${\n                    range === value\n                      ? 'bg-blue-600 border-blue-500 text-white'\n                      : 'bg-zinc-800 border-zinc-700 text-zinc-300 hover:text-white'\n                  }`}\n                >\n                  {RANGE_LABELS[value]}\n                </button>\n              ))}\n            </div>\n            <div className=\"flex gap-2\">\n              {(Object.values(EXERCISE_HISTORY_AGGREGATION_MODES) as WeightMode[]).map((value) => (\n                <button\n                  key={value}\n                  onClick={() => setWeightMode(value)}\n                  className={`px-3 py-2 rounded-lg text-sm font-semibold border ${\n                    weightMode === value\n                      ? 'bg-emerald-600 border-emerald-500 text-white'\n                      : 'bg-zinc-800 border-zinc-700 text-zinc-300 hover:text-white'\n                  }`}\n                >\n                  {value === EXERCISE_HISTORY_AGGREGATION_MODES.max ? 'Max' : 'Avg'}\n                </button>\n              ))}\n            </div>\n          </div>\n\n          {loading && (\n            <div className=\"text-zinc-400 text-sm\">Loading history...</div>\n          )}\n          {error && (\n            <div className=\"text-red-400 text-sm\">{error}</div>\n          )}\n\n          {!loading && !error && exerciseNames.length === 0 && (\n            <div className=\"text-zinc-500 text-sm\">No exercise selected.</div>\n          )}\n\n          {loading && exerciseNames.map((name) => (\n            <LoadingCard key={`loading-${name}`} name={name} />\n          ))}\n\n          {!loading && !error && exerciseNames.map((name) => {\n            const series = history[name];\n            const points = series?.points || [];\n            const explicitMode = series?.display_mode;\n            const mode = explicitMode === EXERCISE_HISTORY_DISPLAY_MODES.reps\n              ? EXERCISE_HISTORY_DISPLAY_MODES.reps\n              : EXERCISE_HISTORY_DISPLAY_MODES.weight;\n            const primaryMetric = resolvePrimaryMetric(series?.primary_metric, mode === EXERCISE_HISTORY_DISPLAY_MODES.reps);\n            const metricUnit = typeof series?.metric_unit === 'string' ? series.metric_unit : null;\n            const isMachine = !!series?.is_machine && isWeightMetric(primaryMetric);\n            const primaryLegendLabel = getMetricLabel(primaryMetric, metricUnit, resolvedWeightUnit, resolvedHeightUnit, isMachine);\n            const targetEntry = targets?.[name];\n            const rawTargetValue = isRepsOnlyMetric(primaryMetric) || mode === EXERCISE_HISTORY_DISPLAY_MODES.reps\n              ? targetEntry?.reps\n              : targetEntry?.weight;\n            const targetValue = Number.isFinite(rawTargetValue as number) && (rawTargetValue as number) > 0\n              ? (rawTargetValue as number)\n              : null;\n            const resolvedUnit = resolveMetricUnit(primaryMetric, metricUnit, resolvedWeightUnit, resolvedHeightUnit);\n            const secondaryLegendLabel = (isRepsOnlyMetric(primaryMetric) || mode === EXERCISE_HISTORY_DISPLAY_MODES.reps)\n              ? 'Total Reps'\n              : (isWeightMetric(primaryMetric)\n                ? `Volume (${resolvedUnit ?? resolvedWeightUnit})`\n                : 'Total Reps');\n            return (\n              <div key={name} className=\"bg-zinc-800 rounded-xl p-4 border border-zinc-700\">\n                <div className=\"flex flex-wrap items-center justify-between mb-4 gap-2\">\n                  <div className=\"text-white text-lg font-semibold\">{name}</div>\n                  <div className=\"flex items-center gap-3 text-xs text-zinc-400\">\n                    <span className=\"flex items-center gap-2\">\n                      <span className=\"h-2 w-2 rounded-full bg-sky-400\" />\n                      {primaryLegendLabel}\n                    </span>\n                    <span className=\"flex items-center gap-2\">\n                      <span className=\"h-2 w-2 rounded-full bg-green-400\" />\n                      {secondaryLegendLabel}\n                    </span>\n                    {targetValue !== null && (\n                      <span className=\"flex items-center gap-2\">\n                        <span className=\"h-[2px] w-4 border-t border-dashed border-amber-400\" />\n                        Target\n                      </span>\n                    )}\n                  </div>\n                </div>\n                {points.length === 0 ? (\n                  <div className=\"bg-zinc-900 border border-zinc-700 rounded-lg p-4 text-sm text-zinc-400\">\n                    No history yet. Finish a workout with this exercise to populate the graph.\n                  </div>\n                ) : (\n                  <LineChart\n                    points={points}\n                    weightMode={weightMode}\n                    mode={mode}\n                    primaryMetric={primaryMetric}\n                    metricUnit={metricUnit}\n                    targetValue={targetValue}\n                    isMachine={isMachine}\n                    weightUnit={resolvedWeightUnit}\n                    heightUnit={resolvedHeightUnit}\n                  />\n                )}\n              </div>\n            );\n          })}\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2986, "column": 0}, "map": {"version":3,"sources":["file:///Users/devamshroff/Documents/SWE%20Career/projects/gymmer/app/components/AutosaveBadge.tsx"],"sourcesContent":["'use client';\n\nimport { useEffect, useMemo, useState } from 'react';\n\ntype AutosaveDetail = {\n  status: 'saving' | 'success' | 'error';\n  eventType?: string;\n  at?: number;\n};\n\ntype AutosaveState = Omit<AutosaveDetail, 'status'> & {\n  status: AutosaveDetail['status'] | 'idle';\n};\n\nexport default function AutosaveBadge({ className = '' }: { className?: string }) {\n  const [state, setState] = useState<AutosaveState>({ status: 'idle' });\n\n  useEffect(() => {\n    const handler = (event: Event) => {\n      const detail = (event as CustomEvent<AutosaveDetail>).detail;\n      if (!detail) return;\n      setState({ ...detail });\n    };\n\n    window.addEventListener('workout-autosave', handler);\n    return () => window.removeEventListener('workout-autosave', handler);\n  }, []);\n\n  const timeLabel = useMemo(() => {\n    if (!state.at) return '';\n    return new Date(state.at).toLocaleTimeString('en-US', {\n      hour: 'numeric',\n      minute: '2-digit',\n    });\n  }, [state.at]);\n\n  const { label, badgeClass } = useMemo(() => {\n    switch (state.status) {\n      case 'saving':\n        return { label: 'Autosave: saving', badgeClass: 'text-amber-300 border-amber-500/40' };\n      case 'success':\n        return { label: `Autosave: saved ${timeLabel}`, badgeClass: 'text-emerald-300 border-emerald-500/40' };\n      case 'error':\n        return { label: `Autosave: failed ${timeLabel}`, badgeClass: 'text-red-300 border-red-500/40' };\n      default:\n        return { label: 'Autosave: idle', badgeClass: 'text-zinc-400 border-zinc-600/40' };\n    }\n  }, [state.status, timeLabel]);\n\n  return (\n    <div\n      className={`rounded-full border px-3 py-1 text-xs font-semibold ${badgeClass} ${className}`}\n      aria-live=\"polite\"\n    >\n      {label}\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;;;AAFA;;AAce,SAAS,cAAc,EAAE,YAAY,EAAE,EAA0B;;IAC9E,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAgB;QAAE,QAAQ;IAAO;IAEnE,IAAA,0KAAS;mCAAC;YACR,MAAM;mDAAU,CAAC;oBACf,MAAM,SAAS,AAAC,MAAsC,MAAM;oBAC5D,IAAI,CAAC,QAAQ;oBACb,SAAS;wBAAE,GAAG,MAAM;oBAAC;gBACvB;;YAEA,OAAO,gBAAgB,CAAC,oBAAoB;YAC5C;2CAAO,IAAM,OAAO,mBAAmB,CAAC,oBAAoB;;QAC9D;kCAAG,EAAE;IAEL,MAAM,YAAY,IAAA,wKAAO;4CAAC;YACxB,IAAI,CAAC,MAAM,EAAE,EAAE,OAAO;YACtB,OAAO,IAAI,KAAK,MAAM,EAAE,EAAE,kBAAkB,CAAC,SAAS;gBACpD,MAAM;gBACN,QAAQ;YACV;QACF;2CAAG;QAAC,MAAM,EAAE;KAAC;IAEb,MAAM,EAAE,KAAK,EAAE,UAAU,EAAE,GAAG,IAAA,wKAAO;iCAAC;YACpC,OAAQ,MAAM,MAAM;gBAClB,KAAK;oBACH,OAAO;wBAAE,OAAO;wBAAqB,YAAY;oBAAqC;gBACxF,KAAK;oBACH,OAAO;wBAAE,OAAO,CAAC,gBAAgB,EAAE,WAAW;wBAAE,YAAY;oBAAyC;gBACvG,KAAK;oBACH,OAAO;wBAAE,OAAO,CAAC,iBAAiB,EAAE,WAAW;wBAAE,YAAY;oBAAiC;gBAChG;oBACE,OAAO;wBAAE,OAAO;wBAAkB,YAAY;oBAAmC;YACrF;QACF;gCAAG;QAAC,MAAM,MAAM;QAAE;KAAU;IAE5B,qBACE,6LAAC;QACC,WAAW,CAAC,oDAAoD,EAAE,WAAW,CAAC,EAAE,WAAW;QAC3F,aAAU;kBAET;;;;;;AAGP;GA3CwB;KAAA"}},
    {"offset": {"line": 3079, "column": 0}, "map": {"version":3,"sources":["file:///Users/devamshroff/Documents/SWE%20Career/projects/gymmer/lib/workout-bootstrap.ts"],"sourcesContent":["import type { WorkoutPlan, WorkoutExerciseLog } from '@/lib/types';\nimport type { HeightUnit, WeightUnit } from '@/lib/units';\n\nexport type BootstrapUserSettings = {\n  restTimeSeconds: number;\n  supersetRestSeconds: number;\n  weightUnit: WeightUnit;\n  heightUnit: HeightUnit;\n};\n\nexport type LastSetSummary =\n  | (WorkoutExerciseLog & { completed_at?: string; matched_role?: string })\n  | null;\n\nexport type RoutineMeta = {\n  id?: number | null;\n  name: string;\n  updatedAt?: string | null;\n  checksum?: string | null;\n};\n\nexport type WorkoutBootstrapPayload = {\n  workout: WorkoutPlan;\n  settings: BootstrapUserSettings;\n  lastSetSummaries: Record<string, LastSetSummary>;\n  lastWorkoutReport: string | null;\n  routineMeta?: RoutineMeta;\n};\n\ntype WorkoutBootstrapCacheEntry = WorkoutBootstrapPayload & {\n  cachedAt: string;\n  editVersionId?: string | null;\n  editVersionName?: string | null;\n};\n\nconst BOOTSTRAP_PREFIX = 'workout_bootstrap';\nconst EDIT_PREFIX = 'routine_edit_version';\n\nfunction buildCacheKey(workoutName: string, routineId?: string | null): string {\n  const safeName = encodeURIComponent(workoutName);\n  const safeRoutine = routineId ? encodeURIComponent(routineId) : 'default';\n  return `${BOOTSTRAP_PREFIX}:${safeName}:${safeRoutine}`;\n}\n\nfunction buildEditKey(scope: string): string {\n  return `${EDIT_PREFIX}:${scope}`;\n}\n\nfunction getEditVersionById(routineId?: string | number | null): string | null {\n  if (typeof window === 'undefined' || routineId === null || routineId === undefined) return null;\n  const key = buildEditKey(`id:${routineId}`);\n  return localStorage.getItem(key) ?? '0';\n}\n\nfunction getEditVersionByName(workoutName?: string | null): string | null {\n  if (typeof window === 'undefined' || !workoutName) return null;\n  const key = buildEditKey(`name:${encodeURIComponent(workoutName)}`);\n  return localStorage.getItem(key) ?? '0';\n}\n\nfunction isCacheEntryValid(\n  entry: WorkoutBootstrapCacheEntry,\n  workoutName: string,\n  routineId?: string | null\n): boolean {\n  const currentIdVersion = getEditVersionById(routineId);\n  if (entry.editVersionId && currentIdVersion && entry.editVersionId !== currentIdVersion) {\n    return false;\n  }\n  const currentNameVersion = getEditVersionByName(workoutName);\n  if (entry.editVersionName && currentNameVersion && entry.editVersionName !== currentNameVersion) {\n    return false;\n  }\n  return true;\n}\n\nexport function loadWorkoutBootstrapCache(params: {\n  workoutName: string;\n  routineId?: string | null;\n}): WorkoutBootstrapCacheEntry | null {\n  if (typeof window === 'undefined') return null;\n  const { workoutName, routineId } = params;\n  const keys = [buildCacheKey(workoutName, routineId)];\n  if (routineId) {\n    keys.push(buildCacheKey(workoutName, null));\n  }\n\n  for (const key of keys) {\n    const stored = sessionStorage.getItem(key);\n    if (!stored) continue;\n    try {\n      const entry = JSON.parse(stored) as WorkoutBootstrapCacheEntry;\n      if (!isCacheEntryValid(entry, workoutName, routineId)) {\n        sessionStorage.removeItem(key);\n        continue;\n      }\n      return entry;\n    } catch (error) {\n      console.error('Failed to parse workout bootstrap cache:', error);\n      sessionStorage.removeItem(key);\n    }\n  }\n\n  return null;\n}\n\nexport function saveWorkoutBootstrapCache(params: {\n  workoutName: string;\n  routineId?: string | null;\n  payload: WorkoutBootstrapPayload;\n}): void {\n  if (typeof window === 'undefined') return;\n  const { workoutName, routineId, payload } = params;\n  const entry: WorkoutBootstrapCacheEntry = {\n    ...payload,\n    cachedAt: new Date().toISOString(),\n    editVersionId: getEditVersionById(routineId),\n    editVersionName: getEditVersionByName(workoutName),\n  };\n  const serialized = JSON.stringify(entry);\n  sessionStorage.setItem(buildCacheKey(workoutName, routineId), serialized);\n  if (routineId) {\n    sessionStorage.setItem(buildCacheKey(workoutName, null), serialized);\n  }\n}\n\nexport function clearWorkoutBootstrapCache(params: {\n  workoutName: string;\n  routineId?: string | null;\n}): void {\n  if (typeof window === 'undefined') return;\n  const { workoutName, routineId } = params;\n  sessionStorage.removeItem(buildCacheKey(workoutName, routineId));\n  if (routineId) {\n    sessionStorage.removeItem(buildCacheKey(workoutName, null));\n  }\n}\n\nexport function bumpRoutineEditVersion(params: {\n  routineId?: string | number | null;\n  routineName?: string | null;\n}): void {\n  if (typeof window === 'undefined') return;\n  const stamp = String(Date.now());\n  if (params.routineId !== null && params.routineId !== undefined) {\n    localStorage.setItem(buildEditKey(`id:${params.routineId}`), stamp);\n  }\n  if (params.routineName) {\n    localStorage.setItem(buildEditKey(`name:${encodeURIComponent(params.routineName)}`), stamp);\n  }\n}\n\nexport function invalidateWorkoutBootstrapCache(params: {\n  routineId?: string | number | null;\n  routineName?: string | null;\n}): void {\n  bumpRoutineEditVersion(params);\n  if (!params.routineName) return;\n  clearWorkoutBootstrapCache({\n    workoutName: params.routineName,\n    routineId: params.routineId ? String(params.routineId) : null,\n  });\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3200, "column": 0}, "map": {"version":3,"sources":["file:///Users/devamshroff/Documents/SWE%20Career/projects/gymmer/app/workout/%5Bname%5D/active/page.tsx"],"sourcesContent":["'use client';\n\nimport { useEffect, useMemo, useRef, useState, Suspense } from 'react';\nimport { useParams, useRouter, useSearchParams } from 'next/navigation';\nimport Link from 'next/link';\nimport { WorkoutPlan, Exercise, SingleExercise, B2BExercise } from '@/lib/types';\nimport { addExerciseToSession } from '@/lib/workout-session';\nimport { autosaveWorkout } from '@/lib/workout-autosave';\nimport ExerciseSelector from '@/app/components/ExerciseSelector';\nimport SupersetSelector from '@/app/components/SupersetSelector';\nimport { getFormTips, getVideoUrl } from '@/lib/workout-media';\nimport { acknowledgeChangeWarning, hasChangeWarningAck, loadSessionWorkout, saveSessionWorkout } from '@/lib/session-workout';\nimport WorkoutNavHeader from '@/app/components/WorkoutNavHeader';\nimport ExerciseHistoryModal from '@/app/components/ExerciseHistoryModal';\nimport AutosaveBadge from '@/app/components/AutosaveBadge';\nimport { EXERCISE_TYPES, type ExercisePrimaryMetric } from '@/lib/constants';\nimport {\n  DEFAULT_HEIGHT_UNIT,\n  DEFAULT_WEIGHT_UNIT,\n  normalizeHeightUnit,\n  normalizeWeightUnit,\n} from '@/lib/units';\nimport type { HeightUnit, WeightUnit } from '@/lib/units';\nimport {\n  formatMetricDisplay,\n  formatMetricInputValue,\n  getMetricLabel,\n  isRepsOnlyMetric,\n  isWeightMetric,\n  parseMetricInput,\n  resolvePrimaryMetric,\n} from '@/lib/metric-utils';\nimport {\n  loadWorkoutBootstrapCache,\n  saveWorkoutBootstrapCache,\n  type LastSetSummary,\n  type WorkoutBootstrapPayload,\n} from '@/lib/workout-bootstrap';\n\ninterface SetData {\n  weight: number;\n  reps: number;\n}\n\ntype ExerciseOption = {\n  id: number;\n  name: string;\n  video_url: string | null;\n  tips: string | null;\n  equipment?: string | null;\n  is_bodyweight?: number | null;\n  is_machine?: number | null;\n};\n\ntype LastSetSummaries = Record<string, LastSetSummary>;\n\ntype SetIndex = 1 | 2 | 3 | 4;\ntype SetField = 'weight' | 'reps';\ntype SetKey = `set${SetIndex}_${SetField}`;\n\nfunction getLogSetValue(log: LastSetSummary, setNum: SetIndex, field: SetField): number | null {\n  if (!log) return null;\n  const key = `set${setNum}_${field}` as SetKey;\n  return log[key] as number | null;\n}\n\nfunction normalizeDateString(value: string): string {\n  if (/^\\d{4}-\\d{2}-\\d{2} \\d{2}:\\d{2}:\\d{2}/.test(value)) {\n    return `${value.replace(' ', 'T')}Z`;\n  }\n  if (/^\\d{4}-\\d{2}-\\d{2}$/.test(value)) {\n    return `${value}T00:00:00Z`;\n  }\n  return value;\n}\n\nfunction formatLocalDate(value?: string | null): string {\n  if (!value) return 'Unknown date';\n  const date = new Date(normalizeDateString(value));\n  if (Number.isNaN(date.getTime())) return 'Unknown date';\n  return date.toLocaleDateString('en-US', {\n    month: 'short',\n    day: 'numeric',\n    year: 'numeric',\n  });\n}\n\nfunction resolveHasWarmup(exercise: SingleExercise): boolean {\n  const primaryMetric = resolvePrimaryMetric(exercise.primaryMetric, exercise.isBodyweight);\n  if (!isWeightMetric(primaryMetric)) {\n    return false;\n  }\n  if (typeof exercise.hasWarmup === 'boolean') {\n    return exercise.hasWarmup;\n  }\n  if (exercise.isBodyweight) {\n    return false;\n  }\n  return true;\n}\n\nfunction ActiveWorkoutContent() {\n  const params = useParams();\n  const router = useRouter();\n  const searchParams = useSearchParams();\n  const [workout, setWorkout] = useState<WorkoutPlan | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [currentExerciseIndex, setCurrentExerciseIndex] = useState(0);\n  const [initialIndexSet, setInitialIndexSet] = useState(false);\n  const [currentSetIndex, setCurrentSetIndex] = useState(0);\n  const [isResting, setIsResting] = useState(false);\n  const [restTimeRemaining, setRestTimeRemaining] = useState(0);\n  const [restTimeSeconds, setRestTimeSeconds] = useState(60);\n  const [supersetRestSeconds, setSupersetRestSeconds] = useState(15);\n  const [weightUnit, setWeightUnit] = useState<WeightUnit>(DEFAULT_WEIGHT_UNIT);\n  const [heightUnit, setHeightUnit] = useState<HeightUnit>(DEFAULT_HEIGHT_UNIT);\n\n  // Single exercise state\n  const [setData, setSetData] = useState<SetData>({ weight: 0, reps: 0 });\n  const [completedSets, setCompletedSets] = useState<SetData[]>([]);\n  const [warmupCompleted, setWarmupCompleted] = useState(false);\n  const [warmupDecision, setWarmupDecision] = useState<'pending' | 'include' | 'skip'>('pending');\n  const [machineOnly, setMachineOnly] = useState(false);\n  const [machineOnlyHoldWeight, setMachineOnlyHoldWeight] = useState(0);\n\n  // B2B/Superset state\n  const [currentExerciseInPair, setCurrentExerciseInPair] = useState(0); // 0 or 1\n  const [setData1, setSetData1] = useState<SetData>({ weight: 0, reps: 0 });\n  const [setData2, setSetData2] = useState<SetData>({ weight: 0, reps: 0 });\n  const [completedPairs, setCompletedPairs] = useState<Array<{ ex1: SetData; ex2: SetData }>>([]);\n  const [machineOnly1, setMachineOnly1] = useState(false);\n  const [machineOnly2, setMachineOnly2] = useState(false);\n  const [machineOnlyHoldWeight1, setMachineOnlyHoldWeight1] = useState(0);\n  const [machineOnlyHoldWeight2, setMachineOnlyHoldWeight2] = useState(0);\n\n  const [isTransitioning, setIsTransitioning] = useState(false);\n  const [transitionTimeRemaining, setTransitionTimeRemaining] = useState(60);\n  const [showExitConfirm, setShowExitConfirm] = useState(false);\n  const [showExerciseTypePicker, setShowExerciseTypePicker] = useState(false);\n  const [showExerciseSelector, setShowExerciseSelector] = useState(false);\n  const [showSupersetSelector, setShowSupersetSelector] = useState(false);\n  const [exerciseActionMode, setExerciseActionMode] = useState<'add' | 'replace' | null>(null);\n  const [showChangeWarning, setShowChangeWarning] = useState(false);\n  const pendingChangeRef = useRef<(() => void) | null>(null);\n\n  const getMetricInfo = (exercise: {\n    primaryMetric?: ExercisePrimaryMetric;\n    metricUnit?: string | null;\n    isBodyweight?: boolean;\n  }) => ({\n    primaryMetric: resolvePrimaryMetric(exercise.primaryMetric, exercise.isBodyweight),\n    metricUnit: exercise.metricUnit ?? null,\n  });\n\n  const isExerciseWeightMetric = (exercise: {\n    primaryMetric?: ExercisePrimaryMetric;\n    isBodyweight?: boolean;\n  }) => isWeightMetric(resolvePrimaryMetric(exercise.primaryMetric, exercise.isBodyweight));\n\n  const formatMetric = (\n    value: number,\n    metricInfo: { primaryMetric: ExercisePrimaryMetric; metricUnit: string | null },\n    isMachine?: boolean\n  ) => formatMetricDisplay(value, metricInfo.primaryMetric, metricInfo.metricUnit, weightUnit, heightUnit, isMachine);\n\n  const getMetricLabelText = (\n    metricInfo: { primaryMetric: ExercisePrimaryMetric; metricUnit: string | null },\n    isMachine?: boolean\n  ) => getMetricLabel(metricInfo.primaryMetric, metricInfo.metricUnit, weightUnit, heightUnit, isMachine);\n\n  const parseMetricValueInput = (\n    value: string,\n    metricInfo: { primaryMetric: ExercisePrimaryMetric }\n  ): number | null => parseMetricInput(value, metricInfo.primaryMetric, weightUnit, heightUnit);\n\n  const formatMetricValueInput = (\n    value: number,\n    metricInfo: { primaryMetric: ExercisePrimaryMetric },\n    allowBlank = false\n  ) => formatMetricInputValue(value, metricInfo.primaryMetric, weightUnit, heightUnit, allowBlank);\n\n  const historyTargets = useMemo(() => {\n    if (!workout) return {};\n    const next: Record<string, { weight?: number | null; reps?: number | null }> = {};\n    for (const exercise of workout.exercises) {\n      if (exercise.type === EXERCISE_TYPES.single) {\n        next[exercise.name] = {\n          weight: exercise.targetWeight,\n          reps: exercise.targetReps,\n        };\n      } else {\n        const [ex1, ex2] = exercise.exercises;\n        next[ex1.name] = {\n          weight: ex1.targetWeight,\n          reps: ex1.targetReps,\n        };\n        next[ex2.name] = {\n          weight: ex2.targetWeight,\n          reps: ex2.targetReps,\n        };\n      }\n    }\n    return next;\n  }, [workout]);\n  const [showHistory, setShowHistory] = useState(false);\n  const [historyExerciseNames, setHistoryExerciseNames] = useState<string[]>([]);\n\n  // Last exercise log from database\n  const [lastSetSummaries, setLastSetSummaries] = useState<LastSetSummaries>({});\n  const [lastExerciseLog, setLastExerciseLog] = useState<LastSetSummary>(null);\n  const [lastPartnerExerciseLog, setLastPartnerExerciseLog] = useState<LastSetSummary>(null);\n\n  // Review mode: cache completed exercises and track viewing\n  type CompletedExerciseCache = {\n    exerciseIndex: number;\n    exerciseName: string;\n    type: typeof EXERCISE_TYPES.single | typeof EXERCISE_TYPES.b2b;\n    completedSets?: SetData[];\n    completedPairs?: Array<{ ex1: SetData; ex2: SetData }>;\n    warmupCompleted?: boolean;\n  };\n  const [completedExercisesCache, setCompletedExercisesCache] = useState<CompletedExerciseCache[]>([]);\n  const [viewingExerciseIndex, setViewingExerciseIndex] = useState(0); // Which exercise we're viewing (can be past/current)\n\n  const initSingleExerciseState = (exercise: SingleExercise) => {\n    const hasWarmup = resolveHasWarmup(exercise);\n    const defaultMachineOnly = !!exercise.isMachine\n      && isExerciseWeightMetric(exercise)\n      && exercise.targetWeight <= 0;\n    setWarmupCompleted(false);\n    setMachineOnly(defaultMachineOnly);\n    setMachineOnlyHoldWeight(exercise.targetWeight);\n    if (!hasWarmup) {\n      setWarmupDecision('skip');\n      setCurrentSetIndex(1);\n      setSetData({\n        weight: defaultMachineOnly ? 0 : exercise.targetWeight,\n        reps: exercise.targetReps,\n      });\n      return;\n    }\n    setWarmupDecision('pending');\n    setCurrentSetIndex(1);\n    setSetData({\n      weight: defaultMachineOnly ? 0 : exercise.targetWeight,\n      reps: exercise.targetReps,\n    });\n  };\n\n  // Get routineId from URL params (for public/favorited routines)\n  const routineIdParam = searchParams.get('routineId');\n  const routineQueryParams = new URLSearchParams();\n  if (routineIdParam) routineQueryParams.set('routineId', routineIdParam);\n  const routineQuery = routineQueryParams.toString() ? `?${routineQueryParams.toString()}` : '';\n\n  useEffect(() => {\n    async function fetchWorkout() {\n      try {\n        const decodedName = decodeURIComponent(params.name as string);\n        const cached = loadWorkoutBootstrapCache({\n          workoutName: decodedName,\n          routineId: routineIdParam,\n        });\n\n        let baseWorkout: WorkoutPlan | null = null;\n        let bootstrapSettings: WorkoutBootstrapPayload['settings'] | null = null;\n        let bootstrapSummaries: LastSetSummaries = {};\n\n        if (cached) {\n          baseWorkout = cached.workout;\n          bootstrapSettings = cached.settings;\n          bootstrapSummaries = cached.lastSetSummaries || {};\n        } else {\n          let apiUrl = `/api/workout/${params.name}?bootstrap=1`;\n          if (routineIdParam) {\n            apiUrl += `&routineId=${routineIdParam}`;\n          }\n          const response = await fetch(apiUrl);\n          if (!response.ok) {\n            throw new Error('Workout not found');\n          }\n          const data = await response.json();\n          baseWorkout = data.workout as WorkoutPlan;\n          bootstrapSettings = data.settings;\n          bootstrapSummaries = data.lastSetSummaries || {};\n          const payload: WorkoutBootstrapPayload = {\n            workout: baseWorkout,\n            settings: data.settings,\n            lastSetSummaries: bootstrapSummaries,\n            lastWorkoutReport: data.lastWorkoutReport || null,\n            routineMeta: data.routineMeta,\n          };\n          saveWorkoutBootstrapCache({\n            workoutName: decodedName,\n            routineId: routineIdParam ?? (payload.routineMeta?.id ? String(payload.routineMeta.id) : null),\n            payload,\n          });\n        }\n\n        if (!baseWorkout) {\n          throw new Error('Workout not found');\n        }\n\n        const sessionWorkout = loadSessionWorkout(baseWorkout.name, routineIdParam);\n        const resolvedWorkout = sessionWorkout || baseWorkout;\n        setWorkout(resolvedWorkout);\n        setLastSetSummaries(bootstrapSummaries);\n\n        const missingNames: string[] = [];\n        for (const exercise of resolvedWorkout.exercises) {\n          if (exercise.type === EXERCISE_TYPES.single) {\n            if (!(exercise.name in bootstrapSummaries)) missingNames.push(exercise.name);\n          } else {\n            const [ex1, ex2] = exercise.exercises;\n            if (!(ex1.name in bootstrapSummaries)) missingNames.push(ex1.name);\n            if (!(ex2.name in bootstrapSummaries)) missingNames.push(ex2.name);\n          }\n        }\n        if (missingNames.length > 0) {\n          void refreshLastSetSummaries(missingNames);\n        }\n\n        if (bootstrapSettings) {\n          const restSeconds = Number(bootstrapSettings?.restTimeSeconds);\n          const supersetSeconds = Number(bootstrapSettings?.supersetRestSeconds);\n          setRestTimeSeconds(Number.isFinite(restSeconds) ? restSeconds : 60);\n          setSupersetRestSeconds(Number.isFinite(supersetSeconds) ? supersetSeconds : 15);\n          setWeightUnit(normalizeWeightUnit(bootstrapSettings?.weightUnit));\n          setHeightUnit(normalizeHeightUnit(bootstrapSettings?.heightUnit));\n        }\n\n        // Check for index in URL (for navigation from other sections)\n        const indexParam = searchParams.get('index');\n        let startIndex = 0;\n        if (indexParam && !initialIndexSet) {\n          const idx = parseInt(indexParam, 10);\n          if (!isNaN(idx) && idx >= 0 && idx < resolvedWorkout.exercises.length) {\n            startIndex = idx;\n            setCurrentExerciseIndex(idx);\n            setViewingExerciseIndex(idx);\n          }\n          setInitialIndexSet(true);\n        }\n\n        // Initialize exercise at startIndex\n        const exercise = resolvedWorkout.exercises[startIndex];\n        if (exercise.type === EXERCISE_TYPES.single) {\n          initSingleExerciseState(exercise);\n        } else {\n          // B2B exercise - no warmups, start at set 1\n          const b2bEx = exercise as B2BExercise;\n          const defaultMachineOnly1 = !!b2bEx.exercises[0].isMachine\n            && isExerciseWeightMetric(b2bEx.exercises[0])\n            && b2bEx.exercises[0].targetWeight <= 0;\n          const defaultMachineOnly2 = !!b2bEx.exercises[1].isMachine\n            && isExerciseWeightMetric(b2bEx.exercises[1])\n            && b2bEx.exercises[1].targetWeight <= 0;\n          setSetData1({\n            weight: defaultMachineOnly1 ? 0 : b2bEx.exercises[0].targetWeight,\n            reps: b2bEx.exercises[0].targetReps,\n          });\n          setSetData2({\n            weight: defaultMachineOnly2 ? 0 : b2bEx.exercises[1].targetWeight,\n            reps: b2bEx.exercises[1].targetReps,\n          });\n          setMachineOnly1(defaultMachineOnly1);\n          setMachineOnly2(defaultMachineOnly2);\n          setMachineOnlyHoldWeight1(b2bEx.exercises[0].targetWeight);\n          setMachineOnlyHoldWeight2(b2bEx.exercises[1].targetWeight);\n          setCurrentSetIndex(1);\n          setCurrentExerciseInPair(0); // Start with first exercise\n          setWarmupDecision('skip');\n          setWarmupCompleted(false);\n        }\n      } catch (error) {\n        console.error('Error fetching workout:', error);\n      } finally {\n        setLoading(false);\n      }\n    }\n\n    fetchWorkout();\n  }, [params.name, searchParams, routineIdParam, initialIndexSet]);\n\n  // Rest timer countdown\n  useEffect(() => {\n    if (!isResting) return;\n    if (restTimeRemaining > 0) {\n      const timer = setTimeout(() => {\n        setRestTimeRemaining(restTimeRemaining - 1);\n      }, 1000);\n      return () => clearTimeout(timer);\n    }\n\n    // Rest complete: vibrate and auto-advance to next set\n    if ('vibrate' in navigator) {\n      navigator.vibrate(500);\n    }\n    setIsResting(false);\n  }, [isResting, restTimeRemaining]);\n\n  // Transition timer countdown\n  useEffect(() => {\n    if (isTransitioning && transitionTimeRemaining > 0) {\n      const timer = setTimeout(() => {\n        setTransitionTimeRemaining(transitionTimeRemaining - 1);\n      }, 1000);\n      return () => clearTimeout(timer);\n    } else if (isTransitioning && transitionTimeRemaining === 0 && workout) {\n      // Transition complete - move to next exercise\n      const nextExerciseIndex = currentExerciseIndex + 1;\n      setIsTransitioning(false);\n      setCurrentExerciseIndex(nextExerciseIndex);\n      setViewingExerciseIndex(nextExerciseIndex); // Keep viewing in sync with active exercise\n      setCompletedSets([]);\n\n      // Initialize next exercise\n      const nextExercise = workout.exercises[nextExerciseIndex];\n      if (nextExercise.type === EXERCISE_TYPES.single) {\n        initSingleExerciseState(nextExercise);\n      } else {\n        // B2B exercise - no warmups, start at set 1\n        const b2bEx = nextExercise as B2BExercise;\n        const defaultMachineOnly1 = !!b2bEx.exercises[0].isMachine\n          && isExerciseWeightMetric(b2bEx.exercises[0])\n          && b2bEx.exercises[0].targetWeight <= 0;\n        const defaultMachineOnly2 = !!b2bEx.exercises[1].isMachine\n          && isExerciseWeightMetric(b2bEx.exercises[1])\n          && b2bEx.exercises[1].targetWeight <= 0;\n        setSetData1({\n          weight: defaultMachineOnly1 ? 0 : b2bEx.exercises[0].targetWeight,\n          reps: b2bEx.exercises[0].targetReps,\n        });\n        setSetData2({\n          weight: defaultMachineOnly2 ? 0 : b2bEx.exercises[1].targetWeight,\n          reps: b2bEx.exercises[1].targetReps,\n        });\n        setMachineOnly1(defaultMachineOnly1);\n        setMachineOnly2(defaultMachineOnly2);\n        setMachineOnlyHoldWeight1(b2bEx.exercises[0].targetWeight);\n        setMachineOnlyHoldWeight2(b2bEx.exercises[1].targetWeight);\n        setCurrentSetIndex(1);\n        setCurrentExerciseInPair(0);\n        setCompletedPairs([]);\n        setWarmupDecision('skip');\n        setWarmupCompleted(false);\n      }\n    }\n  }, [isTransitioning, transitionTimeRemaining, workout, currentExerciseIndex]);\n\n  // Resolve last-set summaries from bootstrap cache\n  useEffect(() => {\n    if (!workout) return;\n    const currentExercise = workout.exercises[currentExerciseIndex];\n    if (currentExercise.type === EXERCISE_TYPES.single) {\n      setLastExerciseLog(lastSetSummaries[currentExercise.name] ?? null);\n      setLastPartnerExerciseLog(null);\n      return;\n    }\n    const b2bExercise = currentExercise as B2BExercise;\n    setLastExerciseLog(lastSetSummaries[b2bExercise.exercises[0].name] ?? null);\n    setLastPartnerExerciseLog(lastSetSummaries[b2bExercise.exercises[1].name] ?? null);\n  }, [workout, currentExerciseIndex, lastSetSummaries]);\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-zinc-900 flex items-center justify-center p-4\">\n        <div className=\"text-white text-2xl\">Loading...</div>\n      </div>\n    );\n  }\n\n  if (!workout) {\n    return (\n      <div className=\"min-h-screen bg-zinc-900 flex items-center justify-center p-4\">\n        <div className=\"text-center\">\n          <div className=\"text-white text-2xl mb-4\">Workout not found</div>\n          <Link href=\"/routines\" className=\"text-blue-400 hover:text-blue-300\">\n            Back to routines\n          </Link>\n        </div>\n      </div>\n    );\n  }\n\n  const currentExercise = workout.exercises[currentExerciseIndex];\n\n  // Review mode: determine if viewing a previous exercise\n  const isReviewMode = viewingExerciseIndex < currentExerciseIndex;\n  const viewingExercise = workout.exercises[viewingExerciseIndex];\n  const viewingCachedData = completedExercisesCache.find(cache => cache.exerciseIndex === viewingExerciseIndex);\n  const lastExerciseDate = lastExerciseLog?.completed_at || lastExerciseLog?.created_at;\n  const lastPartnerExerciseDate = lastPartnerExerciseLog?.completed_at || lastPartnerExerciseLog?.created_at;\n\n  // Calculate total workout items for progress\n  const totalItems =\n    workout.preWorkoutStretches.length +\n    workout.exercises.length +\n    (workout.cardio ? 1 : 0) +\n    workout.postWorkoutStretches.length;\n  const currentProgress = workout.preWorkoutStretches.length + currentExerciseIndex + 1;\n  const progressPercentage = (currentProgress / totalItems) * 100;\n\n  // B2B Exercise Handlers\n  const handleCompleteB2BExercise = () => {\n    const b2bExercise = currentExercise as B2BExercise;\n    const b2bRestSeconds = Math.max(0, supersetRestSeconds);\n\n    if (currentExerciseInPair === 0) {\n      // Just completed first exercise, immediately move to second\n      setCurrentExerciseInPair(1);\n    } else {\n      // Completed both exercises in the pair\n      const newCompletedPairs = [...completedPairs, { ex1: setData1, ex2: setData2 }];\n      const totalSets = b2bExercise.exercises[0].sets;\n\n      console.log('B2B Completion Check:', {\n        newCompletedPairsLength: newCompletedPairs.length,\n        totalSets,\n        shouldContinue: newCompletedPairs.length < totalSets\n      });\n\n      // Guard: Don't allow completing more sets than total\n      if (newCompletedPairs.length > totalSets) {\n        console.log('Already completed all sets, ignoring duplicate click');\n        return;\n      }\n\n      void autosaveWorkout({\n        type: 'b2b_set',\n        exerciseName: b2bExercise.exercises[0].name,\n        partnerName: b2bExercise.exercises[1].name,\n        setIndex: currentSetIndex,\n        weight: setData1.weight,\n        reps: setData1.reps,\n        partnerWeight: setData2.weight,\n        partnerReps: setData2.reps,\n      });\n\n      setCompletedPairs(newCompletedPairs);\n\n      if (newCompletedPairs.length < totalSets) {\n        // More sets to go - rest briefly before next set\n        setCurrentSetIndex(currentSetIndex + 1);\n        setCurrentExerciseInPair(0); // Reset to first exercise for next round\n        if (b2bRestSeconds > 0) {\n          setIsResting(true);\n          setRestTimeRemaining(b2bRestSeconds);\n        } else {\n          setIsResting(false);\n          setRestTimeRemaining(0);\n        }\n      } else {\n        // All sets complete - save to session and show transition to next exercise\n        console.log('Finishing B2B exercise');\n        addExerciseToSession({\n          name: b2bExercise.exercises[0].name,\n          type: EXERCISE_TYPES.b2b,\n          isMachine: b2bExercise.exercises[0].isMachine,\n          primaryMetric: b2bExercise.exercises[0].primaryMetric,\n          metricUnit: b2bExercise.exercises[0].metricUnit ?? null,\n          sets: newCompletedPairs.map(pair => pair.ex1),\n          b2bPartner: {\n            name: b2bExercise.exercises[1].name,\n            isMachine: b2bExercise.exercises[1].isMachine,\n            primaryMetric: b2bExercise.exercises[1].primaryMetric,\n            metricUnit: b2bExercise.exercises[1].metricUnit ?? null,\n            sets: newCompletedPairs.map(pair => pair.ex2),\n          },\n        });\n\n        // Cache completed B2B exercise for review\n        setCompletedExercisesCache([...completedExercisesCache, {\n          exerciseIndex: currentExerciseIndex,\n          exerciseName: b2bExercise.exercises[0].name,\n          type: EXERCISE_TYPES.b2b,\n          completedPairs: newCompletedPairs,\n        }]);\n\n        if (currentExerciseIndex < workout!.exercises.length - 1) {\n          setIsResting(false);\n          setIsTransitioning(true);\n          setTransitionTimeRemaining(60);\n        } else {\n          // All exercises done - always go to cardio (optional)\n          router.push(`/workout/${encodeURIComponent(workout!.name)}/cardio${routineQuery}`);\n        }\n      }\n    }\n  };\n\n  // Single Exercise Handlers\n  const handleCompleteSet = () => {\n    const newCompletedSets = [...completedSets, setData];\n    setCompletedSets(newCompletedSets);\n\n    const exercise = currentExercise as SingleExercise;\n    const hasWarmup = resolveHasWarmup(exercise);\n    const restSeconds = Math.max(0, restTimeSeconds);\n    const isWarmupSet = hasWarmup && warmupDecision === 'include' && currentSetIndex === 0;\n\n    void autosaveWorkout({\n      type: 'single_set',\n      exerciseName: exercise.name,\n      setIndex: currentSetIndex,\n      weight: setData.weight,\n      reps: setData.reps,\n      isWarmup: isWarmupSet,\n    });\n\n    if (currentSetIndex === 0 && hasWarmup) {\n      setWarmupCompleted(true);\n    }\n\n    if (currentSetIndex < exercise.sets) {\n      // More sets to go - start rest timer\n      setCurrentSetIndex(currentSetIndex + 1);\n      if (restSeconds > 0) {\n        setIsResting(true);\n        setRestTimeRemaining(restSeconds);\n      } else {\n        setIsResting(false);\n        setRestTimeRemaining(0);\n      }\n\n      // Auto-update weight for next set (if it was warmup, switch to working weight)\n      if (currentSetIndex === 0) {\n        setSetData({\n          weight: exercise.isMachine && machineOnly ? 0 : exercise.targetWeight,\n          reps: exercise.targetReps,\n        });\n      }\n    } else {\n      // Exercise complete - save to session\n      addExerciseToSession({\n        name: exercise.name,\n        type: EXERCISE_TYPES.single,\n        isMachine: exercise.isMachine,\n        primaryMetric: exercise.primaryMetric,\n        metricUnit: exercise.metricUnit ?? null,\n        warmup: hasWarmup && warmupCompleted ? newCompletedSets[0] : undefined,\n        sets: hasWarmup && warmupCompleted ? newCompletedSets.slice(1) : newCompletedSets,\n      });\n\n      // Cache completed exercise for review\n      setCompletedExercisesCache([...completedExercisesCache, {\n        exerciseIndex: currentExerciseIndex,\n        exerciseName: exercise.name,\n        type: EXERCISE_TYPES.single,\n        completedSets: newCompletedSets,\n        warmupCompleted,\n      }]);\n\n      // Show transition to next exercise\n      if (currentExerciseIndex < workout.exercises.length - 1) {\n        setIsResting(false);\n        setIsTransitioning(true);\n        setTransitionTimeRemaining(60);\n      } else {\n        // All exercises done - always go to cardio (optional)\n        router.push(`/workout/${encodeURIComponent(workout.name)}/cardio${routineQuery}`);\n      }\n    }\n  };\n\n  const handleSkipRest = () => {\n    setIsResting(false);\n    setRestTimeRemaining(0);\n  };\n\n  const handleStartWarmup = () => {\n    const exercise = currentExercise as SingleExercise;\n    const suggestedWeight = exercise.isMachine && machineOnly\n      ? 0\n      : (exercise.warmupWeight > 0 ? exercise.warmupWeight : 0);\n    setWarmupDecision('include');\n    setWarmupCompleted(false);\n    setCurrentSetIndex(0);\n    setSetData({\n      weight: suggestedWeight,\n      reps: exercise.targetReps,\n    });\n  };\n\n  const handleSkipWarmup = () => {\n    const exercise = currentExercise as SingleExercise;\n    // Move to set 1 (first working set)\n    setWarmupDecision('skip');\n    setCurrentSetIndex(1);\n    setSetData({\n      weight: exercise.isMachine && machineOnly ? 0 : exercise.targetWeight,\n      reps: exercise.targetReps,\n    });\n    setWarmupCompleted(false);\n  };\n\n  const handleAddTime = () => {\n    setRestTimeRemaining(restTimeRemaining + 15);\n  };\n\n  const handleSkipTransition = () => {\n    setTransitionTimeRemaining(0);\n  };\n\n  const openHistory = (names: string[]) => {\n    setHistoryExerciseNames(names);\n    setShowHistory(true);\n  };\n\n  const closeHistory = () => {\n    setShowHistory(false);\n    setHistoryExerciseNames([]);\n  };\n\n  const handleEndExercise = () => {\n    console.log('handleEndExercise called', {\n      exerciseType: currentExercise.type,\n      currentExerciseIndex,\n      totalExercises: workout!.exercises.length\n    });\n\n    void autosaveWorkout({\n      type: 'exercise_end',\n    });\n\n    // Save completed sets and move to next exercise\n    if (currentExercise.type === EXERCISE_TYPES.single) {\n      const exercise = currentExercise as SingleExercise;\n      const hasWarmup = resolveHasWarmup(exercise);\n\n      if (completedSets.length > 0) {\n        addExerciseToSession({\n          name: exercise.name,\n          type: EXERCISE_TYPES.single,\n          isMachine: exercise.isMachine,\n          primaryMetric: exercise.primaryMetric,\n          metricUnit: exercise.metricUnit ?? null,\n          warmup: hasWarmup && warmupCompleted ? completedSets[0] : undefined,\n          sets: hasWarmup && warmupCompleted ? completedSets.slice(1) : completedSets,\n        });\n\n        // Cache for review\n        setCompletedExercisesCache([...completedExercisesCache, {\n          exerciseIndex: currentExerciseIndex,\n          exerciseName: exercise.name,\n          type: EXERCISE_TYPES.single,\n          completedSets: completedSets,\n          warmupCompleted,\n        }]);\n      }\n    } else {\n      // B2B exercise\n      const b2bExercise = currentExercise as B2BExercise;\n\n      console.log('Ending B2B exercise early', {\n        completedPairsLength: completedPairs.length\n      });\n\n      if (completedPairs.length > 0) {\n        addExerciseToSession({\n          name: b2bExercise.exercises[0].name,\n          type: EXERCISE_TYPES.b2b,\n          isMachine: b2bExercise.exercises[0].isMachine,\n          primaryMetric: b2bExercise.exercises[0].primaryMetric,\n          metricUnit: b2bExercise.exercises[0].metricUnit ?? null,\n          sets: completedPairs.map(pair => pair.ex1),\n          b2bPartner: {\n            name: b2bExercise.exercises[1].name,\n            isMachine: b2bExercise.exercises[1].isMachine,\n            primaryMetric: b2bExercise.exercises[1].primaryMetric,\n            metricUnit: b2bExercise.exercises[1].metricUnit ?? null,\n            sets: completedPairs.map(pair => pair.ex2),\n          },\n        });\n\n        // Cache for review\n        setCompletedExercisesCache([...completedExercisesCache, {\n          exerciseIndex: currentExerciseIndex,\n          exerciseName: b2bExercise.exercises[0].name,\n          type: EXERCISE_TYPES.b2b,\n          completedPairs: completedPairs,\n        }]);\n      }\n    }\n\n    // Move to next exercise or finish\n    if (currentExerciseIndex < workout!.exercises.length - 1) {\n      console.log('Moving to next exercise');\n      setIsResting(false);\n      setIsTransitioning(true);\n      setTransitionTimeRemaining(60);\n      // Keep viewing index synced so next exercise isn't in read-only mode\n      setViewingExerciseIndex(currentExerciseIndex);\n    } else {\n      console.log('All exercises done, going to cardio');\n      // All exercises done - always go to cardio (optional)\n      router.push(`/workout/${encodeURIComponent(workout!.name)}/cardio${routineQuery}`);\n    }\n  };\n\n  const handleBackClick = (e: React.MouseEvent) => {\n    e.preventDefault();\n\n    // If viewing a previous exercise, go back one more\n    if (viewingExerciseIndex > 0) {\n      setViewingExerciseIndex(viewingExerciseIndex - 1);\n    } else if (workout) {\n      // At the first exercise, go back to pre-stretches (if any) or exit\n      const preStretchCount = workout.preWorkoutStretches?.length || 0;\n      if (preStretchCount > 0) {\n        const stretchParams = new URLSearchParams(routineQueryParams.toString());\n        stretchParams.set('index', String(preStretchCount - 1));\n        router.push(`/stretches/${encodeURIComponent(workout.name)}?${stretchParams.toString()}`);\n      } else {\n        setShowExitConfirm(true);\n      }\n    }\n  };\n\n  // Handle going to previous section (for WorkoutNavHeader)\n  const handlePreviousSection = () => {\n    if (!workout) return;\n\n    if (viewingExerciseIndex > 0) {\n      setViewingExerciseIndex(viewingExerciseIndex - 1);\n    } else {\n      // Go to last pre-stretch\n      const preStretchCount = workout.preWorkoutStretches?.length || 0;\n      if (preStretchCount > 0) {\n        const stretchParams = new URLSearchParams(routineQueryParams.toString());\n        stretchParams.set('index', String(preStretchCount - 1));\n        router.push(`/stretches/${encodeURIComponent(workout.name)}?${stretchParams.toString()}`);\n      }\n    }\n  };\n\n  const handleForwardClick = () => {\n    // Can only go forward if there are completed exercises ahead\n    if (viewingExerciseIndex < currentExerciseIndex) {\n      setViewingExerciseIndex(viewingExerciseIndex + 1);\n    }\n  };\n\n  const buildSingleExercise = (exercise: ExerciseOption): SingleExercise => {\n    const isBodyweight = typeof exercise.is_bodyweight === 'number'\n      ? exercise.is_bodyweight === 1\n      : false;\n    const isMachine = typeof exercise.is_machine === 'number'\n      ? exercise.is_machine === 1\n      : false;\n    return {\n      type: EXERCISE_TYPES.single,\n      name: exercise.name,\n      sets: 3,\n      targetReps: 10,\n      targetWeight: 0,\n      warmupWeight: 0,\n      hasWarmup: !isBodyweight,\n      restTime: 60,\n      videoUrl: exercise.video_url || '',\n      tips: exercise.tips || '',\n      isBodyweight,\n      isMachine\n    };\n  };\n\n  const buildSupersetExercise = (exercise1: ExerciseOption, exercise2: ExerciseOption): B2BExercise => {\n    const isBodyweight1 = typeof exercise1.is_bodyweight === 'number'\n      ? exercise1.is_bodyweight === 1\n      : false;\n    const isBodyweight2 = typeof exercise2.is_bodyweight === 'number'\n      ? exercise2.is_bodyweight === 1\n      : false;\n    const isMachine1 = typeof exercise1.is_machine === 'number'\n      ? exercise1.is_machine === 1\n      : false;\n    const isMachine2 = typeof exercise2.is_machine === 'number'\n      ? exercise2.is_machine === 1\n      : false;\n    return {\n      type: EXERCISE_TYPES.b2b,\n      restTime: 30,\n      exercises: [\n        {\n          name: exercise1.name,\n          sets: 3,\n          targetReps: 10,\n          targetWeight: 0,\n          warmupWeight: 0,\n          hasWarmup: false,\n          videoUrl: exercise1.video_url || '',\n          tips: exercise1.tips || '',\n          isBodyweight: isBodyweight1,\n          isMachine: isMachine1\n        },\n        {\n          name: exercise2.name,\n          sets: 3,\n          targetReps: 10,\n          targetWeight: 0,\n          warmupWeight: 0,\n          hasWarmup: false,\n          videoUrl: exercise2.video_url || '',\n          tips: exercise2.tips || '',\n          isBodyweight: isBodyweight2,\n          isMachine: isMachine2\n        }\n      ]\n    };\n  };\n\n  const applyWorkoutUpdate = (updatedWorkout: WorkoutPlan) => {\n    setWorkout(updatedWorkout);\n    saveSessionWorkout(updatedWorkout, routineIdParam);\n  };\n\n  const resetExerciseStateFor = (exercise: Exercise) => {\n    setIsResting(false);\n    setRestTimeRemaining(0);\n    setIsTransitioning(false);\n    setTransitionTimeRemaining(60);\n    setCompletedSets([]);\n    setCompletedPairs([]);\n    setCurrentExerciseInPair(0);\n    setLastExerciseLog(null);\n    setLastPartnerExerciseLog(null);\n\n    if (exercise.type === EXERCISE_TYPES.single) {\n      initSingleExerciseState(exercise);\n    } else {\n      const b2bExercise = exercise as B2BExercise;\n      const defaultMachineOnly1 = !!b2bExercise.exercises[0].isMachine\n        && isExerciseWeightMetric(b2bExercise.exercises[0])\n        && b2bExercise.exercises[0].targetWeight <= 0;\n      const defaultMachineOnly2 = !!b2bExercise.exercises[1].isMachine\n        && isExerciseWeightMetric(b2bExercise.exercises[1])\n        && b2bExercise.exercises[1].targetWeight <= 0;\n      setSetData1({\n        weight: defaultMachineOnly1 ? 0 : b2bExercise.exercises[0].targetWeight,\n        reps: b2bExercise.exercises[0].targetReps,\n      });\n      setSetData2({\n        weight: defaultMachineOnly2 ? 0 : b2bExercise.exercises[1].targetWeight,\n        reps: b2bExercise.exercises[1].targetReps,\n      });\n      setMachineOnly1(defaultMachineOnly1);\n      setMachineOnly2(defaultMachineOnly2);\n      setMachineOnlyHoldWeight1(b2bExercise.exercises[0].targetWeight);\n      setMachineOnlyHoldWeight2(b2bExercise.exercises[1].targetWeight);\n      setCurrentSetIndex(1);\n      setWarmupDecision('skip');\n      setWarmupCompleted(false);\n    }\n\n    setViewingExerciseIndex(currentExerciseIndex);\n  };\n\n  const fetchLastSetSummary = async (exerciseName: string): Promise<LastSetSummary> => {\n    try {\n      const response = await fetch(\n        `/api/last-exercise?exerciseName=${encodeURIComponent(exerciseName)}`\n      );\n      if (!response.ok) return null;\n      const data = await response.json();\n      return data.lastLog ?? null;\n    } catch (error) {\n      console.error('Error fetching last exercise log:', error);\n      return null;\n    }\n  };\n\n  const refreshLastSetSummaries = async (exerciseNames: string[]) => {\n    const entries = await Promise.all(\n      exerciseNames.map(async (name) => [name, await fetchLastSetSummary(name)] as const)\n    );\n    setLastSetSummaries((prev) => ({\n      ...prev,\n      ...Object.fromEntries(entries),\n    }));\n  };\n\n  const runWithChangeWarning = (action: () => void) => {\n    if (!workout) return;\n    if (hasChangeWarningAck(workout.name, routineIdParam)) {\n      action();\n      return;\n    }\n    pendingChangeRef.current = action;\n    setShowChangeWarning(true);\n  };\n\n  const handleWarningContinue = () => {\n    if (!workout) {\n      setShowChangeWarning(false);\n      return;\n    }\n    acknowledgeChangeWarning(workout.name, routineIdParam);\n    setShowChangeWarning(false);\n    const action = pendingChangeRef.current;\n    pendingChangeRef.current = null;\n    action?.();\n  };\n\n  const handleWarningCancel = () => {\n    pendingChangeRef.current = null;\n    setShowChangeWarning(false);\n  };\n\n  const openExerciseTypePicker = (mode: 'add' | 'replace') => {\n    runWithChangeWarning(() => {\n      setExerciseActionMode(mode);\n      setShowExerciseTypePicker(true);\n    });\n  };\n\n  const handleSelectSingleExercise = (exercise: ExerciseOption) => {\n    if (!workout || !exerciseActionMode) return;\n    const nextExercise = buildSingleExercise(exercise);\n    const updatedExercises = [...workout.exercises];\n    const insertIndex = currentExerciseIndex;\n\n    if (exerciseActionMode === 'add') {\n      updatedExercises.splice(insertIndex, 0, nextExercise);\n      resetExerciseStateFor(nextExercise);\n    } else {\n      updatedExercises[currentExerciseIndex] = nextExercise;\n      resetExerciseStateFor(nextExercise);\n    }\n\n    applyWorkoutUpdate({ ...workout, exercises: updatedExercises });\n    setExerciseActionMode(null);\n    setShowExerciseSelector(false);\n    void refreshLastSetSummaries([exercise.name]);\n  };\n\n  const handleSelectSuperset = (exercise1: ExerciseOption, exercise2: ExerciseOption) => {\n    if (!workout || !exerciseActionMode) return;\n    const nextExercise = buildSupersetExercise(exercise1, exercise2);\n    const updatedExercises = [...workout.exercises];\n    const insertIndex = currentExerciseIndex;\n\n    if (exerciseActionMode === 'add') {\n      updatedExercises.splice(insertIndex, 0, nextExercise);\n      resetExerciseStateFor(nextExercise);\n    } else {\n      updatedExercises[currentExerciseIndex] = nextExercise;\n      resetExerciseStateFor(nextExercise);\n    }\n\n    applyWorkoutUpdate({ ...workout, exercises: updatedExercises });\n    setExerciseActionMode(null);\n    setShowSupersetSelector(false);\n    void refreshLastSetSummaries([exercise1.name, exercise2.name]);\n  };\n\n  const handleExerciseTypeCancel = () => {\n    setShowExerciseTypePicker(false);\n    setExerciseActionMode(null);\n  };\n\n  // Determine which exercise to display (for review mode vs active mode)\n  const exerciseToDisplay = isReviewMode ? viewingExercise : currentExercise;\n  const modifyAccentClasses = exerciseToDisplay.type === EXERCISE_TYPES.b2b\n    ? 'bg-purple-600 hover:bg-purple-500'\n    : 'bg-rose-800 hover:bg-rose-700';\n  const hasExerciseStarted = currentExercise.type === EXERCISE_TYPES.b2b\n    ? completedPairs.length > 0 || currentExerciseInPair !== 0\n    : completedSets.length > 0;\n  const canModifyExercise = !isReviewMode && !hasExerciseStarted;\n  const exerciseModifyControls = canModifyExercise ? (\n    <div className=\"flex items-center gap-2\">\n      <button\n        onClick={() => openExerciseTypePicker('add')}\n        className={`inline-flex items-center gap-1 rounded-md px-3 py-1.5 text-xs font-semibold text-white transition-colors ${modifyAccentClasses}`}\n      >\n        + Add Exercise\n      </button>\n      <button\n        onClick={() => openExerciseTypePicker('replace')}\n        className={`inline-flex items-center gap-1 rounded-md px-3 py-1.5 text-xs font-semibold text-white transition-colors ${modifyAccentClasses}`}\n      >\n         Replace\n      </button>\n    </div>\n  ) : null;\n  const exerciseModals = (\n    <>\n      {showChangeWarning && (\n        <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/70 p-4\">\n          <div className=\"w-full max-w-md rounded-lg border border-zinc-700 bg-zinc-900 p-6 text-white\">\n            <h3 className=\"text-lg font-semibold mb-2\">Session-only change</h3>\n            <p className=\"text-sm text-zinc-300 mb-6\">\n              This edit only applies to today&apos;s workout. Edit the routine to make a permanent change.\n            </p>\n            <div className=\"grid grid-cols-2 gap-3\">\n              <button\n                onClick={handleWarningCancel}\n                className=\"rounded-lg bg-zinc-700 py-2 text-sm font-semibold text-white hover:bg-zinc-600\"\n              >\n                Cancel\n              </button>\n              <button\n                onClick={handleWarningContinue}\n                className=\"rounded-lg bg-emerald-600 py-2 text-sm font-semibold text-white hover:bg-emerald-500\"\n              >\n                Continue\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {showExerciseTypePicker && (\n        <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/70 p-4\">\n          <div className=\"w-full max-w-sm rounded-lg border border-zinc-700 bg-zinc-900 p-5 text-white\">\n            <h3 className=\"text-lg font-semibold mb-4\">Choose exercise type</h3>\n            <div className=\"space-y-3\">\n              <button\n                onClick={() => {\n                  setShowExerciseTypePicker(false);\n                  setShowExerciseSelector(true);\n                }}\n                className=\"w-full rounded-lg bg-rose-800 py-2 text-sm font-semibold text-white hover:bg-rose-700\"\n              >\n                Single exercise\n              </button>\n              <button\n                onClick={() => {\n                  setShowExerciseTypePicker(false);\n                  setShowSupersetSelector(true);\n                }}\n                className=\"w-full rounded-lg bg-purple-600 py-2 text-sm font-semibold text-white hover:bg-purple-500\"\n              >\n                Superset\n              </button>\n              <button\n                onClick={handleExerciseTypeCancel}\n                className=\"w-full rounded-lg bg-zinc-700 py-2 text-sm font-semibold text-white hover:bg-zinc-600\"\n              >\n                Cancel\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {showExerciseSelector && (\n        <ExerciseSelector\n          title={exerciseActionMode === 'replace' ? 'Replace Exercise' : 'Add Exercise'}\n          onCancel={() => {\n            setShowExerciseSelector(false);\n            setExerciseActionMode(null);\n          }}\n          onSelect={handleSelectSingleExercise}\n        />\n      )}\n\n      {showSupersetSelector && (\n        <SupersetSelector\n          onCancel={() => {\n            setShowSupersetSelector(false);\n            setExerciseActionMode(null);\n          }}\n          onSelect={handleSelectSuperset}\n        />\n      )}\n\n      <ExerciseHistoryModal\n        open={showHistory}\n        onClose={closeHistory}\n        exerciseNames={historyExerciseNames}\n        title=\"Exercise History\"\n        targets={historyTargets}\n        weightUnit={weightUnit}\n        heightUnit={heightUnit}\n      />\n    </>\n  );\n\n  // Handle B2B/Superset exercises\n  if (exerciseToDisplay.type === EXERCISE_TYPES.b2b) {\n    const b2bExercise = exerciseToDisplay as B2BExercise;\n    const ex1 = b2bExercise.exercises[0];\n    const ex2 = b2bExercise.exercises[1];\n    const ex1MetricInfo = getMetricInfo(ex1);\n    const ex2MetricInfo = getMetricInfo(ex2);\n    const ex1RepsOnly = isRepsOnlyMetric(ex1MetricInfo.primaryMetric);\n    const ex2RepsOnly = isRepsOnlyMetric(ex2MetricInfo.primaryMetric);\n    const ex1IsWeightMetric = isWeightMetric(ex1MetricInfo.primaryMetric);\n    const ex2IsWeightMetric = isWeightMetric(ex2MetricInfo.primaryMetric);\n    const ex1Machine = !!ex1.isMachine && ex1IsWeightMetric;\n    const ex2Machine = !!ex2.isMachine && ex2IsWeightMetric;\n    const showMachineToggle1 = ex1Machine && !ex1RepsOnly;\n    const showMachineToggle2 = ex2Machine && !ex2RepsOnly;\n    const showMetricInput1 = !ex1RepsOnly && !(ex1Machine && machineOnly1);\n    const showMetricInput2 = !ex2RepsOnly && !(ex2Machine && machineOnly2);\n\n    // In review mode, show cached completed pairs\n    const displayCompletedPairs = isReviewMode && viewingCachedData\n      ? viewingCachedData.completedPairs || []\n      : completedPairs;\n\n    // Transition Screen (for B2B)\n    if (isTransitioning) {\n      return (\n        <div className=\"min-h-screen bg-zinc-900 p-4\">\n          <div className=\"max-w-2xl mx-auto\">\n            {/* Header */}\n            <div className=\"flex justify-between items-center mb-6\">\n              <div className=\"text-zinc-400\">Exercise {currentExerciseIndex + 1}/{workout.exercises.length}</div>\n            </div>\n\n            {/* Exercise Names */}\n            <h1 className=\"text-2xl font-bold text-white text-center mb-2\">{ex1.name}</h1>\n            <div className=\"text-purple-400 text-center text-lg mb-8\">+ {ex2.name}</div>\n\n            {/* Exercise Complete */}\n            <div className=\"text-center mb-8\">\n              <div className=\"text-green-500 text-6xl mb-2\"></div>\n              <div className=\"text-white text-2xl font-semibold\">EXERCISE COMPLETE</div>\n            </div>\n\n            {/* Transition Timer */}\n            <div className={`bg-zinc-800 rounded-lg p-12 mb-8 text-center border-4 ${transitionTimeRemaining === 0 ? 'border-zinc-700' : 'border-orange-600'}`}>\n              <div className={`text-xl mb-4 ${transitionTimeRemaining === 0 ? 'text-zinc-400' : 'text-orange-400'}`}>Chilll Outtt</div>\n              <div className={`text-8xl font-bold mb-2 ${transitionTimeRemaining === 0 ? 'text-orange-400' : 'text-white'}`}>\n                {transitionTimeRemaining}\n              </div>\n              <div className=\"text-zinc-400 text-lg\">seconds</div>\n            </div>\n\n            {/* Timer Controls */}\n            <div className=\"space-y-3\">\n              <button\n                onClick={() => setTransitionTimeRemaining(0)}\n                className=\"w-full bg-green-600 hover:bg-green-700 text-white py-4 rounded-lg text-lg font-bold transition-colors\"\n              >\n                Skip Timer \n              </button>\n              <div className=\"grid grid-cols-2 gap-4\">\n                <button\n                  onClick={() => setTransitionTimeRemaining(Math.max(0, transitionTimeRemaining - 15))}\n                  className=\"bg-zinc-800 hover:bg-zinc-700 text-white py-3 rounded-lg font-semibold transition-colors\"\n                >\n                  -15s\n                </button>\n                <button\n                  onClick={() => setTransitionTimeRemaining(transitionTimeRemaining + 15)}\n                  className=\"bg-zinc-800 hover:bg-zinc-700 text-white py-3 rounded-lg font-semibold transition-colors\"\n                >\n                  +15s\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      );\n    }\n\n    // Rest Timer Screen (for B2B)\n    if (isResting) {\n      return (\n        <div className=\"min-h-screen bg-zinc-900 p-4\">\n          <div className=\"max-w-2xl mx-auto\">\n            {/* Header */}\n            <div className=\"flex justify-between items-center mb-6\">\n              <div className=\"text-zinc-400\">Exercise {currentExerciseIndex + 1}/{workout.exercises.length}</div>\n            </div>\n\n            {/* Exercise Names */}\n            <h1 className=\"text-2xl font-bold text-white text-center mb-2\">{ex1.name}</h1>\n            <div className=\"text-purple-400 text-center text-lg mb-8\">+ {ex2.name}</div>\n\n            {/* Set Complete */}\n            <div className=\"text-center mb-8\">\n              <div className=\"text-green-500 text-6xl mb-2\"></div>\n              <div className=\"text-white text-2xl font-semibold\">\n                SET {completedPairs.length} COMPLETE\n              </div>\n            </div>\n\n            {/* Rest Timer */}\n            <div className={`bg-zinc-800 rounded-lg p-12 mb-8 text-center border-4 ${restTimeRemaining === 0 ? 'border-zinc-700' : 'border-purple-600'}`}>\n              <div className={`text-xl mb-4 ${restTimeRemaining === 0 ? 'text-zinc-400' : 'text-purple-400'}`}>REST TIME</div>\n              <div className={`text-8xl font-bold mb-2 ${restTimeRemaining === 0 ? 'text-purple-400' : 'text-white'}`}>\n                {restTimeRemaining}\n              </div>\n              <div className=\"text-zinc-400 text-lg\">seconds</div>\n            </div>\n\n            {/* Timer Controls */}\n            <div className=\"grid grid-cols-2 gap-4 mb-8\">\n              <button\n                onClick={handleAddTime}\n                className=\"bg-zinc-700 hover:bg-zinc-600 text-white py-4 rounded-lg text-lg font-semibold transition-colors\"\n              >\n                + Add 15s\n              </button>\n              <button\n                onClick={handleSkipRest}\n                className=\"bg-blue-600 hover:bg-blue-700 text-white py-4 rounded-lg text-lg font-semibold transition-colors\"\n              >\n                {restTimeRemaining === 0 ? 'Continue Workout' : 'Skip Rest'}\n              </button>\n            </div>\n\n            {/* Next Set Info */}\n            <div className=\"bg-zinc-800 rounded-lg p-4 text-center\">\n              <div className=\"text-zinc-400 text-sm mb-2\">Next up:</div>\n              <div className=\"text-white text-xl font-semibold\">\n                Set {currentSetIndex}\n              </div>\n              <div className=\"text-zinc-300 text-base\">\n                {ex1.name}  {ex2.name}\n              </div>\n            </div>\n          </div>\n        </div>\n      );\n    }\n\n    // B2B Exercise Tracking Screen\n    return (\n      <div className=\"min-h-screen bg-zinc-900 p-4 pb-32\">\n        <div className=\"max-w-2xl mx-auto\">\n          {/* Navigation */}\n          <WorkoutNavHeader\n            exitUrl={`/workout/${encodeURIComponent(workout.name)}${routineQuery}`}\n            previousUrl={null}\n            onPrevious={handlePreviousSection}\n            onNext={isReviewMode ? () => setViewingExerciseIndex(viewingExerciseIndex + 1) : undefined}\n          />\n          <div className=\"flex justify-end mb-2\">\n            <AutosaveBadge />\n          </div>\n          <div className=\"text-zinc-400 text-right mb-4 -mt-4\">Exercise {viewingExerciseIndex + 1}/{workout.exercises.length}</div>\n\n          {/* READ ONLY Banner */}\n          {isReviewMode && (\n            <div className=\"bg-yellow-900 border border-yellow-600 rounded-lg p-3 mb-6\">\n              <div className=\"text-yellow-200 text-sm font-semibold text-center\">\n                 READ ONLY - Cannot edit completed sets\n              </div>\n            </div>\n          )}\n\n          {/* Progress Bar */}\n          <div className=\"mb-6\">\n            <div className=\"h-2 bg-zinc-800 rounded-full overflow-hidden\">\n              <div\n                className=\"h-full bg-purple-500 transition-all duration-300\"\n                style={{ width: `${progressPercentage}%` }}\n              />\n            </div>\n            <div className=\"text-zinc-500 text-sm text-center mt-2\">\n              Overall Progress: {currentProgress} / {totalItems}\n            </div>\n          </div>\n\n          <div className=\"flex items-center gap-3 mb-4\">\n            {exerciseModifyControls}\n            <button\n              onClick={() => openHistory([ex1.name, ex2.name])}\n              className=\"ml-auto bg-zinc-800 hover:bg-zinc-700 text-zinc-200 px-4 py-2 rounded-lg text-sm font-semibold transition-colors\"\n            >\n               History\n            </button>\n          </div>\n\n          {/* Superset Title */}\n          <div className=\"text-center mb-6\">\n            <div className=\"text-purple-400 text-sm font-bold mb-2\"> SUPERSET</div>\n            <div className=\"text-white text-lg font-semibold mb-1\">\n              SET {currentSetIndex} of {ex1.sets}\n            </div>\n          </div>\n\n          {/* Last Time Section for B2B */}\n          {(lastExerciseLog || lastPartnerExerciseLog) && (\n            <div className=\"bg-zinc-800 rounded-lg p-4 mb-6 border border-zinc-700\">\n              <div className=\"text-zinc-400 text-sm mb-3\">LAST TIME</div>\n              <div className=\"grid grid-cols-2 gap-4\">\n                {/* Exercise 1 Last Time */}\n                <div>\n                  <div className=\"text-purple-400 text-xs font-semibold mb-1\">{ex1.name}</div>\n                  {lastExerciseLog ? (\n                    <>\n                      <div className=\"text-zinc-500 text-xs mb-2\">\n                        {formatLocalDate(lastExerciseDate)}\n                      </div>\n                      <div className=\"space-y-1\">\n                        {([1, 2, 3, 4] as const).map((setNum) => {\n                          const weight = getLogSetValue(lastExerciseLog, setNum, 'weight');\n                          const reps = getLogSetValue(lastExerciseLog, setNum, 'reps');\n                          if (weight !== null && reps !== null) {\n                            return (\n                              <div key={setNum} className=\"text-zinc-300 text-xs\">\n                                {ex1RepsOnly\n                                  ? `Set ${setNum}: ${reps} reps`\n                                  : `Set ${setNum}: ${formatMetric(weight, ex1MetricInfo, ex1Machine)}  ${reps}`}\n                              </div>\n                            );\n                          }\n                          return null;\n                        })}\n                      </div>\n                    </>\n                  ) : (\n                    <div className=\"text-zinc-500 text-xs\">No history yet</div>\n                  )}\n                </div>\n                {/* Exercise 2 Last Time */}\n                <div>\n                  <div className=\"text-purple-400 text-xs font-semibold mb-1\">{ex2.name}</div>\n                  {lastPartnerExerciseLog ? (\n                    <>\n                      <div className=\"text-zinc-500 text-xs mb-2\">\n                        {formatLocalDate(lastPartnerExerciseDate)}\n                      </div>\n                      <div className=\"space-y-1\">\n                        {([1, 2, 3, 4] as const).map((setNum) => {\n                          const weight = getLogSetValue(lastPartnerExerciseLog, setNum, 'weight');\n                          const reps = getLogSetValue(lastPartnerExerciseLog, setNum, 'reps');\n                          if (weight !== null && reps !== null) {\n                            return (\n                              <div key={setNum} className=\"text-zinc-300 text-xs\">\n                                {ex2RepsOnly\n                                  ? `Set ${setNum}: ${reps} reps`\n                                  : `Set ${setNum}: ${formatMetric(weight, ex2MetricInfo, ex2Machine)}  ${reps}`}\n                              </div>\n                            );\n                          }\n                          return null;\n                        })}\n                      </div>\n                    </>\n                  ) : (\n                    <div className=\"text-zinc-500 text-xs\">No history yet</div>\n                  )}\n                </div>\n              </div>\n            </div>\n          )}\n\n          {/* Exercise 1 Card */}\n          <div className={`bg-zinc-800 rounded-lg p-5 mb-4 transition-all ${\n            currentExerciseInPair === 0 ? 'border-2 border-purple-600' : 'border border-zinc-700 opacity-60'\n          }`}>\n            <div className=\"flex items-start justify-between mb-3\">\n              <div className=\"flex-1\">\n                <div className=\"text-zinc-500 text-xs mb-1\">\n                  Exercise 1 of 2 {currentExerciseInPair === 0 ? '(ACTIVE)' : completedPairs.length >= currentSetIndex ? '(Done)' : '(Next)'}\n                </div>\n                <h2 className=\"text-xl font-bold text-white mb-2\">{ex1.name}</h2>\n              </div>\n              <a\n                href={getVideoUrl(ex1.name, ex1.videoUrl)}\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n                className=\"text-red-500 hover:text-red-400 text-sm font-medium px-3 py-2 bg-zinc-900 rounded\"\n              >\n                 Video\n              </a>\n            </div>\n\n            <div className=\"bg-zinc-900 rounded p-3 mb-3 border border-purple-700/50\">\n              <div className=\"text-purple-300 text-xs mb-2\">Today&apos;s target</div>\n              <div className={`grid ${ex1RepsOnly ? 'grid-cols-1' : 'grid-cols-2'} gap-3`}>\n                {!ex1RepsOnly && (\n                  <div className=\"text-center\">\n                    <div className=\"text-zinc-500 text-xs mb-1\">\n                      {getMetricLabelText(ex1MetricInfo, ex1Machine)}\n                    </div>\n                    <div className=\"text-white text-lg font-semibold\">\n                      {formatMetric(ex1.targetWeight, ex1MetricInfo, ex1Machine)}\n                    </div>\n                  </div>\n                )}\n                <div className=\"text-center\">\n                  <div className=\"text-zinc-500 text-xs mb-1\">Reps</div>\n                  <div className=\"text-white text-lg font-semibold\">\n                    {ex1.targetReps}\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            {!isReviewMode && currentExerciseInPair === 0 ? (\n              <>\n                {/* Active: Show inputs */}\n                {showMachineToggle1 && (\n                  <label className=\"flex items-center gap-2 text-xs text-zinc-400 mb-2\">\n                    <input\n                      type=\"checkbox\"\n                      checked={machineOnly1}\n                      onChange={(e) => {\n                        const checked = e.target.checked;\n                        setMachineOnly1(checked);\n                        setSetData1((prev) => {\n                          if (checked) {\n                            setMachineOnlyHoldWeight1(prev.weight);\n                            return { ...prev, weight: 0 };\n                          }\n                          const restore = Number.isFinite(machineOnlyHoldWeight1)\n                            ? machineOnlyHoldWeight1\n                            : ex1.targetWeight;\n                          return { ...prev, weight: restore };\n                        });\n                      }}\n                    />\n                    Machine weight only\n                  </label>\n                )}\n                <div className={`grid ${showMetricInput1 ? 'grid-cols-2' : 'grid-cols-1'} gap-3 mb-3`}>\n                  {showMetricInput1 && (\n                    <div className=\"bg-zinc-900 rounded-lg p-3\">\n                      <label className=\"text-zinc-400 text-xs block mb-1\">\n                        {getMetricLabelText(ex1MetricInfo, ex1Machine)}\n                      </label>\n                      <input\n                        type=\"text\"\n                        inputMode=\"decimal\"\n                        value={formatMetricValueInput(setData1.weight, ex1MetricInfo)}\n                        onChange={(e) => {\n                          const val = e.target.value;\n                          const nextValue = parseMetricValueInput(val, ex1MetricInfo);\n                          if (nextValue !== null) {\n                            setSetData1({ ...setData1, weight: nextValue });\n                          }\n                        }}\n                        className=\"w-full bg-zinc-800 text-white text-2xl font-bold text-center rounded p-2 focus:outline-none focus:ring-2 focus:ring-purple-500\"\n                      />\n                    </div>\n                  )}\n                  <div className=\"bg-zinc-900 rounded-lg p-3\">\n                    <label className=\"text-zinc-400 text-xs block mb-1\">Reps</label>\n                    <input\n                      type=\"text\"\n                      inputMode=\"numeric\"\n                      value={setData1.reps ?? ''}\n                      onChange={(e) => setSetData1({ ...setData1, reps: parseInt(e.target.value) || 0 })}\n                      className=\"w-full bg-zinc-800 text-white text-2xl font-bold text-center rounded p-2 focus:outline-none focus:ring-2 focus:ring-purple-500\"\n                    />\n                  </div>\n                </div>\n\n                <div className=\"bg-zinc-900 rounded p-3 mb-3\">\n                  <div className=\"text-zinc-500 text-xs mb-1\">Form Tips</div>\n                  <p className=\"text-zinc-300 text-sm\">{getFormTips(ex1.tips)}</p>\n                </div>\n\n                <button\n                  onClick={handleCompleteB2BExercise}\n                  className=\"w-full bg-purple-600 hover:bg-purple-700 text-white py-3 rounded-lg text-lg font-bold transition-colors\"\n                >\n                   Complete Exercise 1\n                </button>\n              </>\n            ) : (\n              <>\n                {/* Inactive: Show entered data */}\n                <div className=\"grid grid-cols-2 gap-3 mb-3\">\n                  <div className=\"bg-zinc-900 rounded p-3 text-center\">\n                    <div className=\"text-zinc-500 text-xs mb-1\">\n                      {getMetricLabelText(ex1MetricInfo, ex1Machine)}\n                    </div>\n                    <div className=\"text-white text-xl font-semibold\">\n                      {formatMetric(setData1.weight, ex1MetricInfo, ex1Machine)}\n                    </div>\n                  </div>\n                  <div className=\"bg-zinc-900 rounded p-3 text-center\">\n                    <div className=\"text-zinc-500 text-xs mb-1\">Reps</div>\n                    <div className=\"text-white text-xl font-semibold\">\n                      {setData1.reps}\n                    </div>\n                  </div>\n                </div>\n              </>\n            )}\n          </div>\n\n          {/* Exercise 2 Card */}\n          <div className={`bg-zinc-800 rounded-lg p-5 mb-6 transition-all ${\n            currentExerciseInPair === 1 ? 'border-2 border-purple-600' : 'border border-zinc-700 opacity-60'\n          }`}>\n            <div className=\"flex items-start justify-between mb-3\">\n              <div className=\"flex-1\">\n                <div className=\"text-zinc-500 text-xs mb-1\">\n                  Exercise 2 of 2 {currentExerciseInPair === 1 ? '(ACTIVE)' : currentExerciseInPair === 0 ? '(Next)' : '(Done)'}\n                </div>\n                <h2 className=\"text-xl font-bold text-white mb-2\">{ex2.name}</h2>\n              </div>\n              <a\n                href={getVideoUrl(ex2.name, ex2.videoUrl)}\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n                className=\"text-red-500 hover:text-red-400 text-sm font-medium px-3 py-2 bg-zinc-900 rounded\"\n              >\n                 Video\n              </a>\n            </div>\n\n            <div className=\"bg-zinc-900 rounded p-3 mb-3 border border-purple-700/50\">\n              <div className=\"text-purple-300 text-xs mb-2\">Today&apos;s target</div>\n              <div className={`grid ${ex2RepsOnly ? 'grid-cols-1' : 'grid-cols-2'} gap-3`}>\n                {!ex2RepsOnly && (\n                  <div className=\"text-center\">\n                    <div className=\"text-zinc-500 text-xs mb-1\">\n                      {getMetricLabelText(ex2MetricInfo, ex2Machine)}\n                    </div>\n                    <div className=\"text-white text-lg font-semibold\">\n                      {formatMetric(ex2.targetWeight, ex2MetricInfo, ex2Machine)}\n                    </div>\n                  </div>\n                )}\n                <div className=\"text-center\">\n                  <div className=\"text-zinc-500 text-xs mb-1\">Reps</div>\n                  <div className=\"text-white text-lg font-semibold\">\n                    {ex2.targetReps}\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            {!isReviewMode && currentExerciseInPair === 1 ? (\n              <>\n                {/* Active: Show inputs */}\n                {showMachineToggle2 && (\n                  <label className=\"flex items-center gap-2 text-xs text-zinc-400 mb-2\">\n                    <input\n                      type=\"checkbox\"\n                      checked={machineOnly2}\n                      onChange={(e) => {\n                        const checked = e.target.checked;\n                        setMachineOnly2(checked);\n                        setSetData2((prev) => {\n                          if (checked) {\n                            setMachineOnlyHoldWeight2(prev.weight);\n                            return { ...prev, weight: 0 };\n                          }\n                          const restore = Number.isFinite(machineOnlyHoldWeight2)\n                            ? machineOnlyHoldWeight2\n                            : ex2.targetWeight;\n                          return { ...prev, weight: restore };\n                        });\n                      }}\n                    />\n                    Machine weight only\n                  </label>\n                )}\n                <div className={`grid ${showMetricInput2 ? 'grid-cols-2' : 'grid-cols-1'} gap-3 mb-3`}>\n                  {showMetricInput2 && (\n                    <div className=\"bg-zinc-900 rounded-lg p-3\">\n                      <label className=\"text-zinc-400 text-xs block mb-1\">\n                        {getMetricLabelText(ex2MetricInfo, ex2Machine)}\n                      </label>\n                      <input\n                        type=\"text\"\n                        inputMode=\"decimal\"\n                        value={formatMetricValueInput(setData2.weight, ex2MetricInfo)}\n                        onChange={(e) => {\n                          const val = e.target.value;\n                          const nextValue = parseMetricValueInput(val, ex2MetricInfo);\n                          if (nextValue !== null) {\n                            setSetData2({ ...setData2, weight: nextValue });\n                          }\n                        }}\n                        className=\"w-full bg-zinc-800 text-white text-2xl font-bold text-center rounded p-2 focus:outline-none focus:ring-2 focus:ring-purple-500\"\n                      />\n                    </div>\n                  )}\n                  <div className=\"bg-zinc-900 rounded-lg p-3\">\n                    <label className=\"text-zinc-400 text-xs block mb-1\">Reps</label>\n                    <input\n                      type=\"text\"\n                      inputMode=\"numeric\"\n                      value={setData2.reps ?? ''}\n                      onChange={(e) => setSetData2({ ...setData2, reps: parseInt(e.target.value) || 0 })}\n                      className=\"w-full bg-zinc-800 text-white text-2xl font-bold text-center rounded p-2 focus:outline-none focus:ring-2 focus:ring-purple-500\"\n                    />\n                  </div>\n                </div>\n\n                <div className=\"bg-zinc-900 rounded p-3 mb-3\">\n                  <div className=\"text-zinc-500 text-xs mb-1\">Form Tips</div>\n                  <p className=\"text-zinc-300 text-sm\">{getFormTips(ex2.tips)}</p>\n                </div>\n\n                <div className=\"space-y-3\">\n                  <button\n                    onClick={handleCompleteB2BExercise}\n                    className=\"w-full bg-purple-600 hover:bg-purple-700 text-white py-3 rounded-lg text-lg font-bold transition-colors\"\n                  >\n                     Complete Exercise 2\n                  </button>\n                </div>\n              </>\n            ) : (\n              <>\n                {/* Inactive: Show entered data */}\n                <div className=\"grid grid-cols-2 gap-3 mb-3\">\n                  <div className=\"bg-zinc-900 rounded p-3 text-center\">\n                    <div className=\"text-zinc-500 text-xs mb-1\">\n                      {getMetricLabelText(ex2MetricInfo, ex2Machine)}\n                    </div>\n                    <div className=\"text-white text-xl font-semibold\">\n                      {formatMetric(setData2.weight, ex2MetricInfo, ex2Machine)}\n                    </div>\n                  </div>\n                  <div className=\"bg-zinc-900 rounded p-3 text-center\">\n                    <div className=\"text-zinc-500 text-xs mb-1\">Reps</div>\n                    <div className=\"text-white text-xl font-semibold\">\n                      {setData2.reps}\n                    </div>\n                  </div>\n                </div>\n              </>\n            )}\n          </div>\n\n          {/* Completed Sets */}\n          {displayCompletedPairs.length > 0 && (\n            <div className=\"bg-zinc-800 rounded-lg p-4 mb-4\">\n              <div className=\"text-zinc-400 text-sm mb-2\">COMPLETED SETS</div>\n              {displayCompletedPairs.map((pair, index) => (\n                <div key={index} className=\"mb-2\">\n                  <div className=\"text-green-400 text-sm font-semibold mb-1\">Set {index + 1}:</div>\n                  <div className=\"text-zinc-300 text-xs ml-2\">\n                     {ex1.name}: {formatMetric(pair.ex1.weight, ex1MetricInfo, ex1Machine)}  {pair.ex1.reps} reps\n                  </div>\n                  <div className=\"text-zinc-300 text-xs ml-2\">\n                     {ex2.name}: {formatMetric(pair.ex2.weight, ex2MetricInfo, ex2Machine)}  {pair.ex2.reps} reps\n                  </div>\n                </div>\n              ))}\n            </div>\n          )}\n\n          {/* Skip Exercise (only in active mode, not review mode) */}\n          {!isReviewMode && (\n            <button\n              onClick={() => {\n                if (completedPairs.length > 0) {\n                  handleEndExercise();\n                  return;\n                }\n                void autosaveWorkout({ type: 'exercise_skip' });\n                if (currentExerciseIndex < workout.exercises.length - 1) {\n                  const nextExerciseIndex = currentExerciseIndex + 1;\n                  setCurrentExerciseIndex(nextExerciseIndex);\n                  setViewingExerciseIndex(nextExerciseIndex);\n                  setCompletedPairs([]);\n\n                  // Initialize next exercise\n                  const nextExercise = workout.exercises[nextExerciseIndex];\n                  if (nextExercise.type === EXERCISE_TYPES.single) {\n                    initSingleExerciseState(nextExercise);\n                  } else {\n                    const b2bEx = nextExercise as B2BExercise;\n                    const defaultMachineOnly1 = !!b2bEx.exercises[0].isMachine\n                      && isExerciseWeightMetric(b2bEx.exercises[0])\n                      && b2bEx.exercises[0].targetWeight <= 0;\n                    const defaultMachineOnly2 = !!b2bEx.exercises[1].isMachine\n                      && isExerciseWeightMetric(b2bEx.exercises[1])\n                      && b2bEx.exercises[1].targetWeight <= 0;\n                    setSetData1({\n                      weight: defaultMachineOnly1 ? 0 : b2bEx.exercises[0].targetWeight,\n                      reps: b2bEx.exercises[0].targetReps,\n                    });\n                    setSetData2({\n                      weight: defaultMachineOnly2 ? 0 : b2bEx.exercises[1].targetWeight,\n                      reps: b2bEx.exercises[1].targetReps,\n                    });\n                    setMachineOnly1(defaultMachineOnly1);\n                    setMachineOnly2(defaultMachineOnly2);\n                    setMachineOnlyHoldWeight1(b2bEx.exercises[0].targetWeight);\n                    setMachineOnlyHoldWeight2(b2bEx.exercises[1].targetWeight);\n                    setCurrentSetIndex(1);\n                    setCurrentExerciseInPair(0);\n                    setWarmupDecision('skip');\n                    setWarmupCompleted(false);\n                  }\n                } else {\n                  // Always go to cardio (optional)\n                  router.push(`/workout/${encodeURIComponent(workout.name)}/cardio${routineQuery}`);\n                }\n              }}\n              className=\"w-full bg-zinc-700 hover:bg-zinc-600 text-white py-3 rounded-lg font-semibold transition-colors\"\n            >\n              {completedPairs.length > 0 ? 'End Exercise' : 'Skip Exercise'}\n            </button>\n          )}\n\n          {exerciseModals}\n        </div>\n      </div>\n    );\n  }\n\n  const exercise = exerciseToDisplay as SingleExercise;\n  const metricInfo = getMetricInfo(exercise);\n  const hasWarmup = resolveHasWarmup(exercise);\n  const isWarmupSet = hasWarmup && warmupDecision === 'include' && currentSetIndex === 0;\n  const isRepsOnly = isRepsOnlyMetric(metricInfo.primaryMetric);\n  const isMachine = !!exercise.isMachine && isWeightMetric(metricInfo.primaryMetric);\n  const showMachineToggle = isMachine && !isRepsOnly;\n  const showMetricInput = !isRepsOnly && !(isMachine && machineOnly);\n\n  // In review mode, show cached completed sets\n  const displayCompletedSets = isReviewMode && viewingCachedData\n    ? viewingCachedData.completedSets || []\n    : completedSets;\n  const displayWarmupCompleted = hasWarmup && (isReviewMode\n    ? !!viewingCachedData?.warmupCompleted\n    : warmupCompleted);\n  const showWarmupPrompt = !isReviewMode && hasWarmup && warmupDecision === 'pending';\n  const warmupSuggestionWeight = hasWarmup && exercise.warmupWeight > 0 && isWeightMetric(metricInfo.primaryMetric)\n    ? exercise.warmupWeight\n    : null;\n  const weightInputValue = isWarmupSet && warmupSuggestionWeight === null && showMetricInput && setData.weight === 0\n    ? ''\n    : formatMetricValueInput(setData.weight, metricInfo);\n\n  // Transition Screen (between exercises)\n  if (isTransitioning) {\n    const nextExercise = workout.exercises[currentExerciseIndex + 1];\n    const nextExerciseName = nextExercise.type === EXERCISE_TYPES.single\n      ? nextExercise.name\n      : `${nextExercise.exercises[0].name} / ${nextExercise.exercises[1].name}`;\n\n    return (\n      <div className=\"min-h-screen bg-zinc-900 p-4\">\n        <div className=\"max-w-2xl mx-auto flex flex-col items-center justify-center min-h-screen\">\n          {/* Progress Bar */}\n          <div className=\"w-full mb-12\">\n            <div className=\"h-2 bg-zinc-800 rounded-full overflow-hidden\">\n              <div\n                className=\"h-full bg-rose-600 transition-all duration-300\"\n                style={{ width: `${progressPercentage}%` }}\n              />\n            </div>\n          </div>\n\n          {/* Heading */}\n          <div className=\"text-zinc-400 text-xl mb-4\">Next Exercise</div>\n\n          {/* Exercise Name */}\n          <h1 className=\"text-4xl font-bold text-white text-center mb-12 px-4\">\n            {nextExerciseName}\n          </h1>\n\n          {/* Countdown Timer */}\n          <div className={`bg-zinc-800 rounded-lg p-16 mb-12 text-center border-4 ${transitionTimeRemaining === 0 ? 'border-zinc-700' : 'border-rose-700'}`}>\n            <div className={`text-xl mb-4 ${transitionTimeRemaining === 0 ? 'text-zinc-400' : 'text-rose-300'}`}>Chilll Outtt</div>\n            <div className={`text-9xl font-bold mb-2 ${transitionTimeRemaining === 0 ? 'text-rose-300' : 'text-white'}`}>\n              {transitionTimeRemaining}\n            </div>\n            <div className=\"text-zinc-400 text-lg\">seconds</div>\n          </div>\n\n          {/* Skip Button */}\n          <button\n            onClick={handleSkipTransition}\n            className=\"bg-rose-700 hover:bg-rose-600 text-white px-12 py-5 rounded-lg text-2xl font-bold transition-colors\"\n          >\n            I'm Ready \n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  // Rest Timer Screen\n  if (isResting) {\n    return (\n      <div className=\"min-h-screen bg-zinc-900 p-4\">\n        <div className=\"max-w-2xl mx-auto\">\n          {/* Header */}\n          <div className=\"flex justify-between items-center mb-6\">\n            <div className=\"text-zinc-400\">Exercise {currentExerciseIndex + 1}/{workout.exercises.length}</div>\n          </div>\n\n          {/* Exercise Name */}\n          <h1 className=\"text-3xl font-bold text-white text-center mb-8\">{exercise.name}</h1>\n\n          {/* Set Complete */}\n          <div className=\"text-center mb-8\">\n            <div className=\"text-rose-400 text-6xl mb-2\"></div>\n            <div className=\"text-white text-2xl font-semibold\">\n              {hasWarmup && warmupCompleted && completedSets.length === 1\n                ? 'WARMUP SET'\n                : `SET ${hasWarmup && warmupCompleted ? completedSets.length - 1 : completedSets.length}`} COMPLETE\n            </div>\n          </div>\n\n          {/* Rest Timer */}\n          <div className={`bg-zinc-800 rounded-lg p-12 mb-8 text-center border-4 ${restTimeRemaining === 0 ? 'border-zinc-700' : 'border-rose-700'}`}>\n            <div className={`text-xl mb-4 ${restTimeRemaining === 0 ? 'text-zinc-400' : 'text-rose-300'}`}>REST TIME</div>\n            <div className={`text-8xl font-bold mb-2 ${restTimeRemaining === 0 ? 'text-rose-300' : 'text-white'}`}>\n              {restTimeRemaining}\n            </div>\n            <div className=\"text-zinc-400 text-lg\">seconds</div>\n          </div>\n\n          {/* Timer Controls */}\n          <div className=\"grid grid-cols-2 gap-4 mb-8\">\n            <button\n              onClick={handleAddTime}\n              className=\"bg-zinc-700 hover:bg-zinc-600 text-white py-4 rounded-lg text-lg font-semibold transition-colors\"\n            >\n              + Add 15s\n            </button>\n            <button\n              onClick={handleSkipRest}\n              className=\"bg-rose-700 hover:bg-rose-600 text-white py-4 rounded-lg text-lg font-semibold transition-colors\"\n            >\n              {restTimeRemaining === 0 ? 'Continue Workout' : 'Skip Rest'}\n            </button>\n          </div>\n\n          {/* Next Set Info */}\n          <div className=\"bg-zinc-800 rounded-lg p-4 text-center\">\n            <div className=\"text-zinc-400 text-sm mb-2\">Next up:</div>\n            <div className=\"text-white text-xl font-semibold\">\n              Set {currentSetIndex} (Working)\n            </div>\n            <div className=\"text-zinc-300 text-lg\">\n              {formatMetric(exercise.targetWeight, metricInfo, isMachine)}  {exercise.targetReps} reps\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  // Exit Confirmation Modal\n  if (showExitConfirm) {\n    return (\n      <div className=\"min-h-screen bg-zinc-900 flex items-center justify-center p-4\">\n        <div className=\"max-w-md w-full bg-zinc-800 rounded-lg p-6\">\n          <h2 className=\"text-white text-2xl font-bold mb-4\">Exit Routine?</h2>\n          <p className=\"text-zinc-300 mb-6\">\n            You will lose your current routine progress. Completed exercises have been saved to the database.\n          </p>\n          <div className=\"grid grid-cols-2 gap-4\">\n            <button\n              onClick={() => setShowExitConfirm(false)}\n              className=\"bg-zinc-700 hover:bg-zinc-600 text-white py-3 rounded-lg font-semibold transition-colors\"\n            >\n              Continue\n            </button>\n            <Link\n              href=\"/routines\"\n              className=\"bg-red-600 hover:bg-red-700 text-white py-3 rounded-lg font-semibold transition-colors text-center\"\n            >\n              Exit Routine\n            </Link>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  // Exercise Tracking Screen\n  return (\n    <div className=\"min-h-screen bg-zinc-900 p-4 pb-32\">\n      <div className=\"max-w-2xl mx-auto\">\n        {/* Navigation */}\n        <WorkoutNavHeader\n          exitUrl={`/workout/${encodeURIComponent(workout.name)}${routineQuery}`}\n          previousUrl={null}\n          onPrevious={handlePreviousSection}\n          onNext={isReviewMode ? () => setViewingExerciseIndex(viewingExerciseIndex + 1) : undefined}\n        />\n        <div className=\"flex justify-end mb-2\">\n          <AutosaveBadge />\n        </div>\n        <div className=\"text-zinc-400 text-right mb-4 -mt-4\">Exercise {viewingExerciseIndex + 1}/{workout.exercises.length}</div>\n\n        {/* READ ONLY Banner */}\n        {isReviewMode && (\n          <div className=\"bg-yellow-900 border border-yellow-600 rounded-lg p-3 mb-6\">\n            <div className=\"text-yellow-200 text-sm font-semibold text-center\">\n               READ ONLY - Cannot edit completed sets\n            </div>\n          </div>\n        )}\n\n        {/* Progress Bar */}\n        <div className=\"mb-6\">\n          <div className=\"h-2 bg-zinc-800 rounded-full overflow-hidden\">\n              <div\n                className=\"h-full bg-rose-600 transition-all duration-300\"\n                style={{ width: `${progressPercentage}%` }}\n              />\n          </div>\n          <div className=\"text-zinc-500 text-sm text-center mt-2\">\n            Overall Progress: {currentProgress} / {totalItems}\n          </div>\n        </div>\n\n        <div className=\"flex items-center gap-3 mb-3\">\n          {exerciseModifyControls}\n          <button\n            onClick={() => openHistory([exercise.name])}\n            className=\"ml-auto bg-zinc-800 hover:bg-zinc-700 text-zinc-200 px-4 py-2 rounded-lg text-sm font-semibold transition-colors\"\n          >\n             History\n          </button>\n        </div>\n        <h1 className=\"text-3xl font-bold text-white mb-6\">{exercise.name}</h1>\n\n        {/* Last Time Section */}\n        {lastExerciseLog && (\n          <div className=\"bg-zinc-800 rounded-lg p-4 mb-6 border border-zinc-700\">\n            <div className=\"text-zinc-400 text-sm mb-2\">\n              LAST TIME ({formatLocalDate(lastExerciseDate)})\n            </div>\n            <div className=\"space-y-1\">\n              {lastExerciseLog.warmup_weight !== null && lastExerciseLog.warmup_reps !== null && (\n                <div className=\"text-zinc-300 text-sm\">\n                  {isRepsOnly\n                    ? `Warmup: ${lastExerciseLog.warmup_reps} reps`\n                    : `Warmup: ${formatMetric(lastExerciseLog.warmup_weight, metricInfo, isMachine)}  ${lastExerciseLog.warmup_reps} reps`}\n                </div>\n              )}\n              {([1, 2, 3, 4] as const).map((setNum) => {\n                const weight = getLogSetValue(lastExerciseLog, setNum, 'weight');\n                const reps = getLogSetValue(lastExerciseLog, setNum, 'reps');\n                if (weight !== null && reps !== null) {\n                  return (\n                    <div key={setNum} className=\"text-zinc-300 text-sm\">\n                      {isRepsOnly\n                        ? `Set ${setNum}: ${reps} reps`\n                        : `Set ${setNum}: ${formatMetric(weight, metricInfo, isMachine)}  ${reps} reps`}\n                    </div>\n                  );\n                }\n                return null;\n              })}\n            </div>\n          </div>\n        )}\n\n        <div className=\"bg-zinc-800 rounded-lg p-4 mb-6 border border-emerald-700\">\n          <div className=\"text-emerald-400 text-xs mb-2\">TODAY&apos;S TARGET</div>\n          <div className={`grid ${isRepsOnly ? 'grid-cols-1' : 'grid-cols-2'} gap-4`}>\n            {!isRepsOnly && (\n              <div className=\"bg-zinc-900 rounded p-3 text-center\">\n                <div className=\"text-zinc-500 text-xs mb-1\">\n                  {getMetricLabelText(metricInfo, isMachine)}\n                </div>\n                <div className=\"text-white text-xl font-semibold\">\n                  {formatMetric(exercise.targetWeight, metricInfo, isMachine)}\n                </div>\n              </div>\n            )}\n            <div className=\"bg-zinc-900 rounded p-3 text-center\">\n              <div className=\"text-zinc-500 text-xs mb-1\">Reps</div>\n              <div className=\"text-white text-xl font-semibold\">\n                {exercise.targetReps}\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {/* Warmup Choice */}\n        {!isReviewMode && showWarmupPrompt && (\n          <div className=\"bg-zinc-800 rounded-lg p-6 mb-6 border-2 border-rose-700\">\n            <div className=\"text-center mb-3\">\n              <div className=\"text-rose-300 text-lg font-semibold mb-2\">Warm up?</div>\n              <div className=\"text-zinc-400 text-sm\">Optional warmup set before working sets.</div>\n              {warmupSuggestionWeight !== null && !isRepsOnly && (\n                <div className=\"text-zinc-300 text-sm mt-2\">\n                  Suggested warmup: {formatMetric(warmupSuggestionWeight, metricInfo, isMachine)}\n                </div>\n              )}\n            </div>\n            <div className=\"grid grid-cols-2 gap-3\">\n              <button\n                onClick={handleStartWarmup}\n                className=\"bg-rose-700 hover:bg-rose-600 text-white py-4 rounded-lg text-lg font-semibold transition-colors\"\n              >\n                Warm up\n              </button>\n              <button\n                onClick={handleSkipWarmup}\n                className=\"bg-zinc-700 hover:bg-zinc-600 text-white py-4 rounded-lg text-lg font-semibold transition-colors\"\n              >\n                Start Set 1\n              </button>\n            </div>\n          </div>\n        )}\n\n        {/* Current Set - Only show if not in review mode */}\n        {!isReviewMode && !showWarmupPrompt && (\n          <div className=\"bg-zinc-800 rounded-lg p-6 mb-6 border-2 border-rose-700\">\n            <div className=\"text-center mb-4\">\n              <div className=\"text-rose-300 text-lg font-semibold mb-2\">\n                {isWarmupSet ? 'WARMUP SET' : `SET ${currentSetIndex} (WORKING)`}\n              </div>\n            </div>\n\n            {/* Weight and Reps Inputs */}\n            {showMachineToggle && (\n              <label className=\"flex items-center gap-2 text-xs text-zinc-400 mb-3\">\n                <input\n                  type=\"checkbox\"\n                  checked={machineOnly}\n                  onChange={(e) => {\n                    const checked = e.target.checked;\n                    setMachineOnly(checked);\n                    setSetData((prev) => {\n                      if (checked) {\n                        setMachineOnlyHoldWeight(prev.weight);\n                        return { ...prev, weight: 0 };\n                      }\n                      const restore = Number.isFinite(machineOnlyHoldWeight)\n                        ? machineOnlyHoldWeight\n                        : exercise.targetWeight;\n                      return { ...prev, weight: restore };\n                    });\n                  }}\n                />\n                Machine weight only\n              </label>\n            )}\n            <div className={`grid ${showMetricInput ? 'grid-cols-2' : 'grid-cols-1'} gap-4 mb-4`}>\n              {showMetricInput && (\n                <div className=\"bg-zinc-900 rounded-lg p-4\">\n                  <label className=\"text-zinc-400 text-sm block mb-2\">\n                    {getMetricLabelText(metricInfo, isMachine)}\n                  </label>\n                  <input\n                    type=\"text\"\n                    inputMode=\"decimal\"\n                    value={weightInputValue}\n                    onChange={(e) => {\n                      const val = e.target.value;\n                      const nextValue = parseMetricValueInput(val, metricInfo);\n                      if (nextValue !== null) {\n                        setSetData({ ...setData, weight: nextValue });\n                      }\n                    }}\n                    className=\"w-full bg-zinc-800 text-white text-3xl font-bold text-center rounded p-2 focus:outline-none focus:ring-2 focus:ring-rose-600\"\n                  />\n                </div>\n              )}\n              <div className=\"bg-zinc-900 rounded-lg p-4\">\n                <label className=\"text-zinc-400 text-sm block mb-2\">Reps</label>\n                <input\n                  type=\"text\"\n                  inputMode=\"numeric\"\n                  value={setData.reps ?? ''}\n                  onChange={(e) => setSetData({ ...setData, reps: parseInt(e.target.value) || 0 })}\n                  className=\"w-full bg-zinc-800 text-white text-3xl font-bold text-center rounded p-2 focus:outline-none focus:ring-2 focus:ring-rose-600\"\n                />\n              </div>\n            </div>\n\n            {/* Complete Set Button(s) */}\n            {isWarmupSet ? (\n              <div className=\"grid grid-cols-2 gap-3\">\n                <button\n                  onClick={handleSkipWarmup}\n                  className=\"bg-zinc-700 hover:bg-zinc-600 text-white py-4 rounded-lg text-lg font-semibold transition-colors\"\n                >\n                  Skip Warmup\n                </button>\n                <button\n                  onClick={handleCompleteSet}\n                  className=\"bg-rose-700 hover:bg-rose-600 text-white py-4 rounded-lg text-lg font-bold transition-colors\"\n                >\n                   Complete Warmup\n                </button>\n              </div>\n            ) : (\n              <div className=\"space-y-3\">\n                <button\n                  onClick={handleCompleteSet}\n                  className=\"w-full bg-rose-700 hover:bg-rose-600 text-white py-4 rounded-lg text-xl font-bold transition-colors\"\n                >\n                   Complete Set {currentSetIndex}\n                </button>\n              </div>\n            )}\n          </div>\n        )}\n\n        {/* Completed Sets */}\n        {displayCompletedSets.length > 0 && (\n          <div className=\"bg-zinc-800 rounded-lg p-4 mb-6\">\n            <div className=\"text-zinc-400 text-sm mb-2\">COMPLETED SETS</div>\n            {displayCompletedSets.map((set, index) => {\n              const label = displayWarmupCompleted\n                ? (index === 0 ? 'Warmup' : `Set ${index}`)\n                : `Set ${index + 1}`;\n              return (\n                <div key={index} className=\"text-rose-300 text-sm mb-1\">\n                   {label}: {formatMetric(set.weight, metricInfo, isMachine)}  {set.reps} reps\n                </div>\n              );\n            })}\n          </div>\n        )}\n\n        {/* Form Tips */}\n        <div className=\"bg-zinc-800 rounded-lg p-4 mb-4\">\n          <div className=\"text-zinc-400 text-sm mb-2\">FORM TIPS</div>\n          <p className=\"text-zinc-200 text-base leading-relaxed\">{getFormTips(exercise.tips)}</p>\n        </div>\n\n        {/* Video and Skip */}\n        <div className={isReviewMode ? '' : 'grid grid-cols-2 gap-4'}>\n          <a\n            href={getVideoUrl(exercise.name, exercise.videoUrl)}\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n            className=\"block bg-red-600 hover:bg-red-700 text-white text-center py-3 rounded-lg font-semibold transition-colors\"\n          >\n             Watch Video\n          </a>\n          {!isReviewMode && (\n            <button\n              onClick={() => {\n                if (completedSets.length > 0) {\n                  handleEndExercise();\n                  return;\n                }\n                void autosaveWorkout({ type: 'exercise_skip' });\n                if (currentExerciseIndex < workout.exercises.length - 1) {\n                  const nextExerciseIndex = currentExerciseIndex + 1;\n                  setCurrentExerciseIndex(nextExerciseIndex);\n                  setViewingExerciseIndex(nextExerciseIndex);\n                  setCompletedSets([]);\n\n                  // Initialize next exercise\n                  const nextExercise = workout.exercises[nextExerciseIndex];\n                  if (nextExercise.type === EXERCISE_TYPES.single) {\n                    initSingleExerciseState(nextExercise);\n                  } else {\n                    const b2bEx = nextExercise as B2BExercise;\n                    const defaultMachineOnly1 = !!b2bEx.exercises[0].isMachine\n                      && isExerciseWeightMetric(b2bEx.exercises[0])\n                      && b2bEx.exercises[0].targetWeight <= 0;\n                    const defaultMachineOnly2 = !!b2bEx.exercises[1].isMachine\n                      && isExerciseWeightMetric(b2bEx.exercises[1])\n                      && b2bEx.exercises[1].targetWeight <= 0;\n                    setSetData1({\n                      weight: defaultMachineOnly1 ? 0 : b2bEx.exercises[0].targetWeight,\n                      reps: b2bEx.exercises[0].targetReps,\n                    });\n                    setSetData2({\n                      weight: defaultMachineOnly2 ? 0 : b2bEx.exercises[1].targetWeight,\n                      reps: b2bEx.exercises[1].targetReps,\n                    });\n                    setMachineOnly1(defaultMachineOnly1);\n                    setMachineOnly2(defaultMachineOnly2);\n                    setMachineOnlyHoldWeight1(b2bEx.exercises[0].targetWeight);\n                    setMachineOnlyHoldWeight2(b2bEx.exercises[1].targetWeight);\n                    setCurrentSetIndex(1);\n                    setCurrentExerciseInPair(0);\n                    setCompletedPairs([]);\n                    setWarmupDecision('skip');\n                    setWarmupCompleted(false);\n                  }\n                } else {\n                  // Always go to cardio (optional)\n                  router.push(`/workout/${encodeURIComponent(workout.name)}/cardio${routineQuery}`);\n                }\n              }}\n              className=\"bg-zinc-700 hover:bg-zinc-600 text-white py-3 rounded-lg font-semibold transition-colors\"\n            >\n              {completedSets.length > 0 ? 'End Exercise' : 'Skip Exercise'}\n            </button>\n          )}\n\n          {exerciseModals}\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default function ActiveWorkoutPage() {\n  return (\n    <Suspense fallback={\n      <div className=\"min-h-screen bg-zinc-900 flex items-center justify-center p-4\">\n        <div className=\"text-white text-2xl\">Loading...</div>\n      </div>\n    }>\n      <ActiveWorkoutContent />\n    </Suspense>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}