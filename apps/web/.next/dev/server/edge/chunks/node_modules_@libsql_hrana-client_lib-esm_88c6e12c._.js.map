{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/node_modules/@libsql/hrana-client/lib-esm/client.js"],"sourcesContent":["/** A client for the Hrana protocol (a \"database connection pool\"). */\nexport class Client {\n    /** @private */\n    constructor() {\n        this.intMode = \"number\";\n    }\n    /** Representation of integers returned from the database. See {@link IntMode}.\n     *\n     * This value is inherited by {@link Stream} objects created with {@link openStream}, but you can\n     * override the integer mode for every stream by setting {@link Stream.intMode} on the stream.\n     */\n    intMode;\n}\n"],"names":[],"mappings":"AAAA,oEAAoE;;;;AAC7D,MAAM;IACT,aAAa,GACb,aAAc;QACV,IAAI,CAAC,OAAO,GAAG;IACnB;IACA;;;;KAIC,GACD,QAAQ;AACZ","ignoreList":[0]}},
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/node_modules/@libsql/hrana-client/lib-esm/errors.js"],"sourcesContent":["/** Generic error produced by the Hrana client. */\nexport class ClientError extends Error {\n    /** @private */\n    constructor(message) {\n        super(message);\n        this.name = \"ClientError\";\n    }\n}\n/** Error thrown when the server violates the protocol. */\nexport class ProtoError extends ClientError {\n    /** @private */\n    constructor(message) {\n        super(message);\n        this.name = \"ProtoError\";\n    }\n}\n/** Error thrown when the server returns an error response. */\nexport class ResponseError extends ClientError {\n    code;\n    /** @internal */\n    proto;\n    /** @private */\n    constructor(message, protoError) {\n        super(message);\n        this.name = \"ResponseError\";\n        this.code = protoError.code;\n        this.proto = protoError;\n        this.stack = undefined;\n    }\n}\n/** Error thrown when the client or stream is closed. */\nexport class ClosedError extends ClientError {\n    /** @private */\n    constructor(message, cause) {\n        if (cause !== undefined) {\n            super(`${message}: ${cause}`);\n            this.cause = cause;\n        }\n        else {\n            super(message);\n        }\n        this.name = \"ClosedError\";\n    }\n}\n/** Error thrown when the environment does not seem to support WebSockets. */\nexport class WebSocketUnsupportedError extends ClientError {\n    /** @private */\n    constructor(message) {\n        super(message);\n        this.name = \"WebSocketUnsupportedError\";\n    }\n}\n/** Error thrown when we encounter a WebSocket error. */\nexport class WebSocketError extends ClientError {\n    /** @private */\n    constructor(message) {\n        super(message);\n        this.name = \"WebSocketError\";\n    }\n}\n/** Error thrown when the HTTP server returns an error response. */\nexport class HttpServerError extends ClientError {\n    status;\n    /** @private */\n    constructor(message, status) {\n        super(message);\n        this.status = status;\n        this.name = \"HttpServerError\";\n    }\n}\n/** Error thrown when a libsql URL is not valid. */\nexport class LibsqlUrlParseError extends ClientError {\n    /** @private */\n    constructor(message) {\n        super(message);\n        this.name = \"LibsqlUrlParseError\";\n    }\n}\n/** Error thrown when the protocol version is too low to support a feature. */\nexport class ProtocolVersionError extends ClientError {\n    /** @private */\n    constructor(message) {\n        super(message);\n        this.name = \"ProtocolVersionError\";\n    }\n}\n/** Error thrown when an internal client error happens. */\nexport class InternalError extends ClientError {\n    /** @private */\n    constructor(message) {\n        super(message);\n        this.name = \"InternalError\";\n    }\n}\n/** Error thrown when the API is misused. */\nexport class MisuseError extends ClientError {\n    /** @private */\n    constructor(message) {\n        super(message);\n        this.name = \"MisuseError\";\n    }\n}\n"],"names":[],"mappings":"AAAA,gDAAgD;;;;;;;;;;;;;;;;;;;;;;;;AACzC,MAAM,oBAAoB;IAC7B,aAAa,GACb,YAAY,OAAO,CAAE;QACjB,KAAK,CAAC;QACN,IAAI,CAAC,IAAI,GAAG;IAChB;AACJ;AAEO,MAAM,mBAAmB;IAC5B,aAAa,GACb,YAAY,OAAO,CAAE;QACjB,KAAK,CAAC;QACN,IAAI,CAAC,IAAI,GAAG;IAChB;AACJ;AAEO,MAAM,sBAAsB;IAC/B,KAAK;IACL,cAAc,GACd,MAAM;IACN,aAAa,GACb,YAAY,OAAO,EAAE,UAAU,CAAE;QAC7B,KAAK,CAAC;QACN,IAAI,CAAC,IAAI,GAAG;QACZ,IAAI,CAAC,IAAI,GAAG,WAAW,IAAI;QAC3B,IAAI,CAAC,KAAK,GAAG;QACb,IAAI,CAAC,KAAK,GAAG;IACjB;AACJ;AAEO,MAAM,oBAAoB;IAC7B,aAAa,GACb,YAAY,OAAO,EAAE,KAAK,CAAE;QACxB,IAAI,UAAU,WAAW;YACrB,KAAK,CAAC,GAAG,QAAQ,EAAE,EAAE,OAAO;YAC5B,IAAI,CAAC,KAAK,GAAG;QACjB,OACK;YACD,KAAK,CAAC;QACV;QACA,IAAI,CAAC,IAAI,GAAG;IAChB;AACJ;AAEO,MAAM,kCAAkC;IAC3C,aAAa,GACb,YAAY,OAAO,CAAE;QACjB,KAAK,CAAC;QACN,IAAI,CAAC,IAAI,GAAG;IAChB;AACJ;AAEO,MAAM,uBAAuB;IAChC,aAAa,GACb,YAAY,OAAO,CAAE;QACjB,KAAK,CAAC;QACN,IAAI,CAAC,IAAI,GAAG;IAChB;AACJ;AAEO,MAAM,wBAAwB;IACjC,OAAO;IACP,aAAa,GACb,YAAY,OAAO,EAAE,MAAM,CAAE;QACzB,KAAK,CAAC;QACN,IAAI,CAAC,MAAM,GAAG;QACd,IAAI,CAAC,IAAI,GAAG;IAChB;AACJ;AAEO,MAAM,4BAA4B;IACrC,aAAa,GACb,YAAY,OAAO,CAAE;QACjB,KAAK,CAAC;QACN,IAAI,CAAC,IAAI,GAAG;IAChB;AACJ;AAEO,MAAM,6BAA6B;IACtC,aAAa,GACb,YAAY,OAAO,CAAE;QACjB,KAAK,CAAC;QACN,IAAI,CAAC,IAAI,GAAG;IAChB;AACJ;AAEO,MAAM,sBAAsB;IAC/B,aAAa,GACb,YAAY,OAAO,CAAE;QACjB,KAAK,CAAC;QACN,IAAI,CAAC,IAAI,GAAG;IAChB;AACJ;AAEO,MAAM,oBAAoB;IAC7B,aAAa,GACb,YAAY,OAAO,CAAE;QACjB,KAAK,CAAC;QACN,IAAI,CAAC,IAAI,GAAG;IAChB;AACJ","ignoreList":[0]}},
    {"offset": {"line": 128, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/node_modules/@libsql/hrana-client/lib-esm/encoding/json/decode.js"],"sourcesContent":["import { ProtoError } from \"../../errors.js\";\nexport function string(value) {\n    if (typeof value === \"string\") {\n        return value;\n    }\n    throw typeError(value, \"string\");\n}\nexport function stringOpt(value) {\n    if (value === null || value === undefined) {\n        return undefined;\n    }\n    else if (typeof value === \"string\") {\n        return value;\n    }\n    throw typeError(value, \"string or null\");\n}\nexport function number(value) {\n    if (typeof value === \"number\") {\n        return value;\n    }\n    throw typeError(value, \"number\");\n}\nexport function boolean(value) {\n    if (typeof value === \"boolean\") {\n        return value;\n    }\n    throw typeError(value, \"boolean\");\n}\nexport function array(value) {\n    if (Array.isArray(value)) {\n        return value;\n    }\n    throw typeError(value, \"array\");\n}\nexport function object(value) {\n    if (value !== null && typeof value === \"object\" && !Array.isArray(value)) {\n        return value;\n    }\n    throw typeError(value, \"object\");\n}\nexport function arrayObjectsMap(value, fun) {\n    return array(value).map((elemValue) => fun(object(elemValue)));\n}\nfunction typeError(value, expected) {\n    if (value === undefined) {\n        return new ProtoError(`Expected ${expected}, but the property was missing`);\n    }\n    let received = typeof value;\n    if (value === null) {\n        received = \"null\";\n    }\n    else if (Array.isArray(value)) {\n        received = \"array\";\n    }\n    return new ProtoError(`Expected ${expected}, received ${received}`);\n}\nexport function readJsonObject(value, fun) {\n    return fun(object(value));\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;AAAA;;AACO,SAAS,OAAO,KAAK;IACxB,IAAI,OAAO,UAAU,UAAU;QAC3B,OAAO;IACX;IACA,MAAM,UAAU,OAAO;AAC3B;AACO,SAAS,UAAU,KAAK;IAC3B,IAAI,UAAU,QAAQ,UAAU,WAAW;QACvC,OAAO;IACX,OACK,IAAI,OAAO,UAAU,UAAU;QAChC,OAAO;IACX;IACA,MAAM,UAAU,OAAO;AAC3B;AACO,SAAS,OAAO,KAAK;IACxB,IAAI,OAAO,UAAU,UAAU;QAC3B,OAAO;IACX;IACA,MAAM,UAAU,OAAO;AAC3B;AACO,SAAS,QAAQ,KAAK;IACzB,IAAI,OAAO,UAAU,WAAW;QAC5B,OAAO;IACX;IACA,MAAM,UAAU,OAAO;AAC3B;AACO,SAAS,MAAM,KAAK;IACvB,IAAI,MAAM,OAAO,CAAC,QAAQ;QACtB,OAAO;IACX;IACA,MAAM,UAAU,OAAO;AAC3B;AACO,SAAS,OAAO,KAAK;IACxB,IAAI,UAAU,QAAQ,OAAO,UAAU,YAAY,CAAC,MAAM,OAAO,CAAC,QAAQ;QACtE,OAAO;IACX;IACA,MAAM,UAAU,OAAO;AAC3B;AACO,SAAS,gBAAgB,KAAK,EAAE,GAAG;IACtC,OAAO,MAAM,OAAO,GAAG,CAAC,CAAC,YAAc,IAAI,OAAO;AACtD;AACA,SAAS,UAAU,KAAK,EAAE,QAAQ;IAC9B,IAAI,UAAU,WAAW;QACrB,OAAO,IAAI,yLAAU,CAAC,CAAC,SAAS,EAAE,SAAS,8BAA8B,CAAC;IAC9E;IACA,IAAI,WAAW,OAAO;IACtB,IAAI,UAAU,MAAM;QAChB,WAAW;IACf,OACK,IAAI,MAAM,OAAO,CAAC,QAAQ;QAC3B,WAAW;IACf;IACA,OAAO,IAAI,yLAAU,CAAC,CAAC,SAAS,EAAE,SAAS,WAAW,EAAE,UAAU;AACtE;AACO,SAAS,eAAe,KAAK,EAAE,GAAG;IACrC,OAAO,IAAI,OAAO;AACtB","ignoreList":[0]}},
    {"offset": {"line": 208, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/node_modules/@libsql/hrana-client/lib-esm/encoding/json/encode.js"],"sourcesContent":["export class ObjectWriter {\n    #output;\n    #isFirst;\n    constructor(output) {\n        this.#output = output;\n        this.#isFirst = false;\n    }\n    begin() {\n        this.#output.push('{');\n        this.#isFirst = true;\n    }\n    end() {\n        this.#output.push('}');\n        this.#isFirst = false;\n    }\n    #key(name) {\n        if (this.#isFirst) {\n            this.#output.push('\"');\n            this.#isFirst = false;\n        }\n        else {\n            this.#output.push(',\"');\n        }\n        this.#output.push(name);\n        this.#output.push('\":');\n    }\n    string(name, value) {\n        this.#key(name);\n        this.#output.push(JSON.stringify(value));\n    }\n    stringRaw(name, value) {\n        this.#key(name);\n        this.#output.push('\"');\n        this.#output.push(value);\n        this.#output.push('\"');\n    }\n    number(name, value) {\n        this.#key(name);\n        this.#output.push(\"\" + value);\n    }\n    boolean(name, value) {\n        this.#key(name);\n        this.#output.push(value ? \"true\" : \"false\");\n    }\n    object(name, value, valueFun) {\n        this.#key(name);\n        this.begin();\n        valueFun(this, value);\n        this.end();\n    }\n    arrayObjects(name, values, valueFun) {\n        this.#key(name);\n        this.#output.push('[');\n        for (let i = 0; i < values.length; ++i) {\n            if (i !== 0) {\n                this.#output.push(',');\n            }\n            this.begin();\n            valueFun(this, values[i]);\n            this.end();\n        }\n        this.#output.push(']');\n    }\n}\nexport function writeJsonObject(value, fun) {\n    const output = [];\n    const writer = new ObjectWriter(output);\n    writer.begin();\n    fun(writer, value);\n    writer.end();\n    return output.join(\"\");\n}\n"],"names":[],"mappings":";;;;;;AAAO,MAAM;IACT,CAAA,MAAO,CAAC;IACR,CAAA,OAAQ,CAAC;IACT,YAAY,MAAM,CAAE;QAChB,IAAI,CAAC,CAAA,MAAO,GAAG;QACf,IAAI,CAAC,CAAA,OAAQ,GAAG;IACpB;IACA,QAAQ;QACJ,IAAI,CAAC,CAAA,MAAO,CAAC,IAAI,CAAC;QAClB,IAAI,CAAC,CAAA,OAAQ,GAAG;IACpB;IACA,MAAM;QACF,IAAI,CAAC,CAAA,MAAO,CAAC,IAAI,CAAC;QAClB,IAAI,CAAC,CAAA,OAAQ,GAAG;IACpB;IACA,CAAA,GAAI,CAAC,IAAI;QACL,IAAI,IAAI,CAAC,CAAA,OAAQ,EAAE;YACf,IAAI,CAAC,CAAA,MAAO,CAAC,IAAI,CAAC;YAClB,IAAI,CAAC,CAAA,OAAQ,GAAG;QACpB,OACK;YACD,IAAI,CAAC,CAAA,MAAO,CAAC,IAAI,CAAC;QACtB;QACA,IAAI,CAAC,CAAA,MAAO,CAAC,IAAI,CAAC;QAClB,IAAI,CAAC,CAAA,MAAO,CAAC,IAAI,CAAC;IACtB;IACA,OAAO,IAAI,EAAE,KAAK,EAAE;QAChB,IAAI,CAAC,CAAA,GAAI,CAAC;QACV,IAAI,CAAC,CAAA,MAAO,CAAC,IAAI,CAAC,KAAK,SAAS,CAAC;IACrC;IACA,UAAU,IAAI,EAAE,KAAK,EAAE;QACnB,IAAI,CAAC,CAAA,GAAI,CAAC;QACV,IAAI,CAAC,CAAA,MAAO,CAAC,IAAI,CAAC;QAClB,IAAI,CAAC,CAAA,MAAO,CAAC,IAAI,CAAC;QAClB,IAAI,CAAC,CAAA,MAAO,CAAC,IAAI,CAAC;IACtB;IACA,OAAO,IAAI,EAAE,KAAK,EAAE;QAChB,IAAI,CAAC,CAAA,GAAI,CAAC;QACV,IAAI,CAAC,CAAA,MAAO,CAAC,IAAI,CAAC,KAAK;IAC3B;IACA,QAAQ,IAAI,EAAE,KAAK,EAAE;QACjB,IAAI,CAAC,CAAA,GAAI,CAAC;QACV,IAAI,CAAC,CAAA,MAAO,CAAC,IAAI,CAAC,QAAQ,SAAS;IACvC;IACA,OAAO,IAAI,EAAE,KAAK,EAAE,QAAQ,EAAE;QAC1B,IAAI,CAAC,CAAA,GAAI,CAAC;QACV,IAAI,CAAC,KAAK;QACV,SAAS,IAAI,EAAE;QACf,IAAI,CAAC,GAAG;IACZ;IACA,aAAa,IAAI,EAAE,MAAM,EAAE,QAAQ,EAAE;QACjC,IAAI,CAAC,CAAA,GAAI,CAAC;QACV,IAAI,CAAC,CAAA,MAAO,CAAC,IAAI,CAAC;QAClB,IAAK,IAAI,IAAI,GAAG,IAAI,OAAO,MAAM,EAAE,EAAE,EAAG;YACpC,IAAI,MAAM,GAAG;gBACT,IAAI,CAAC,CAAA,MAAO,CAAC,IAAI,CAAC;YACtB;YACA,IAAI,CAAC,KAAK;YACV,SAAS,IAAI,EAAE,MAAM,CAAC,EAAE;YACxB,IAAI,CAAC,GAAG;QACZ;QACA,IAAI,CAAC,CAAA,MAAO,CAAC,IAAI,CAAC;IACtB;AACJ;AACO,SAAS,gBAAgB,KAAK,EAAE,GAAG;IACtC,MAAM,SAAS,EAAE;IACjB,MAAM,SAAS,IAAI,aAAa;IAChC,OAAO,KAAK;IACZ,IAAI,QAAQ;IACZ,OAAO,GAAG;IACV,OAAO,OAAO,IAAI,CAAC;AACvB","ignoreList":[0]}},
    {"offset": {"line": 289, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/node_modules/@libsql/hrana-client/lib-esm/encoding/protobuf/util.js"],"sourcesContent":["export const VARINT = 0;\nexport const FIXED_64 = 1;\nexport const LENGTH_DELIMITED = 2;\nexport const GROUP_START = 3;\nexport const GROUP_END = 4;\nexport const FIXED_32 = 5;\n"],"names":[],"mappings":";;;;;;;;;;;;;;AAAO,MAAM,SAAS;AACf,MAAM,WAAW;AACjB,MAAM,mBAAmB;AACzB,MAAM,cAAc;AACpB,MAAM,YAAY;AAClB,MAAM,WAAW","ignoreList":[0]}},
    {"offset": {"line": 313, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/node_modules/@libsql/hrana-client/lib-esm/encoding/protobuf/decode.js"],"sourcesContent":["import { ProtoError } from \"../../errors.js\";\nimport { VARINT, FIXED_64, LENGTH_DELIMITED, FIXED_32 } from \"./util.js\";\nclass MessageReader {\n    #array;\n    #view;\n    #pos;\n    constructor(array) {\n        this.#array = array;\n        this.#view = new DataView(array.buffer, array.byteOffset, array.byteLength);\n        this.#pos = 0;\n    }\n    varint() {\n        let value = 0;\n        for (let shift = 0;; shift += 7) {\n            const byte = this.#array[this.#pos++];\n            value |= (byte & 0x7f) << shift;\n            if (!(byte & 0x80)) {\n                break;\n            }\n        }\n        return value;\n    }\n    varintBig() {\n        let value = 0n;\n        for (let shift = 0n;; shift += 7n) {\n            const byte = this.#array[this.#pos++];\n            value |= BigInt(byte & 0x7f) << shift;\n            if (!(byte & 0x80)) {\n                break;\n            }\n        }\n        return value;\n    }\n    bytes(length) {\n        const array = new Uint8Array(this.#array.buffer, this.#array.byteOffset + this.#pos, length);\n        this.#pos += length;\n        return array;\n    }\n    double() {\n        const value = this.#view.getFloat64(this.#pos, true);\n        this.#pos += 8;\n        return value;\n    }\n    skipVarint() {\n        for (;;) {\n            const byte = this.#array[this.#pos++];\n            if (!(byte & 0x80)) {\n                break;\n            }\n        }\n    }\n    skip(count) {\n        this.#pos += count;\n    }\n    eof() {\n        return this.#pos >= this.#array.byteLength;\n    }\n}\nexport class FieldReader {\n    #reader;\n    #wireType;\n    constructor(reader) {\n        this.#reader = reader;\n        this.#wireType = -1;\n    }\n    setup(wireType) {\n        this.#wireType = wireType;\n    }\n    #expect(expectedWireType) {\n        if (this.#wireType !== expectedWireType) {\n            throw new ProtoError(`Expected wire type ${expectedWireType}, got ${this.#wireType}`);\n        }\n        this.#wireType = -1;\n    }\n    bytes() {\n        this.#expect(LENGTH_DELIMITED);\n        const length = this.#reader.varint();\n        return this.#reader.bytes(length);\n    }\n    string() {\n        return new TextDecoder().decode(this.bytes());\n    }\n    message(def) {\n        return readProtobufMessage(this.bytes(), def);\n    }\n    int32() {\n        this.#expect(VARINT);\n        return this.#reader.varint();\n    }\n    uint32() {\n        return this.int32();\n    }\n    bool() {\n        return this.int32() !== 0;\n    }\n    uint64() {\n        this.#expect(VARINT);\n        return this.#reader.varintBig();\n    }\n    sint64() {\n        const value = this.uint64();\n        return (value >> 1n) ^ (-(value & 1n));\n    }\n    double() {\n        this.#expect(FIXED_64);\n        return this.#reader.double();\n    }\n    maybeSkip() {\n        if (this.#wireType < 0) {\n            return;\n        }\n        else if (this.#wireType === VARINT) {\n            this.#reader.skipVarint();\n        }\n        else if (this.#wireType === FIXED_64) {\n            this.#reader.skip(8);\n        }\n        else if (this.#wireType === LENGTH_DELIMITED) {\n            const length = this.#reader.varint();\n            this.#reader.skip(length);\n        }\n        else if (this.#wireType === FIXED_32) {\n            this.#reader.skip(4);\n        }\n        else {\n            throw new ProtoError(`Unexpected wire type ${this.#wireType}`);\n        }\n        this.#wireType = -1;\n    }\n}\nexport function readProtobufMessage(data, def) {\n    const msgReader = new MessageReader(data);\n    const fieldReader = new FieldReader(msgReader);\n    let value = def.default();\n    while (!msgReader.eof()) {\n        const key = msgReader.varint();\n        const tag = key >> 3;\n        const wireType = key & 0x7;\n        fieldReader.setup(wireType);\n        const tagFun = def[tag];\n        if (tagFun !== undefined) {\n            const returnedValue = tagFun(fieldReader, value);\n            if (returnedValue !== undefined) {\n                value = returnedValue;\n            }\n        }\n        fieldReader.maybeSkip();\n    }\n    return value;\n}\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 470, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/node_modules/@libsql/hrana-client/lib-esm/encoding/protobuf/encode.js"],"sourcesContent":["import { VARINT, FIXED_64, LENGTH_DELIMITED } from \"./util.js\";\nexport class MessageWriter {\n    #buf;\n    #array;\n    #view;\n    #pos;\n    constructor() {\n        this.#buf = new ArrayBuffer(256);\n        this.#array = new Uint8Array(this.#buf);\n        this.#view = new DataView(this.#buf);\n        this.#pos = 0;\n    }\n    #ensure(extra) {\n        if (this.#pos + extra <= this.#buf.byteLength) {\n            return;\n        }\n        let newCap = this.#buf.byteLength;\n        while (newCap < this.#pos + extra) {\n            newCap *= 2;\n        }\n        const newBuf = new ArrayBuffer(newCap);\n        const newArray = new Uint8Array(newBuf);\n        const newView = new DataView(newBuf);\n        newArray.set(new Uint8Array(this.#buf, 0, this.#pos));\n        this.#buf = newBuf;\n        this.#array = newArray;\n        this.#view = newView;\n    }\n    #varint(value) {\n        this.#ensure(5);\n        value = 0 | value;\n        do {\n            let byte = value & 0x7f;\n            value >>>= 7;\n            byte |= (value ? 0x80 : 0);\n            this.#array[this.#pos++] = byte;\n        } while (value);\n    }\n    #varintBig(value) {\n        this.#ensure(10);\n        value = value & 0xffffffffffffffffn;\n        do {\n            let byte = Number(value & 0x7fn);\n            value >>= 7n;\n            byte |= (value ? 0x80 : 0);\n            this.#array[this.#pos++] = byte;\n        } while (value);\n    }\n    #tag(tag, wireType) {\n        this.#varint((tag << 3) | wireType);\n    }\n    bytes(tag, value) {\n        this.#tag(tag, LENGTH_DELIMITED);\n        this.#varint(value.byteLength);\n        this.#ensure(value.byteLength);\n        this.#array.set(value, this.#pos);\n        this.#pos += value.byteLength;\n    }\n    string(tag, value) {\n        this.bytes(tag, new TextEncoder().encode(value));\n    }\n    message(tag, value, fun) {\n        const writer = new MessageWriter();\n        fun(writer, value);\n        this.bytes(tag, writer.data());\n    }\n    int32(tag, value) {\n        this.#tag(tag, VARINT);\n        this.#varint(value);\n    }\n    uint32(tag, value) {\n        this.int32(tag, value);\n    }\n    bool(tag, value) {\n        this.int32(tag, value ? 1 : 0);\n    }\n    sint64(tag, value) {\n        this.#tag(tag, VARINT);\n        this.#varintBig((value << 1n) ^ (value >> 63n));\n    }\n    double(tag, value) {\n        this.#tag(tag, FIXED_64);\n        this.#ensure(8);\n        this.#view.setFloat64(this.#pos, value, true);\n        this.#pos += 8;\n    }\n    data() {\n        return new Uint8Array(this.#buf, 0, this.#pos);\n    }\n}\nexport function writeProtobufMessage(value, fun) {\n    const w = new MessageWriter();\n    fun(w, value);\n    return w.data();\n}\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 576, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/node_modules/@libsql/hrana-client/lib-esm/encoding/index.js"],"sourcesContent":["export { readJsonObject } from \"./json/decode.js\";\nexport { writeJsonObject } from \"./json/encode.js\";\nexport { readProtobufMessage } from \"./protobuf/decode.js\";\nexport { writeProtobufMessage } from \"./protobuf/encode.js\";\n"],"names":[],"mappings":";AAAA;AACA;AACA;AACA","ignoreList":[0]}},
    {"offset": {"line": 589, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/node_modules/@libsql/hrana-client/lib-esm/id_alloc.js"],"sourcesContent":["import { InternalError } from \"./errors.js\";\n// An allocator of non-negative integer ids.\n//\n// This clever data structure has these \"ideal\" properties:\n// - It consumes memory proportional to the number of used ids (which is optimal).\n// - All operations are O(1) time.\n// - The allocated ids are small (with a slight modification, we could always provide the smallest possible\n// id).\nexport class IdAlloc {\n    // Set of all allocated ids\n    #usedIds;\n    // Set of all free ids lower than `#usedIds.size`\n    #freeIds;\n    constructor() {\n        this.#usedIds = new Set();\n        this.#freeIds = new Set();\n    }\n    // Returns an id that was free, and marks it as used.\n    alloc() {\n        // this \"loop\" is just a way to pick an arbitrary element from the `#freeIds` set\n        for (const freeId of this.#freeIds) {\n            this.#freeIds.delete(freeId);\n            this.#usedIds.add(freeId);\n            // maintain the invariant of `#freeIds`\n            if (!this.#usedIds.has(this.#usedIds.size - 1)) {\n                this.#freeIds.add(this.#usedIds.size - 1);\n            }\n            return freeId;\n        }\n        // the `#freeIds` set is empty, so there are no free ids lower than `#usedIds.size`\n        // this means that `#usedIds` is a set that contains all numbers from 0 to `#usedIds.size - 1`,\n        // so `#usedIds.size` is free\n        const freeId = this.#usedIds.size;\n        this.#usedIds.add(freeId);\n        return freeId;\n    }\n    free(id) {\n        if (!this.#usedIds.delete(id)) {\n            throw new InternalError(\"Freeing an id that is not allocated\");\n        }\n        // maintain the invariant of `#freeIds`\n        this.#freeIds.delete(this.#usedIds.size);\n        if (id < this.#usedIds.size) {\n            this.#freeIds.add(id);\n        }\n    }\n}\n"],"names":[],"mappings":";;;;AAAA;;AAQO,MAAM;IACT,2BAA2B;IAC3B,CAAA,OAAQ,CAAC;IACT,iDAAiD;IACjD,CAAA,OAAQ,CAAC;IACT,aAAc;QACV,IAAI,CAAC,CAAA,OAAQ,GAAG,IAAI;QACpB,IAAI,CAAC,CAAA,OAAQ,GAAG,IAAI;IACxB;IACA,qDAAqD;IACrD,QAAQ;QACJ,iFAAiF;QACjF,KAAK,MAAM,UAAU,IAAI,CAAC,CAAA,OAAQ,CAAE;YAChC,IAAI,CAAC,CAAA,OAAQ,CAAC,MAAM,CAAC;YACrB,IAAI,CAAC,CAAA,OAAQ,CAAC,GAAG,CAAC;YAClB,uCAAuC;YACvC,IAAI,CAAC,IAAI,CAAC,CAAA,OAAQ,CAAC,GAAG,CAAC,IAAI,CAAC,CAAA,OAAQ,CAAC,IAAI,GAAG,IAAI;gBAC5C,IAAI,CAAC,CAAA,OAAQ,CAAC,GAAG,CAAC,IAAI,CAAC,CAAA,OAAQ,CAAC,IAAI,GAAG;YAC3C;YACA,OAAO;QACX;QACA,mFAAmF;QACnF,+FAA+F;QAC/F,6BAA6B;QAC7B,MAAM,SAAS,IAAI,CAAC,CAAA,OAAQ,CAAC,IAAI;QACjC,IAAI,CAAC,CAAA,OAAQ,CAAC,GAAG,CAAC;QAClB,OAAO;IACX;IACA,KAAK,EAAE,EAAE;QACL,IAAI,CAAC,IAAI,CAAC,CAAA,OAAQ,CAAC,MAAM,CAAC,KAAK;YAC3B,MAAM,IAAI,4LAAa,CAAC;QAC5B;QACA,uCAAuC;QACvC,IAAI,CAAC,CAAA,OAAQ,CAAC,MAAM,CAAC,IAAI,CAAC,CAAA,OAAQ,CAAC,IAAI;QACvC,IAAI,KAAK,IAAI,CAAC,CAAA,OAAQ,CAAC,IAAI,EAAE;YACzB,IAAI,CAAC,CAAA,OAAQ,CAAC,GAAG,CAAC;QACtB;IACJ;AACJ","ignoreList":[0]}},
    {"offset": {"line": 638, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/node_modules/@libsql/hrana-client/lib-esm/util.js"],"sourcesContent":["import { InternalError } from \"./errors.js\";\nexport function impossible(value, message) {\n    throw new InternalError(message);\n}\n"],"names":[],"mappings":";;;;AAAA;;AACO,SAAS,WAAW,KAAK,EAAE,OAAO;IACrC,MAAM,IAAI,4LAAa,CAAC;AAC5B","ignoreList":[0]}},
    {"offset": {"line": 651, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/node_modules/@libsql/hrana-client/lib-esm/value.js"],"sourcesContent":["import { ProtoError, MisuseError } from \"./errors.js\";\nimport { impossible } from \"./util.js\";\nexport function valueToProto(value) {\n    if (value === null) {\n        return null;\n    }\n    else if (typeof value === \"string\") {\n        return value;\n    }\n    else if (typeof value === \"number\") {\n        if (!Number.isFinite(value)) {\n            throw new RangeError(\"Only finite numbers (not Infinity or NaN) can be passed as arguments\");\n        }\n        return value;\n    }\n    else if (typeof value === \"bigint\") {\n        if (value < minInteger || value > maxInteger) {\n            throw new RangeError(\"This bigint value is too large to be represented as a 64-bit integer and passed as argument\");\n        }\n        return value;\n    }\n    else if (typeof value === \"boolean\") {\n        return value ? 1n : 0n;\n    }\n    else if (value instanceof ArrayBuffer) {\n        return new Uint8Array(value);\n    }\n    else if (value instanceof Uint8Array) {\n        return value;\n    }\n    else if (value instanceof Date) {\n        return +value.valueOf();\n    }\n    else if (typeof value === \"object\") {\n        return \"\" + value.toString();\n    }\n    else {\n        throw new TypeError(\"Unsupported type of value\");\n    }\n}\nconst minInteger = -9223372036854775808n;\nconst maxInteger = 9223372036854775807n;\nexport function valueFromProto(value, intMode) {\n    if (value === null) {\n        return null;\n    }\n    else if (typeof value === \"number\") {\n        return value;\n    }\n    else if (typeof value === \"string\") {\n        return value;\n    }\n    else if (typeof value === \"bigint\") {\n        if (intMode === \"number\") {\n            const num = Number(value);\n            if (!Number.isSafeInteger(num)) {\n                throw new RangeError(\"Received integer which is too large to be safely represented as a JavaScript number\");\n            }\n            return num;\n        }\n        else if (intMode === \"bigint\") {\n            return value;\n        }\n        else if (intMode === \"string\") {\n            return \"\" + value;\n        }\n        else {\n            throw new MisuseError(\"Invalid value for IntMode\");\n        }\n    }\n    else if (value instanceof Uint8Array) {\n        // TODO: we need to copy data from `Uint8Array` to return an `ArrayBuffer`. Perhaps we should add a\n        // `blobMode` parameter, similar to `intMode`, which would allow the user to choose between receiving\n        // `ArrayBuffer` (default, convenient) and `Uint8Array` (zero copy)?\n        return value.slice().buffer;\n    }\n    else if (value === undefined) {\n        throw new ProtoError(\"Received unrecognized type of Value\");\n    }\n    else {\n        throw impossible(value, \"Impossible type of Value\");\n    }\n}\n"],"names":[],"mappings":";;;;;;AAAA;AACA;;;AACO,SAAS,aAAa,KAAK;IAC9B,IAAI,UAAU,MAAM;QAChB,OAAO;IACX,OACK,IAAI,OAAO,UAAU,UAAU;QAChC,OAAO;IACX,OACK,IAAI,OAAO,UAAU,UAAU;QAChC,IAAI,CAAC,OAAO,QAAQ,CAAC,QAAQ;YACzB,MAAM,IAAI,WAAW;QACzB;QACA,OAAO;IACX,OACK,IAAI,OAAO,UAAU,UAAU;QAChC,IAAI,QAAQ,cAAc,QAAQ,YAAY;YAC1C,MAAM,IAAI,WAAW;QACzB;QACA,OAAO;IACX,OACK,IAAI,OAAO,UAAU,WAAW;QACjC,OAAO,QAAQ,EAAE,GAAG,EAAE;IAC1B,OACK,IAAI,iBAAiB,aAAa;QACnC,OAAO,IAAI,WAAW;IAC1B,OACK,IAAI,iBAAiB,YAAY;QAClC,OAAO;IACX,OACK,IAAI,iBAAiB,MAAM;QAC5B,OAAO,CAAC,MAAM,OAAO;IACzB,OACK,IAAI,OAAO,UAAU,UAAU;QAChC,OAAO,KAAK,MAAM,QAAQ;IAC9B,OACK;QACD,MAAM,IAAI,UAAU;IACxB;AACJ;AACA,MAAM,aAAa,CAAC,oBAAoB;AACxC,MAAM,aAAa,oBAAoB;AAChC,SAAS,eAAe,KAAK,EAAE,OAAO;IACzC,IAAI,UAAU,MAAM;QAChB,OAAO;IACX,OACK,IAAI,OAAO,UAAU,UAAU;QAChC,OAAO;IACX,OACK,IAAI,OAAO,UAAU,UAAU;QAChC,OAAO;IACX,OACK,IAAI,OAAO,UAAU,UAAU;QAChC,IAAI,YAAY,UAAU;YACtB,MAAM,MAAM,OAAO;YACnB,IAAI,CAAC,OAAO,aAAa,CAAC,MAAM;gBAC5B,MAAM,IAAI,WAAW;YACzB;YACA,OAAO;QACX,OACK,IAAI,YAAY,UAAU;YAC3B,OAAO;QACX,OACK,IAAI,YAAY,UAAU;YAC3B,OAAO,KAAK;QAChB,OACK;YACD,MAAM,IAAI,0LAAW,CAAC;QAC1B;IACJ,OACK,IAAI,iBAAiB,YAAY;QAClC,mGAAmG;QACnG,qGAAqG;QACrG,oEAAoE;QACpE,OAAO,MAAM,KAAK,GAAG,MAAM;IAC/B,OACK,IAAI,UAAU,WAAW;QAC1B,MAAM,IAAI,yLAAU,CAAC;IACzB,OACK;QACD,MAAM,IAAA,uLAAU,EAAC,OAAO;IAC5B;AACJ","ignoreList":[0]}},
    {"offset": {"line": 728, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/node_modules/@libsql/hrana-client/lib-esm/result.js"],"sourcesContent":["import { ResponseError } from \"./errors.js\";\nimport { valueFromProto } from \"./value.js\";\nexport function stmtResultFromProto(result) {\n    return {\n        affectedRowCount: result.affectedRowCount,\n        lastInsertRowid: result.lastInsertRowid,\n        columnNames: result.cols.map(col => col.name),\n        columnDecltypes: result.cols.map(col => col.decltype),\n    };\n}\nexport function rowsResultFromProto(result, intMode) {\n    const stmtResult = stmtResultFromProto(result);\n    const rows = result.rows.map(row => rowFromProto(stmtResult.columnNames, row, intMode));\n    return { ...stmtResult, rows };\n}\nexport function rowResultFromProto(result, intMode) {\n    const stmtResult = stmtResultFromProto(result);\n    let row;\n    if (result.rows.length > 0) {\n        row = rowFromProto(stmtResult.columnNames, result.rows[0], intMode);\n    }\n    return { ...stmtResult, row };\n}\nexport function valueResultFromProto(result, intMode) {\n    const stmtResult = stmtResultFromProto(result);\n    let value;\n    if (result.rows.length > 0 && stmtResult.columnNames.length > 0) {\n        value = valueFromProto(result.rows[0][0], intMode);\n    }\n    return { ...stmtResult, value };\n}\nfunction rowFromProto(colNames, values, intMode) {\n    const row = {};\n    // make sure that the \"length\" property is not enumerable\n    Object.defineProperty(row, \"length\", { value: values.length });\n    for (let i = 0; i < values.length; ++i) {\n        const value = valueFromProto(values[i], intMode);\n        Object.defineProperty(row, i, { value });\n        const colName = colNames[i];\n        if (colName !== undefined && !Object.hasOwn(row, colName)) {\n            Object.defineProperty(row, colName, { value, enumerable: true, configurable: true, writable: true });\n        }\n    }\n    return row;\n}\nexport function errorFromProto(error) {\n    return new ResponseError(error.message, error);\n}\n"],"names":[],"mappings":";;;;;;;;;;;;AAAA;AACA;;;AACO,SAAS,oBAAoB,MAAM;IACtC,OAAO;QACH,kBAAkB,OAAO,gBAAgB;QACzC,iBAAiB,OAAO,eAAe;QACvC,aAAa,OAAO,IAAI,CAAC,GAAG,CAAC,CAAA,MAAO,IAAI,IAAI;QAC5C,iBAAiB,OAAO,IAAI,CAAC,GAAG,CAAC,CAAA,MAAO,IAAI,QAAQ;IACxD;AACJ;AACO,SAAS,oBAAoB,MAAM,EAAE,OAAO;IAC/C,MAAM,aAAa,oBAAoB;IACvC,MAAM,OAAO,OAAO,IAAI,CAAC,GAAG,CAAC,CAAA,MAAO,aAAa,WAAW,WAAW,EAAE,KAAK;IAC9E,OAAO;QAAE,GAAG,UAAU;QAAE;IAAK;AACjC;AACO,SAAS,mBAAmB,MAAM,EAAE,OAAO;IAC9C,MAAM,aAAa,oBAAoB;IACvC,IAAI;IACJ,IAAI,OAAO,IAAI,CAAC,MAAM,GAAG,GAAG;QACxB,MAAM,aAAa,WAAW,WAAW,EAAE,OAAO,IAAI,CAAC,EAAE,EAAE;IAC/D;IACA,OAAO;QAAE,GAAG,UAAU;QAAE;IAAI;AAChC;AACO,SAAS,qBAAqB,MAAM,EAAE,OAAO;IAChD,MAAM,aAAa,oBAAoB;IACvC,IAAI;IACJ,IAAI,OAAO,IAAI,CAAC,MAAM,GAAG,KAAK,WAAW,WAAW,CAAC,MAAM,GAAG,GAAG;QAC7D,QAAQ,IAAA,4LAAc,EAAC,OAAO,IAAI,CAAC,EAAE,CAAC,EAAE,EAAE;IAC9C;IACA,OAAO;QAAE,GAAG,UAAU;QAAE;IAAM;AAClC;AACA,SAAS,aAAa,QAAQ,EAAE,MAAM,EAAE,OAAO;IAC3C,MAAM,MAAM,CAAC;IACb,yDAAyD;IACzD,OAAO,cAAc,CAAC,KAAK,UAAU;QAAE,OAAO,OAAO,MAAM;IAAC;IAC5D,IAAK,IAAI,IAAI,GAAG,IAAI,OAAO,MAAM,EAAE,EAAE,EAAG;QACpC,MAAM,QAAQ,IAAA,4LAAc,EAAC,MAAM,CAAC,EAAE,EAAE;QACxC,OAAO,cAAc,CAAC,KAAK,GAAG;YAAE;QAAM;QACtC,MAAM,UAAU,QAAQ,CAAC,EAAE;QAC3B,IAAI,YAAY,aAAa,CAAC,OAAO,MAAM,CAAC,KAAK,UAAU;YACvD,OAAO,cAAc,CAAC,KAAK,SAAS;gBAAE;gBAAO,YAAY;gBAAM,cAAc;gBAAM,UAAU;YAAK;QACtG;IACJ;IACA,OAAO;AACX;AACO,SAAS,eAAe,KAAK;IAChC,OAAO,IAAI,4LAAa,CAAC,MAAM,OAAO,EAAE;AAC5C","ignoreList":[0]}},
    {"offset": {"line": 812, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/node_modules/@libsql/hrana-client/lib-esm/sql.js"],"sourcesContent":["import { ClientError, ClosedError, MisuseError } from \"./errors.js\";\n/** Text of an SQL statement cached on the server. */\nexport class Sql {\n    #owner;\n    #sqlId;\n    #closed;\n    /** @private */\n    constructor(owner, sqlId) {\n        this.#owner = owner;\n        this.#sqlId = sqlId;\n        this.#closed = undefined;\n    }\n    /** @private */\n    _getSqlId(owner) {\n        if (this.#owner !== owner) {\n            throw new MisuseError(\"Attempted to use SQL text opened with other object\");\n        }\n        else if (this.#closed !== undefined) {\n            throw new ClosedError(\"SQL text is closed\", this.#closed);\n        }\n        return this.#sqlId;\n    }\n    /** Remove the SQL text from the server, releasing resouces. */\n    close() {\n        this._setClosed(new ClientError(\"SQL text was manually closed\"));\n    }\n    /** @private */\n    _setClosed(error) {\n        if (this.#closed === undefined) {\n            this.#closed = error;\n            this.#owner._closeSql(this.#sqlId);\n        }\n    }\n    /** True if the SQL text is closed (removed from the server). */\n    get closed() {\n        return this.#closed !== undefined;\n    }\n}\nexport function sqlToProto(owner, sql) {\n    if (sql instanceof Sql) {\n        return { sqlId: sql._getSqlId(owner) };\n    }\n    else {\n        return { sql: \"\" + sql };\n    }\n}\n"],"names":[],"mappings":";;;;;;AAAA;;AAEO,MAAM;IACT,CAAA,KAAM,CAAC;IACP,CAAA,KAAM,CAAC;IACP,CAAA,MAAO,CAAC;IACR,aAAa,GACb,YAAY,KAAK,EAAE,KAAK,CAAE;QACtB,IAAI,CAAC,CAAA,KAAM,GAAG;QACd,IAAI,CAAC,CAAA,KAAM,GAAG;QACd,IAAI,CAAC,CAAA,MAAO,GAAG;IACnB;IACA,aAAa,GACb,UAAU,KAAK,EAAE;QACb,IAAI,IAAI,CAAC,CAAA,KAAM,KAAK,OAAO;YACvB,MAAM,IAAI,0LAAW,CAAC;QAC1B,OACK,IAAI,IAAI,CAAC,CAAA,MAAO,KAAK,WAAW;YACjC,MAAM,IAAI,0LAAW,CAAC,sBAAsB,IAAI,CAAC,CAAA,MAAO;QAC5D;QACA,OAAO,IAAI,CAAC,CAAA,KAAM;IACtB;IACA,6DAA6D,GAC7D,QAAQ;QACJ,IAAI,CAAC,UAAU,CAAC,IAAI,0LAAW,CAAC;IACpC;IACA,aAAa,GACb,WAAW,KAAK,EAAE;QACd,IAAI,IAAI,CAAC,CAAA,MAAO,KAAK,WAAW;YAC5B,IAAI,CAAC,CAAA,MAAO,GAAG;YACf,IAAI,CAAC,CAAA,KAAM,CAAC,SAAS,CAAC,IAAI,CAAC,CAAA,KAAM;QACrC;IACJ;IACA,8DAA8D,GAC9D,IAAI,SAAS;QACT,OAAO,IAAI,CAAC,CAAA,MAAO,KAAK;IAC5B;AACJ;AACO,SAAS,WAAW,KAAK,EAAE,GAAG;IACjC,IAAI,eAAe,KAAK;QACpB,OAAO;YAAE,OAAO,IAAI,SAAS,CAAC;QAAO;IACzC,OACK;QACD,OAAO;YAAE,KAAK,KAAK;QAAI;IAC3B;AACJ","ignoreList":[0]}},
    {"offset": {"line": 865, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/node_modules/@libsql/hrana-client/lib-esm/queue.js"],"sourcesContent":["export class Queue {\n    #pushStack;\n    #shiftStack;\n    constructor() {\n        this.#pushStack = [];\n        this.#shiftStack = [];\n    }\n    get length() {\n        return this.#pushStack.length + this.#shiftStack.length;\n    }\n    push(elem) {\n        this.#pushStack.push(elem);\n    }\n    shift() {\n        if (this.#shiftStack.length === 0 && this.#pushStack.length > 0) {\n            this.#shiftStack = this.#pushStack.reverse();\n            this.#pushStack = [];\n        }\n        return this.#shiftStack.pop();\n    }\n    first() {\n        return this.#shiftStack.length !== 0\n            ? this.#shiftStack[this.#shiftStack.length - 1]\n            : this.#pushStack[0];\n    }\n}\n"],"names":[],"mappings":";;;;AAAO,MAAM;IACT,CAAA,SAAU,CAAC;IACX,CAAA,UAAW,CAAC;IACZ,aAAc;QACV,IAAI,CAAC,CAAA,SAAU,GAAG,EAAE;QACpB,IAAI,CAAC,CAAA,UAAW,GAAG,EAAE;IACzB;IACA,IAAI,SAAS;QACT,OAAO,IAAI,CAAC,CAAA,SAAU,CAAC,MAAM,GAAG,IAAI,CAAC,CAAA,UAAW,CAAC,MAAM;IAC3D;IACA,KAAK,IAAI,EAAE;QACP,IAAI,CAAC,CAAA,SAAU,CAAC,IAAI,CAAC;IACzB;IACA,QAAQ;QACJ,IAAI,IAAI,CAAC,CAAA,UAAW,CAAC,MAAM,KAAK,KAAK,IAAI,CAAC,CAAA,SAAU,CAAC,MAAM,GAAG,GAAG;YAC7D,IAAI,CAAC,CAAA,UAAW,GAAG,IAAI,CAAC,CAAA,SAAU,CAAC,OAAO;YAC1C,IAAI,CAAC,CAAA,SAAU,GAAG,EAAE;QACxB;QACA,OAAO,IAAI,CAAC,CAAA,UAAW,CAAC,GAAG;IAC/B;IACA,QAAQ;QACJ,OAAO,IAAI,CAAC,CAAA,UAAW,CAAC,MAAM,KAAK,IAC7B,IAAI,CAAC,CAAA,UAAW,CAAC,IAAI,CAAC,CAAA,UAAW,CAAC,MAAM,GAAG,EAAE,GAC7C,IAAI,CAAC,CAAA,SAAU,CAAC,EAAE;IAC5B;AACJ","ignoreList":[0]}},
    {"offset": {"line": 897, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/node_modules/@libsql/hrana-client/lib-esm/stmt.js"],"sourcesContent":["import { sqlToProto } from \"./sql.js\";\nimport { valueToProto } from \"./value.js\";\n/** A statement that can be evaluated by the database. Besides the SQL text, it also contains the positional\n * and named arguments. */\nexport class Stmt {\n    /** The SQL statement text. */\n    sql;\n    /** @private */\n    _args;\n    /** @private */\n    _namedArgs;\n    /** Initialize the statement with given SQL text. */\n    constructor(sql) {\n        this.sql = sql;\n        this._args = [];\n        this._namedArgs = new Map();\n    }\n    /** Binds positional parameters from the given `values`. All previous positional bindings are cleared. */\n    bindIndexes(values) {\n        this._args.length = 0;\n        for (const value of values) {\n            this._args.push(valueToProto(value));\n        }\n        return this;\n    }\n    /** Binds a parameter by a 1-based index. */\n    bindIndex(index, value) {\n        if (index !== (index | 0) || index <= 0) {\n            throw new RangeError(\"Index of a positional argument must be positive integer\");\n        }\n        while (this._args.length < index) {\n            this._args.push(null);\n        }\n        this._args[index - 1] = valueToProto(value);\n        return this;\n    }\n    /** Binds a parameter by name. */\n    bindName(name, value) {\n        this._namedArgs.set(name, valueToProto(value));\n        return this;\n    }\n    /** Clears all bindings. */\n    unbindAll() {\n        this._args.length = 0;\n        this._namedArgs.clear();\n        return this;\n    }\n}\nexport function stmtToProto(sqlOwner, stmt, wantRows) {\n    let inSql;\n    let args = [];\n    let namedArgs = [];\n    if (stmt instanceof Stmt) {\n        inSql = stmt.sql;\n        args = stmt._args;\n        for (const [name, value] of stmt._namedArgs.entries()) {\n            namedArgs.push({ name, value });\n        }\n    }\n    else if (Array.isArray(stmt)) {\n        inSql = stmt[0];\n        if (Array.isArray(stmt[1])) {\n            args = stmt[1].map((arg) => valueToProto(arg));\n        }\n        else {\n            namedArgs = Object.entries(stmt[1]).map(([name, value]) => {\n                return { name, value: valueToProto(value) };\n            });\n        }\n    }\n    else {\n        inSql = stmt;\n    }\n    const { sql, sqlId } = sqlToProto(sqlOwner, inSql);\n    return { sql, sqlId, args, namedArgs, wantRows };\n}\n"],"names":[],"mappings":";;;;;;AAAA;AACA;;;AAGO,MAAM;IACT,4BAA4B,GAC5B,IAAI;IACJ,aAAa,GACb,MAAM;IACN,aAAa,GACb,WAAW;IACX,kDAAkD,GAClD,YAAY,GAAG,CAAE;QACb,IAAI,CAAC,GAAG,GAAG;QACX,IAAI,CAAC,KAAK,GAAG,EAAE;QACf,IAAI,CAAC,UAAU,GAAG,IAAI;IAC1B;IACA,uGAAuG,GACvG,YAAY,MAAM,EAAE;QAChB,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG;QACpB,KAAK,MAAM,SAAS,OAAQ;YACxB,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,IAAA,0LAAY,EAAC;QACjC;QACA,OAAO,IAAI;IACf;IACA,0CAA0C,GAC1C,UAAU,KAAK,EAAE,KAAK,EAAE;QACpB,IAAI,UAAU,CAAC,QAAQ,CAAC,KAAK,SAAS,GAAG;YACrC,MAAM,IAAI,WAAW;QACzB;QACA,MAAO,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG,MAAO;YAC9B,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC;QACpB;QACA,IAAI,CAAC,KAAK,CAAC,QAAQ,EAAE,GAAG,IAAA,0LAAY,EAAC;QACrC,OAAO,IAAI;IACf;IACA,+BAA+B,GAC/B,SAAS,IAAI,EAAE,KAAK,EAAE;QAClB,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,MAAM,IAAA,0LAAY,EAAC;QACvC,OAAO,IAAI;IACf;IACA,yBAAyB,GACzB,YAAY;QACR,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG;QACpB,IAAI,CAAC,UAAU,CAAC,KAAK;QACrB,OAAO,IAAI;IACf;AACJ;AACO,SAAS,YAAY,QAAQ,EAAE,IAAI,EAAE,QAAQ;IAChD,IAAI;IACJ,IAAI,OAAO,EAAE;IACb,IAAI,YAAY,EAAE;IAClB,IAAI,gBAAgB,MAAM;QACtB,QAAQ,KAAK,GAAG;QAChB,OAAO,KAAK,KAAK;QACjB,KAAK,MAAM,CAAC,MAAM,MAAM,IAAI,KAAK,UAAU,CAAC,OAAO,GAAI;YACnD,UAAU,IAAI,CAAC;gBAAE;gBAAM;YAAM;QACjC;IACJ,OACK,IAAI,MAAM,OAAO,CAAC,OAAO;QAC1B,QAAQ,IAAI,CAAC,EAAE;QACf,IAAI,MAAM,OAAO,CAAC,IAAI,CAAC,EAAE,GAAG;YACxB,OAAO,IAAI,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC,MAAQ,IAAA,0LAAY,EAAC;QAC7C,OACK;YACD,YAAY,OAAO,OAAO,CAAC,IAAI,CAAC,EAAE,EAAE,GAAG,CAAC,CAAC,CAAC,MAAM,MAAM;gBAClD,OAAO;oBAAE;oBAAM,OAAO,IAAA,0LAAY,EAAC;gBAAO;YAC9C;QACJ;IACJ,OACK;QACD,QAAQ;IACZ;IACA,MAAM,EAAE,GAAG,EAAE,KAAK,EAAE,GAAG,IAAA,sLAAU,EAAC,UAAU;IAC5C,OAAO;QAAE;QAAK;QAAO;QAAM;QAAW;IAAS;AACnD","ignoreList":[0]}},
    {"offset": {"line": 984, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/node_modules/@libsql/hrana-client/lib-esm/batch.js"],"sourcesContent":["import { ProtoError, MisuseError } from \"./errors.js\";\nimport { stmtResultFromProto, rowsResultFromProto, rowResultFromProto, valueResultFromProto, errorFromProto, } from \"./result.js\";\nimport { stmtToProto } from \"./stmt.js\";\nimport { impossible } from \"./util.js\";\n/** A builder for creating a batch and executing it on the server. */\nexport class Batch {\n    /** @private */\n    _stream;\n    #useCursor;\n    /** @private */\n    _steps;\n    #executed;\n    /** @private */\n    constructor(stream, useCursor) {\n        this._stream = stream;\n        this.#useCursor = useCursor;\n        this._steps = [];\n        this.#executed = false;\n    }\n    /** Return a builder for adding a step to the batch. */\n    step() {\n        return new BatchStep(this);\n    }\n    /** Execute the batch. */\n    execute() {\n        if (this.#executed) {\n            throw new MisuseError(\"This batch has already been executed\");\n        }\n        this.#executed = true;\n        const batch = {\n            steps: this._steps.map((step) => step.proto),\n        };\n        if (this.#useCursor) {\n            return executeCursor(this._stream, this._steps, batch);\n        }\n        else {\n            return executeRegular(this._stream, this._steps, batch);\n        }\n    }\n}\nfunction executeRegular(stream, steps, batch) {\n    return stream._batch(batch).then((result) => {\n        for (let step = 0; step < steps.length; ++step) {\n            const stepResult = result.stepResults.get(step);\n            const stepError = result.stepErrors.get(step);\n            steps[step].callback(stepResult, stepError);\n        }\n    });\n}\nasync function executeCursor(stream, steps, batch) {\n    const cursor = await stream._openCursor(batch);\n    try {\n        let nextStep = 0;\n        let beginEntry = undefined;\n        let rows = [];\n        for (;;) {\n            const entry = await cursor.next();\n            if (entry === undefined) {\n                break;\n            }\n            if (entry.type === \"step_begin\") {\n                if (entry.step < nextStep || entry.step >= steps.length) {\n                    throw new ProtoError(\"Server produced StepBeginEntry for unexpected step\");\n                }\n                else if (beginEntry !== undefined) {\n                    throw new ProtoError(\"Server produced StepBeginEntry before terminating previous step\");\n                }\n                for (let step = nextStep; step < entry.step; ++step) {\n                    steps[step].callback(undefined, undefined);\n                }\n                nextStep = entry.step + 1;\n                beginEntry = entry;\n                rows = [];\n            }\n            else if (entry.type === \"step_end\") {\n                if (beginEntry === undefined) {\n                    throw new ProtoError(\"Server produced StepEndEntry but no step is active\");\n                }\n                const stmtResult = {\n                    cols: beginEntry.cols,\n                    rows,\n                    affectedRowCount: entry.affectedRowCount,\n                    lastInsertRowid: entry.lastInsertRowid,\n                };\n                steps[beginEntry.step].callback(stmtResult, undefined);\n                beginEntry = undefined;\n                rows = [];\n            }\n            else if (entry.type === \"step_error\") {\n                if (beginEntry === undefined) {\n                    if (entry.step >= steps.length) {\n                        throw new ProtoError(\"Server produced StepErrorEntry for unexpected step\");\n                    }\n                    for (let step = nextStep; step < entry.step; ++step) {\n                        steps[step].callback(undefined, undefined);\n                    }\n                }\n                else {\n                    if (entry.step !== beginEntry.step) {\n                        throw new ProtoError(\"Server produced StepErrorEntry for unexpected step\");\n                    }\n                    beginEntry = undefined;\n                    rows = [];\n                }\n                steps[entry.step].callback(undefined, entry.error);\n                nextStep = entry.step + 1;\n            }\n            else if (entry.type === \"row\") {\n                if (beginEntry === undefined) {\n                    throw new ProtoError(\"Server produced RowEntry but no step is active\");\n                }\n                rows.push(entry.row);\n            }\n            else if (entry.type === \"error\") {\n                throw errorFromProto(entry.error);\n            }\n            else if (entry.type === \"none\") {\n                throw new ProtoError(\"Server produced unrecognized CursorEntry\");\n            }\n            else {\n                throw impossible(entry, \"Impossible CursorEntry\");\n            }\n        }\n        if (beginEntry !== undefined) {\n            throw new ProtoError(\"Server closed Cursor before terminating active step\");\n        }\n        for (let step = nextStep; step < steps.length; ++step) {\n            steps[step].callback(undefined, undefined);\n        }\n    }\n    finally {\n        cursor.close();\n    }\n}\n/** A builder for adding a step to the batch. */\nexport class BatchStep {\n    /** @private */\n    _batch;\n    #conds;\n    /** @private */\n    _index;\n    /** @private */\n    constructor(batch) {\n        this._batch = batch;\n        this.#conds = [];\n        this._index = undefined;\n    }\n    /** Add the condition that needs to be satisfied to execute the statement. If you use this method multiple\n     * times, we join the conditions with a logical AND. */\n    condition(cond) {\n        this.#conds.push(cond._proto);\n        return this;\n    }\n    /** Add a statement that returns rows. */\n    query(stmt) {\n        return this.#add(stmt, true, rowsResultFromProto);\n    }\n    /** Add a statement that returns at most a single row. */\n    queryRow(stmt) {\n        return this.#add(stmt, true, rowResultFromProto);\n    }\n    /** Add a statement that returns at most a single value. */\n    queryValue(stmt) {\n        return this.#add(stmt, true, valueResultFromProto);\n    }\n    /** Add a statement without returning rows. */\n    run(stmt) {\n        return this.#add(stmt, false, stmtResultFromProto);\n    }\n    #add(inStmt, wantRows, fromProto) {\n        if (this._index !== undefined) {\n            throw new MisuseError(\"This BatchStep has already been added to the batch\");\n        }\n        const stmt = stmtToProto(this._batch._stream._sqlOwner(), inStmt, wantRows);\n        let condition;\n        if (this.#conds.length === 0) {\n            condition = undefined;\n        }\n        else if (this.#conds.length === 1) {\n            condition = this.#conds[0];\n        }\n        else {\n            condition = { type: \"and\", conds: this.#conds.slice() };\n        }\n        const proto = { stmt, condition };\n        return new Promise((outputCallback, errorCallback) => {\n            const callback = (stepResult, stepError) => {\n                if (stepResult !== undefined && stepError !== undefined) {\n                    errorCallback(new ProtoError(\"Server returned both result and error\"));\n                }\n                else if (stepError !== undefined) {\n                    errorCallback(errorFromProto(stepError));\n                }\n                else if (stepResult !== undefined) {\n                    outputCallback(fromProto(stepResult, this._batch._stream.intMode));\n                }\n                else {\n                    outputCallback(undefined);\n                }\n            };\n            this._index = this._batch._steps.length;\n            this._batch._steps.push({ proto, callback });\n        });\n    }\n}\nexport class BatchCond {\n    /** @private */\n    _batch;\n    /** @private */\n    _proto;\n    /** @private */\n    constructor(batch, proto) {\n        this._batch = batch;\n        this._proto = proto;\n    }\n    /** Create a condition that evaluates to true when the given step executes successfully.\n     *\n     * If the given step fails error or is skipped because its condition evaluated to false, this\n     * condition evaluates to false.\n     */\n    static ok(step) {\n        return new BatchCond(step._batch, { type: \"ok\", step: stepIndex(step) });\n    }\n    /** Create a condition that evaluates to true when the given step fails.\n     *\n     * If the given step succeeds or is skipped because its condition evaluated to false, this condition\n     * evaluates to false.\n     */\n    static error(step) {\n        return new BatchCond(step._batch, { type: \"error\", step: stepIndex(step) });\n    }\n    /** Create a condition that is a logical negation of another condition.\n     */\n    static not(cond) {\n        return new BatchCond(cond._batch, { type: \"not\", cond: cond._proto });\n    }\n    /** Create a condition that is a logical AND of other conditions.\n     */\n    static and(batch, conds) {\n        for (const cond of conds) {\n            checkCondBatch(batch, cond);\n        }\n        return new BatchCond(batch, { type: \"and\", conds: conds.map(e => e._proto) });\n    }\n    /** Create a condition that is a logical OR of other conditions.\n     */\n    static or(batch, conds) {\n        for (const cond of conds) {\n            checkCondBatch(batch, cond);\n        }\n        return new BatchCond(batch, { type: \"or\", conds: conds.map(e => e._proto) });\n    }\n    /** Create a condition that evaluates to true when the SQL connection is in autocommit mode (not inside an\n     * explicit transaction). This requires protocol version 3 or higher.\n     */\n    static isAutocommit(batch) {\n        batch._stream.client()._ensureVersion(3, \"BatchCond.isAutocommit()\");\n        return new BatchCond(batch, { type: \"is_autocommit\" });\n    }\n}\nfunction stepIndex(step) {\n    if (step._index === undefined) {\n        throw new MisuseError(\"Cannot add a condition referencing a step that has not been added to the batch\");\n    }\n    return step._index;\n}\nfunction checkCondBatch(expectedBatch, cond) {\n    if (cond._batch !== expectedBatch) {\n        throw new MisuseError(\"Cannot mix BatchCond objects for different Batch objects\");\n    }\n}\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 1258, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/node_modules/@libsql/hrana-client/lib-esm/describe.js"],"sourcesContent":["export function describeResultFromProto(result) {\n    return {\n        paramNames: result.params.map((p) => p.name),\n        columns: result.cols,\n        isExplain: result.isExplain,\n        isReadonly: result.isReadonly,\n    };\n}\n"],"names":[],"mappings":";;;;AAAO,SAAS,wBAAwB,MAAM;IAC1C,OAAO;QACH,YAAY,OAAO,MAAM,CAAC,GAAG,CAAC,CAAC,IAAM,EAAE,IAAI;QAC3C,SAAS,OAAO,IAAI;QACpB,WAAW,OAAO,SAAS;QAC3B,YAAY,OAAO,UAAU;IACjC;AACJ","ignoreList":[0]}},
    {"offset": {"line": 1274, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/node_modules/@libsql/hrana-client/lib-esm/stream.js"],"sourcesContent":["import { Batch } from \"./batch.js\";\nimport { describeResultFromProto } from \"./describe.js\";\nimport { stmtResultFromProto, rowsResultFromProto, rowResultFromProto, valueResultFromProto, } from \"./result.js\";\nimport { sqlToProto } from \"./sql.js\";\nimport { stmtToProto } from \"./stmt.js\";\n/** A stream for executing SQL statements (a \"database connection\"). */\nexport class Stream {\n    /** @private */\n    constructor(intMode) {\n        this.intMode = intMode;\n    }\n    /** Execute a statement and return rows. */\n    query(stmt) {\n        return this.#execute(stmt, true, rowsResultFromProto);\n    }\n    /** Execute a statement and return at most a single row. */\n    queryRow(stmt) {\n        return this.#execute(stmt, true, rowResultFromProto);\n    }\n    /** Execute a statement and return at most a single value. */\n    queryValue(stmt) {\n        return this.#execute(stmt, true, valueResultFromProto);\n    }\n    /** Execute a statement without returning rows. */\n    run(stmt) {\n        return this.#execute(stmt, false, stmtResultFromProto);\n    }\n    #execute(inStmt, wantRows, fromProto) {\n        const stmt = stmtToProto(this._sqlOwner(), inStmt, wantRows);\n        return this._execute(stmt).then((r) => fromProto(r, this.intMode));\n    }\n    /** Return a builder for creating and executing a batch.\n     *\n     * If `useCursor` is true, the batch will be executed using a Hrana cursor, which will stream results from\n     * the server to the client, which consumes less memory on the server. This requires protocol version 3 or\n     * higher.\n     */\n    batch(useCursor = false) {\n        return new Batch(this, useCursor);\n    }\n    /** Parse and analyze a statement. This requires protocol version 2 or higher. */\n    describe(inSql) {\n        const protoSql = sqlToProto(this._sqlOwner(), inSql);\n        return this._describe(protoSql).then(describeResultFromProto);\n    }\n    /** Execute a sequence of statements separated by semicolons. This requires protocol version 2 or higher.\n     * */\n    sequence(inSql) {\n        const protoSql = sqlToProto(this._sqlOwner(), inSql);\n        return this._sequence(protoSql);\n    }\n    /** Representation of integers returned from the database. See {@link IntMode}.\n     *\n     * This value affects the results of all operations on this stream.\n     */\n    intMode;\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;AACA;;;;;;AAEO,MAAM;IACT,aAAa,GACb,YAAY,OAAO,CAAE;QACjB,IAAI,CAAC,OAAO,GAAG;IACnB;IACA,yCAAyC,GACzC,MAAM,IAAI,EAAE;QACR,OAAO,IAAI,CAAC,CAAA,OAAQ,CAAC,MAAM,MAAM,kMAAmB;IACxD;IACA,yDAAyD,GACzD,SAAS,IAAI,EAAE;QACX,OAAO,IAAI,CAAC,CAAA,OAAQ,CAAC,MAAM,MAAM,iMAAkB;IACvD;IACA,2DAA2D,GAC3D,WAAW,IAAI,EAAE;QACb,OAAO,IAAI,CAAC,CAAA,OAAQ,CAAC,MAAM,MAAM,mMAAoB;IACzD;IACA,gDAAgD,GAChD,IAAI,IAAI,EAAE;QACN,OAAO,IAAI,CAAC,CAAA,OAAQ,CAAC,MAAM,OAAO,kMAAmB;IACzD;IACA,CAAA,OAAQ,CAAC,MAAM,EAAE,QAAQ,EAAE,SAAS;QAChC,MAAM,OAAO,IAAA,wLAAW,EAAC,IAAI,CAAC,SAAS,IAAI,QAAQ;QACnD,OAAO,IAAI,CAAC,QAAQ,CAAC,MAAM,IAAI,CAAC,CAAC,IAAM,UAAU,GAAG,IAAI,CAAC,OAAO;IACpE;IACA;;;;;KAKC,GACD,MAAM,YAAY,KAAK,EAAE;QACrB,OAAO,IAAI,mLAAK,CAAC,IAAI,EAAE;IAC3B;IACA,+EAA+E,GAC/E,SAAS,KAAK,EAAE;QACZ,MAAM,WAAW,IAAA,sLAAU,EAAC,IAAI,CAAC,SAAS,IAAI;QAC9C,OAAO,IAAI,CAAC,SAAS,CAAC,UAAU,IAAI,CAAC,wMAAuB;IAChE;IACA;OACG,GACH,SAAS,KAAK,EAAE;QACZ,MAAM,WAAW,IAAA,sLAAU,EAAC,IAAI,CAAC,SAAS,IAAI;QAC9C,OAAO,IAAI,CAAC,SAAS,CAAC;IAC1B;IACA;;;KAGC,GACD,QAAQ;AACZ","ignoreList":[0]}},
    {"offset": {"line": 1334, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/node_modules/@libsql/hrana-client/lib-esm/cursor.js"],"sourcesContent":["export class Cursor {\n}\n"],"names":[],"mappings":";;;;AAAO,MAAM;AACb","ignoreList":[0]}},
    {"offset": {"line": 1344, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/node_modules/@libsql/hrana-client/lib-esm/ws/cursor.js"],"sourcesContent":["import { ClientError, ClosedError } from \"../errors.js\";\nimport { Cursor } from \"../cursor.js\";\nimport { Queue } from \"../queue.js\";\nconst fetchChunkSize = 1000;\nconst fetchQueueSize = 10;\nexport class WsCursor extends Cursor {\n    #client;\n    #stream;\n    #cursorId;\n    #entryQueue;\n    #fetchQueue;\n    #closed;\n    #done;\n    /** @private */\n    constructor(client, stream, cursorId) {\n        super();\n        this.#client = client;\n        this.#stream = stream;\n        this.#cursorId = cursorId;\n        this.#entryQueue = new Queue();\n        this.#fetchQueue = new Queue();\n        this.#closed = undefined;\n        this.#done = false;\n    }\n    /** Fetch the next entry from the cursor. */\n    async next() {\n        for (;;) {\n            if (this.#closed !== undefined) {\n                throw new ClosedError(\"Cursor is closed\", this.#closed);\n            }\n            while (!this.#done && this.#fetchQueue.length < fetchQueueSize) {\n                this.#fetchQueue.push(this.#fetch());\n            }\n            const entry = this.#entryQueue.shift();\n            if (this.#done || entry !== undefined) {\n                return entry;\n            }\n            // we assume that `Cursor.next()` is never called concurrently\n            await this.#fetchQueue.shift().then((response) => {\n                if (response === undefined) {\n                    return;\n                }\n                for (const entry of response.entries) {\n                    this.#entryQueue.push(entry);\n                }\n                this.#done ||= response.done;\n            });\n        }\n    }\n    #fetch() {\n        return this.#stream._sendCursorRequest(this, {\n            type: \"fetch_cursor\",\n            cursorId: this.#cursorId,\n            maxCount: fetchChunkSize,\n        }).then((resp) => resp, (error) => {\n            this._setClosed(error);\n            return undefined;\n        });\n    }\n    /** @private */\n    _setClosed(error) {\n        if (this.#closed !== undefined) {\n            return;\n        }\n        this.#closed = error;\n        this.#stream._sendCursorRequest(this, {\n            type: \"close_cursor\",\n            cursorId: this.#cursorId,\n        }).catch(() => undefined);\n        this.#stream._cursorClosed(this);\n    }\n    /** Close the cursor. */\n    close() {\n        this._setClosed(new ClientError(\"Cursor was manually closed\"));\n    }\n    /** True if the cursor is closed. */\n    get closed() {\n        return this.#closed !== undefined;\n    }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;AACA,MAAM,iBAAiB;AACvB,MAAM,iBAAiB;AAChB,MAAM,iBAAiB,qLAAM;IAChC,CAAA,MAAO,CAAC;IACR,CAAA,MAAO,CAAC;IACR,CAAA,QAAS,CAAC;IACV,CAAA,UAAW,CAAC;IACZ,CAAA,UAAW,CAAC;IACZ,CAAA,MAAO,CAAC;IACR,CAAA,IAAK,CAAC;IACN,aAAa,GACb,YAAY,MAAM,EAAE,MAAM,EAAE,QAAQ,CAAE;QAClC,KAAK;QACL,IAAI,CAAC,CAAA,MAAO,GAAG;QACf,IAAI,CAAC,CAAA,MAAO,GAAG;QACf,IAAI,CAAC,CAAA,QAAS,GAAG;QACjB,IAAI,CAAC,CAAA,UAAW,GAAG,IAAI,mLAAK;QAC5B,IAAI,CAAC,CAAA,UAAW,GAAG,IAAI,mLAAK;QAC5B,IAAI,CAAC,CAAA,MAAO,GAAG;QACf,IAAI,CAAC,CAAA,IAAK,GAAG;IACjB;IACA,0CAA0C,GAC1C,MAAM,OAAO;QACT,OAAS;YACL,IAAI,IAAI,CAAC,CAAA,MAAO,KAAK,WAAW;gBAC5B,MAAM,IAAI,0LAAW,CAAC,oBAAoB,IAAI,CAAC,CAAA,MAAO;YAC1D;YACA,MAAO,CAAC,IAAI,CAAC,CAAA,IAAK,IAAI,IAAI,CAAC,CAAA,UAAW,CAAC,MAAM,GAAG,eAAgB;gBAC5D,IAAI,CAAC,CAAA,UAAW,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA,KAAM;YACrC;YACA,MAAM,QAAQ,IAAI,CAAC,CAAA,UAAW,CAAC,KAAK;YACpC,IAAI,IAAI,CAAC,CAAA,IAAK,IAAI,UAAU,WAAW;gBACnC,OAAO;YACX;YACA,8DAA8D;YAC9D,MAAM,IAAI,CAAC,CAAA,UAAW,CAAC,KAAK,GAAG,IAAI,CAAC,CAAC;gBACjC,IAAI,aAAa,WAAW;oBACxB;gBACJ;gBACA,KAAK,MAAM,SAAS,SAAS,OAAO,CAAE;oBAClC,IAAI,CAAC,CAAA,UAAW,CAAC,IAAI,CAAC;gBAC1B;gBACA,IAAI,CAAC,CAAA,IAAK,KAAK,SAAS,IAAI;YAChC;QACJ;IACJ;IACA,CAAA,KAAM;QACF,OAAO,IAAI,CAAC,CAAA,MAAO,CAAC,kBAAkB,CAAC,IAAI,EAAE;YACzC,MAAM;YACN,UAAU,IAAI,CAAC,CAAA,QAAS;YACxB,UAAU;QACd,GAAG,IAAI,CAAC,CAAC,OAAS,MAAM,CAAC;YACrB,IAAI,CAAC,UAAU,CAAC;YAChB,OAAO;QACX;IACJ;IACA,aAAa,GACb,WAAW,KAAK,EAAE;QACd,IAAI,IAAI,CAAC,CAAA,MAAO,KAAK,WAAW;YAC5B;QACJ;QACA,IAAI,CAAC,CAAA,MAAO,GAAG;QACf,IAAI,CAAC,CAAA,MAAO,CAAC,kBAAkB,CAAC,IAAI,EAAE;YAClC,MAAM;YACN,UAAU,IAAI,CAAC,CAAA,QAAS;QAC5B,GAAG,KAAK,CAAC,IAAM;QACf,IAAI,CAAC,CAAA,MAAO,CAAC,aAAa,CAAC,IAAI;IACnC;IACA,sBAAsB,GACtB,QAAQ;QACJ,IAAI,CAAC,UAAU,CAAC,IAAI,0LAAW,CAAC;IACpC;IACA,kCAAkC,GAClC,IAAI,SAAS;QACT,OAAO,IAAI,CAAC,CAAA,MAAO,KAAK;IAC5B;AACJ","ignoreList":[0]}},
    {"offset": {"line": 1430, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/node_modules/@libsql/hrana-client/lib-esm/ws/stream.js"],"sourcesContent":["import { ClientError, ClosedError, InternalError } from \"../errors.js\";\nimport { Queue } from \"../queue.js\";\nimport { Stream } from \"../stream.js\";\nimport { WsCursor } from \"./cursor.js\";\nexport class WsStream extends Stream {\n    #client;\n    #streamId;\n    #queue;\n    #cursor;\n    #closing;\n    #closed;\n    /** @private */\n    static open(client) {\n        const streamId = client._streamIdAlloc.alloc();\n        const stream = new WsStream(client, streamId);\n        const responseCallback = () => undefined;\n        const errorCallback = (e) => stream.#setClosed(e);\n        const request = { type: \"open_stream\", streamId };\n        client._sendRequest(request, { responseCallback, errorCallback });\n        return stream;\n    }\n    /** @private */\n    constructor(client, streamId) {\n        super(client.intMode);\n        this.#client = client;\n        this.#streamId = streamId;\n        this.#queue = new Queue();\n        this.#cursor = undefined;\n        this.#closing = false;\n        this.#closed = undefined;\n    }\n    /** Get the {@link WsClient} object that this stream belongs to. */\n    client() {\n        return this.#client;\n    }\n    /** @private */\n    _sqlOwner() {\n        return this.#client;\n    }\n    /** @private */\n    _execute(stmt) {\n        return this.#sendStreamRequest({\n            type: \"execute\",\n            streamId: this.#streamId,\n            stmt,\n        }).then((response) => {\n            return response.result;\n        });\n    }\n    /** @private */\n    _batch(batch) {\n        return this.#sendStreamRequest({\n            type: \"batch\",\n            streamId: this.#streamId,\n            batch,\n        }).then((response) => {\n            return response.result;\n        });\n    }\n    /** @private */\n    _describe(protoSql) {\n        this.#client._ensureVersion(2, \"describe()\");\n        return this.#sendStreamRequest({\n            type: \"describe\",\n            streamId: this.#streamId,\n            sql: protoSql.sql,\n            sqlId: protoSql.sqlId,\n        }).then((response) => {\n            return response.result;\n        });\n    }\n    /** @private */\n    _sequence(protoSql) {\n        this.#client._ensureVersion(2, \"sequence()\");\n        return this.#sendStreamRequest({\n            type: \"sequence\",\n            streamId: this.#streamId,\n            sql: protoSql.sql,\n            sqlId: protoSql.sqlId,\n        }).then((_response) => {\n            return undefined;\n        });\n    }\n    /** Check whether the SQL connection underlying this stream is in autocommit state (i.e., outside of an\n     * explicit transaction). This requires protocol version 3 or higher.\n     */\n    getAutocommit() {\n        this.#client._ensureVersion(3, \"getAutocommit()\");\n        return this.#sendStreamRequest({\n            type: \"get_autocommit\",\n            streamId: this.#streamId,\n        }).then((response) => {\n            return response.isAutocommit;\n        });\n    }\n    #sendStreamRequest(request) {\n        return new Promise((responseCallback, errorCallback) => {\n            this.#pushToQueue({ type: \"request\", request, responseCallback, errorCallback });\n        });\n    }\n    /** @private */\n    _openCursor(batch) {\n        this.#client._ensureVersion(3, \"cursor\");\n        return new Promise((cursorCallback, errorCallback) => {\n            this.#pushToQueue({ type: \"cursor\", batch, cursorCallback, errorCallback });\n        });\n    }\n    /** @private */\n    _sendCursorRequest(cursor, request) {\n        if (cursor !== this.#cursor) {\n            throw new InternalError(\"Cursor not associated with the stream attempted to execute a request\");\n        }\n        return new Promise((responseCallback, errorCallback) => {\n            if (this.#closed !== undefined) {\n                errorCallback(new ClosedError(\"Stream is closed\", this.#closed));\n            }\n            else {\n                this.#client._sendRequest(request, { responseCallback, errorCallback });\n            }\n        });\n    }\n    /** @private */\n    _cursorClosed(cursor) {\n        if (cursor !== this.#cursor) {\n            throw new InternalError(\"Cursor was closed, but it was not associated with the stream\");\n        }\n        this.#cursor = undefined;\n        this.#flushQueue();\n    }\n    #pushToQueue(entry) {\n        if (this.#closed !== undefined) {\n            entry.errorCallback(new ClosedError(\"Stream is closed\", this.#closed));\n        }\n        else if (this.#closing) {\n            entry.errorCallback(new ClosedError(\"Stream is closing\", undefined));\n        }\n        else {\n            this.#queue.push(entry);\n            this.#flushQueue();\n        }\n    }\n    #flushQueue() {\n        for (;;) {\n            const entry = this.#queue.first();\n            if (entry === undefined && this.#cursor === undefined && this.#closing) {\n                this.#setClosed(new ClientError(\"Stream was gracefully closed\"));\n                break;\n            }\n            else if (entry?.type === \"request\" && this.#cursor === undefined) {\n                const { request, responseCallback, errorCallback } = entry;\n                this.#queue.shift();\n                this.#client._sendRequest(request, { responseCallback, errorCallback });\n            }\n            else if (entry?.type === \"cursor\" && this.#cursor === undefined) {\n                const { batch, cursorCallback } = entry;\n                this.#queue.shift();\n                const cursorId = this.#client._cursorIdAlloc.alloc();\n                const cursor = new WsCursor(this.#client, this, cursorId);\n                const request = {\n                    type: \"open_cursor\",\n                    streamId: this.#streamId,\n                    cursorId,\n                    batch,\n                };\n                const responseCallback = () => undefined;\n                const errorCallback = (e) => cursor._setClosed(e);\n                this.#client._sendRequest(request, { responseCallback, errorCallback });\n                this.#cursor = cursor;\n                cursorCallback(cursor);\n            }\n            else {\n                break;\n            }\n        }\n    }\n    #setClosed(error) {\n        if (this.#closed !== undefined) {\n            return;\n        }\n        this.#closed = error;\n        if (this.#cursor !== undefined) {\n            this.#cursor._setClosed(error);\n        }\n        for (;;) {\n            const entry = this.#queue.shift();\n            if (entry !== undefined) {\n                entry.errorCallback(error);\n            }\n            else {\n                break;\n            }\n        }\n        const request = { type: \"close_stream\", streamId: this.#streamId };\n        const responseCallback = () => this.#client._streamIdAlloc.free(this.#streamId);\n        const errorCallback = () => undefined;\n        this.#client._sendRequest(request, { responseCallback, errorCallback });\n    }\n    /** Immediately close the stream. */\n    close() {\n        this.#setClosed(new ClientError(\"Stream was manually closed\"));\n    }\n    /** Gracefully close the stream. */\n    closeGracefully() {\n        this.#closing = true;\n        this.#flushQueue();\n    }\n    /** True if the stream is closed or closing. */\n    get closed() {\n        return this.#closed !== undefined || this.#closing;\n    }\n}\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 1662, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/node_modules/@libsql/hrana-client/lib-esm/shared/json_encode.js"],"sourcesContent":["import { Base64 } from \"js-base64\";\nimport { impossible } from \"../util.js\";\nexport function Stmt(w, msg) {\n    if (msg.sql !== undefined) {\n        w.string(\"sql\", msg.sql);\n    }\n    if (msg.sqlId !== undefined) {\n        w.number(\"sql_id\", msg.sqlId);\n    }\n    w.arrayObjects(\"args\", msg.args, Value);\n    w.arrayObjects(\"named_args\", msg.namedArgs, NamedArg);\n    w.boolean(\"want_rows\", msg.wantRows);\n}\nfunction NamedArg(w, msg) {\n    w.string(\"name\", msg.name);\n    w.object(\"value\", msg.value, Value);\n}\nexport function Batch(w, msg) {\n    w.arrayObjects(\"steps\", msg.steps, BatchStep);\n}\nfunction BatchStep(w, msg) {\n    if (msg.condition !== undefined) {\n        w.object(\"condition\", msg.condition, BatchCond);\n    }\n    w.object(\"stmt\", msg.stmt, Stmt);\n}\nfunction BatchCond(w, msg) {\n    w.stringRaw(\"type\", msg.type);\n    if (msg.type === \"ok\" || msg.type === \"error\") {\n        w.number(\"step\", msg.step);\n    }\n    else if (msg.type === \"not\") {\n        w.object(\"cond\", msg.cond, BatchCond);\n    }\n    else if (msg.type === \"and\" || msg.type === \"or\") {\n        w.arrayObjects(\"conds\", msg.conds, BatchCond);\n    }\n    else if (msg.type === \"is_autocommit\") {\n        // do nothing\n    }\n    else {\n        throw impossible(msg, \"Impossible type of BatchCond\");\n    }\n}\nfunction Value(w, msg) {\n    if (msg === null) {\n        w.stringRaw(\"type\", \"null\");\n    }\n    else if (typeof msg === \"bigint\") {\n        w.stringRaw(\"type\", \"integer\");\n        w.stringRaw(\"value\", \"\" + msg);\n    }\n    else if (typeof msg === \"number\") {\n        w.stringRaw(\"type\", \"float\");\n        w.number(\"value\", msg);\n    }\n    else if (typeof msg === \"string\") {\n        w.stringRaw(\"type\", \"text\");\n        w.string(\"value\", msg);\n    }\n    else if (msg instanceof Uint8Array) {\n        w.stringRaw(\"type\", \"blob\");\n        w.stringRaw(\"base64\", Base64.fromUint8Array(msg));\n    }\n    else if (msg === undefined) {\n        // do nothing\n    }\n    else {\n        throw impossible(msg, \"Impossible type of Value\");\n    }\n}\n"],"names":[],"mappings":";;;;;;AAAA;AACA;;;AACO,SAAS,KAAK,CAAC,EAAE,GAAG;IACvB,IAAI,IAAI,GAAG,KAAK,WAAW;QACvB,EAAE,MAAM,CAAC,OAAO,IAAI,GAAG;IAC3B;IACA,IAAI,IAAI,KAAK,KAAK,WAAW;QACzB,EAAE,MAAM,CAAC,UAAU,IAAI,KAAK;IAChC;IACA,EAAE,YAAY,CAAC,QAAQ,IAAI,IAAI,EAAE;IACjC,EAAE,YAAY,CAAC,cAAc,IAAI,SAAS,EAAE;IAC5C,EAAE,OAAO,CAAC,aAAa,IAAI,QAAQ;AACvC;AACA,SAAS,SAAS,CAAC,EAAE,GAAG;IACpB,EAAE,MAAM,CAAC,QAAQ,IAAI,IAAI;IACzB,EAAE,MAAM,CAAC,SAAS,IAAI,KAAK,EAAE;AACjC;AACO,SAAS,MAAM,CAAC,EAAE,GAAG;IACxB,EAAE,YAAY,CAAC,SAAS,IAAI,KAAK,EAAE;AACvC;AACA,SAAS,UAAU,CAAC,EAAE,GAAG;IACrB,IAAI,IAAI,SAAS,KAAK,WAAW;QAC7B,EAAE,MAAM,CAAC,aAAa,IAAI,SAAS,EAAE;IACzC;IACA,EAAE,MAAM,CAAC,QAAQ,IAAI,IAAI,EAAE;AAC/B;AACA,SAAS,UAAU,CAAC,EAAE,GAAG;IACrB,EAAE,SAAS,CAAC,QAAQ,IAAI,IAAI;IAC5B,IAAI,IAAI,IAAI,KAAK,QAAQ,IAAI,IAAI,KAAK,SAAS;QAC3C,EAAE,MAAM,CAAC,QAAQ,IAAI,IAAI;IAC7B,OACK,IAAI,IAAI,IAAI,KAAK,OAAO;QACzB,EAAE,MAAM,CAAC,QAAQ,IAAI,IAAI,EAAE;IAC/B,OACK,IAAI,IAAI,IAAI,KAAK,SAAS,IAAI,IAAI,KAAK,MAAM;QAC9C,EAAE,YAAY,CAAC,SAAS,IAAI,KAAK,EAAE;IACvC,OACK,IAAI,IAAI,IAAI,KAAK,iBAAiB;IACnC,aAAa;IACjB,OACK;QACD,MAAM,IAAA,uLAAU,EAAC,KAAK;IAC1B;AACJ;AACA,SAAS,MAAM,CAAC,EAAE,GAAG;IACjB,IAAI,QAAQ,MAAM;QACd,EAAE,SAAS,CAAC,QAAQ;IACxB,OACK,IAAI,OAAO,QAAQ,UAAU;QAC9B,EAAE,SAAS,CAAC,QAAQ;QACpB,EAAE,SAAS,CAAC,SAAS,KAAK;IAC9B,OACK,IAAI,OAAO,QAAQ,UAAU;QAC9B,EAAE,SAAS,CAAC,QAAQ;QACpB,EAAE,MAAM,CAAC,SAAS;IACtB,OACK,IAAI,OAAO,QAAQ,UAAU;QAC9B,EAAE,SAAS,CAAC,QAAQ;QACpB,EAAE,MAAM,CAAC,SAAS;IACtB,OACK,IAAI,eAAe,YAAY;QAChC,EAAE,SAAS,CAAC,QAAQ;QACpB,EAAE,SAAS,CAAC,UAAU,yJAAM,CAAC,cAAc,CAAC;IAChD,OACK,IAAI,QAAQ,WAAW;IACxB,aAAa;IACjB,OACK;QACD,MAAM,IAAA,uLAAU,EAAC,KAAK;IAC1B;AACJ","ignoreList":[0]}},
    {"offset": {"line": 1735, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/node_modules/@libsql/hrana-client/lib-esm/ws/json_encode.js"],"sourcesContent":["import { Stmt, Batch } from \"../shared/json_encode.js\";\nimport { impossible } from \"../util.js\";\nexport function ClientMsg(w, msg) {\n    w.stringRaw(\"type\", msg.type);\n    if (msg.type === \"hello\") {\n        if (msg.jwt !== undefined) {\n            w.string(\"jwt\", msg.jwt);\n        }\n    }\n    else if (msg.type === \"request\") {\n        w.number(\"request_id\", msg.requestId);\n        w.object(\"request\", msg.request, Request);\n    }\n    else {\n        throw impossible(msg, \"Impossible type of ClientMsg\");\n    }\n}\nfunction Request(w, msg) {\n    w.stringRaw(\"type\", msg.type);\n    if (msg.type === \"open_stream\") {\n        w.number(\"stream_id\", msg.streamId);\n    }\n    else if (msg.type === \"close_stream\") {\n        w.number(\"stream_id\", msg.streamId);\n    }\n    else if (msg.type === \"execute\") {\n        w.number(\"stream_id\", msg.streamId);\n        w.object(\"stmt\", msg.stmt, Stmt);\n    }\n    else if (msg.type === \"batch\") {\n        w.number(\"stream_id\", msg.streamId);\n        w.object(\"batch\", msg.batch, Batch);\n    }\n    else if (msg.type === \"open_cursor\") {\n        w.number(\"stream_id\", msg.streamId);\n        w.number(\"cursor_id\", msg.cursorId);\n        w.object(\"batch\", msg.batch, Batch);\n    }\n    else if (msg.type === \"close_cursor\") {\n        w.number(\"cursor_id\", msg.cursorId);\n    }\n    else if (msg.type === \"fetch_cursor\") {\n        w.number(\"cursor_id\", msg.cursorId);\n        w.number(\"max_count\", msg.maxCount);\n    }\n    else if (msg.type === \"sequence\") {\n        w.number(\"stream_id\", msg.streamId);\n        if (msg.sql !== undefined) {\n            w.string(\"sql\", msg.sql);\n        }\n        if (msg.sqlId !== undefined) {\n            w.number(\"sql_id\", msg.sqlId);\n        }\n    }\n    else if (msg.type === \"describe\") {\n        w.number(\"stream_id\", msg.streamId);\n        if (msg.sql !== undefined) {\n            w.string(\"sql\", msg.sql);\n        }\n        if (msg.sqlId !== undefined) {\n            w.number(\"sql_id\", msg.sqlId);\n        }\n    }\n    else if (msg.type === \"store_sql\") {\n        w.number(\"sql_id\", msg.sqlId);\n        w.string(\"sql\", msg.sql);\n    }\n    else if (msg.type === \"close_sql\") {\n        w.number(\"sql_id\", msg.sqlId);\n    }\n    else if (msg.type === \"get_autocommit\") {\n        w.number(\"stream_id\", msg.streamId);\n    }\n    else {\n        throw impossible(msg, \"Impossible type of Request\");\n    }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AACO,SAAS,UAAU,CAAC,EAAE,GAAG;IAC5B,EAAE,SAAS,CAAC,QAAQ,IAAI,IAAI;IAC5B,IAAI,IAAI,IAAI,KAAK,SAAS;QACtB,IAAI,IAAI,GAAG,KAAK,WAAW;YACvB,EAAE,MAAM,CAAC,OAAO,IAAI,GAAG;QAC3B;IACJ,OACK,IAAI,IAAI,IAAI,KAAK,WAAW;QAC7B,EAAE,MAAM,CAAC,cAAc,IAAI,SAAS;QACpC,EAAE,MAAM,CAAC,WAAW,IAAI,OAAO,EAAE;IACrC,OACK;QACD,MAAM,IAAA,uLAAU,EAAC,KAAK;IAC1B;AACJ;AACA,SAAS,QAAQ,CAAC,EAAE,GAAG;IACnB,EAAE,SAAS,CAAC,QAAQ,IAAI,IAAI;IAC5B,IAAI,IAAI,IAAI,KAAK,eAAe;QAC5B,EAAE,MAAM,CAAC,aAAa,IAAI,QAAQ;IACtC,OACK,IAAI,IAAI,IAAI,KAAK,gBAAgB;QAClC,EAAE,MAAM,CAAC,aAAa,IAAI,QAAQ;IACtC,OACK,IAAI,IAAI,IAAI,KAAK,WAAW;QAC7B,EAAE,MAAM,CAAC,aAAa,IAAI,QAAQ;QAClC,EAAE,MAAM,CAAC,QAAQ,IAAI,IAAI,EAAE,kMAAI;IACnC,OACK,IAAI,IAAI,IAAI,KAAK,SAAS;QAC3B,EAAE,MAAM,CAAC,aAAa,IAAI,QAAQ;QAClC,EAAE,MAAM,CAAC,SAAS,IAAI,KAAK,EAAE,mMAAK;IACtC,OACK,IAAI,IAAI,IAAI,KAAK,eAAe;QACjC,EAAE,MAAM,CAAC,aAAa,IAAI,QAAQ;QAClC,EAAE,MAAM,CAAC,aAAa,IAAI,QAAQ;QAClC,EAAE,MAAM,CAAC,SAAS,IAAI,KAAK,EAAE,mMAAK;IACtC,OACK,IAAI,IAAI,IAAI,KAAK,gBAAgB;QAClC,EAAE,MAAM,CAAC,aAAa,IAAI,QAAQ;IACtC,OACK,IAAI,IAAI,IAAI,KAAK,gBAAgB;QAClC,EAAE,MAAM,CAAC,aAAa,IAAI,QAAQ;QAClC,EAAE,MAAM,CAAC,aAAa,IAAI,QAAQ;IACtC,OACK,IAAI,IAAI,IAAI,KAAK,YAAY;QAC9B,EAAE,MAAM,CAAC,aAAa,IAAI,QAAQ;QAClC,IAAI,IAAI,GAAG,KAAK,WAAW;YACvB,EAAE,MAAM,CAAC,OAAO,IAAI,GAAG;QAC3B;QACA,IAAI,IAAI,KAAK,KAAK,WAAW;YACzB,EAAE,MAAM,CAAC,UAAU,IAAI,KAAK;QAChC;IACJ,OACK,IAAI,IAAI,IAAI,KAAK,YAAY;QAC9B,EAAE,MAAM,CAAC,aAAa,IAAI,QAAQ;QAClC,IAAI,IAAI,GAAG,KAAK,WAAW;YACvB,EAAE,MAAM,CAAC,OAAO,IAAI,GAAG;QAC3B;QACA,IAAI,IAAI,KAAK,KAAK,WAAW;YACzB,EAAE,MAAM,CAAC,UAAU,IAAI,KAAK;QAChC;IACJ,OACK,IAAI,IAAI,IAAI,KAAK,aAAa;QAC/B,EAAE,MAAM,CAAC,UAAU,IAAI,KAAK;QAC5B,EAAE,MAAM,CAAC,OAAO,IAAI,GAAG;IAC3B,OACK,IAAI,IAAI,IAAI,KAAK,aAAa;QAC/B,EAAE,MAAM,CAAC,UAAU,IAAI,KAAK;IAChC,OACK,IAAI,IAAI,IAAI,KAAK,kBAAkB;QACpC,EAAE,MAAM,CAAC,aAAa,IAAI,QAAQ;IACtC,OACK;QACD,MAAM,IAAA,uLAAU,EAAC,KAAK;IAC1B;AACJ","ignoreList":[0]}},
    {"offset": {"line": 1808, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/node_modules/@libsql/hrana-client/lib-esm/shared/protobuf_encode.js"],"sourcesContent":["import { impossible } from \"../util.js\";\nexport function Stmt(w, msg) {\n    if (msg.sql !== undefined) {\n        w.string(1, msg.sql);\n    }\n    if (msg.sqlId !== undefined) {\n        w.int32(2, msg.sqlId);\n    }\n    for (const arg of msg.args) {\n        w.message(3, arg, Value);\n    }\n    for (const arg of msg.namedArgs) {\n        w.message(4, arg, NamedArg);\n    }\n    w.bool(5, msg.wantRows);\n}\nfunction NamedArg(w, msg) {\n    w.string(1, msg.name);\n    w.message(2, msg.value, Value);\n}\nexport function Batch(w, msg) {\n    for (const step of msg.steps) {\n        w.message(1, step, BatchStep);\n    }\n}\nfunction BatchStep(w, msg) {\n    if (msg.condition !== undefined) {\n        w.message(1, msg.condition, BatchCond);\n    }\n    w.message(2, msg.stmt, Stmt);\n}\nfunction BatchCond(w, msg) {\n    if (msg.type === \"ok\") {\n        w.uint32(1, msg.step);\n    }\n    else if (msg.type === \"error\") {\n        w.uint32(2, msg.step);\n    }\n    else if (msg.type === \"not\") {\n        w.message(3, msg.cond, BatchCond);\n    }\n    else if (msg.type === \"and\") {\n        w.message(4, msg.conds, BatchCondList);\n    }\n    else if (msg.type === \"or\") {\n        w.message(5, msg.conds, BatchCondList);\n    }\n    else if (msg.type === \"is_autocommit\") {\n        w.message(6, undefined, Empty);\n    }\n    else {\n        throw impossible(msg, \"Impossible type of BatchCond\");\n    }\n}\nfunction BatchCondList(w, msg) {\n    for (const cond of msg) {\n        w.message(1, cond, BatchCond);\n    }\n}\nfunction Value(w, msg) {\n    if (msg === null) {\n        w.message(1, undefined, Empty);\n    }\n    else if (typeof msg === \"bigint\") {\n        w.sint64(2, msg);\n    }\n    else if (typeof msg === \"number\") {\n        w.double(3, msg);\n    }\n    else if (typeof msg === \"string\") {\n        w.string(4, msg);\n    }\n    else if (msg instanceof Uint8Array) {\n        w.bytes(5, msg);\n    }\n    else if (msg === undefined) {\n        // do nothing\n    }\n    else {\n        throw impossible(msg, \"Impossible type of Value\");\n    }\n}\nfunction Empty(_w, _msg) {\n    // do nothing\n}\n"],"names":[],"mappings":";;;;;;AAAA;;AACO,SAAS,KAAK,CAAC,EAAE,GAAG;IACvB,IAAI,IAAI,GAAG,KAAK,WAAW;QACvB,EAAE,MAAM,CAAC,GAAG,IAAI,GAAG;IACvB;IACA,IAAI,IAAI,KAAK,KAAK,WAAW;QACzB,EAAE,KAAK,CAAC,GAAG,IAAI,KAAK;IACxB;IACA,KAAK,MAAM,OAAO,IAAI,IAAI,CAAE;QACxB,EAAE,OAAO,CAAC,GAAG,KAAK;IACtB;IACA,KAAK,MAAM,OAAO,IAAI,SAAS,CAAE;QAC7B,EAAE,OAAO,CAAC,GAAG,KAAK;IACtB;IACA,EAAE,IAAI,CAAC,GAAG,IAAI,QAAQ;AAC1B;AACA,SAAS,SAAS,CAAC,EAAE,GAAG;IACpB,EAAE,MAAM,CAAC,GAAG,IAAI,IAAI;IACpB,EAAE,OAAO,CAAC,GAAG,IAAI,KAAK,EAAE;AAC5B;AACO,SAAS,MAAM,CAAC,EAAE,GAAG;IACxB,KAAK,MAAM,QAAQ,IAAI,KAAK,CAAE;QAC1B,EAAE,OAAO,CAAC,GAAG,MAAM;IACvB;AACJ;AACA,SAAS,UAAU,CAAC,EAAE,GAAG;IACrB,IAAI,IAAI,SAAS,KAAK,WAAW;QAC7B,EAAE,OAAO,CAAC,GAAG,IAAI,SAAS,EAAE;IAChC;IACA,EAAE,OAAO,CAAC,GAAG,IAAI,IAAI,EAAE;AAC3B;AACA,SAAS,UAAU,CAAC,EAAE,GAAG;IACrB,IAAI,IAAI,IAAI,KAAK,MAAM;QACnB,EAAE,MAAM,CAAC,GAAG,IAAI,IAAI;IACxB,OACK,IAAI,IAAI,IAAI,KAAK,SAAS;QAC3B,EAAE,MAAM,CAAC,GAAG,IAAI,IAAI;IACxB,OACK,IAAI,IAAI,IAAI,KAAK,OAAO;QACzB,EAAE,OAAO,CAAC,GAAG,IAAI,IAAI,EAAE;IAC3B,OACK,IAAI,IAAI,IAAI,KAAK,OAAO;QACzB,EAAE,OAAO,CAAC,GAAG,IAAI,KAAK,EAAE;IAC5B,OACK,IAAI,IAAI,IAAI,KAAK,MAAM;QACxB,EAAE,OAAO,CAAC,GAAG,IAAI,KAAK,EAAE;IAC5B,OACK,IAAI,IAAI,IAAI,KAAK,iBAAiB;QACnC,EAAE,OAAO,CAAC,GAAG,WAAW;IAC5B,OACK;QACD,MAAM,IAAA,uLAAU,EAAC,KAAK;IAC1B;AACJ;AACA,SAAS,cAAc,CAAC,EAAE,GAAG;IACzB,KAAK,MAAM,QAAQ,IAAK;QACpB,EAAE,OAAO,CAAC,GAAG,MAAM;IACvB;AACJ;AACA,SAAS,MAAM,CAAC,EAAE,GAAG;IACjB,IAAI,QAAQ,MAAM;QACd,EAAE,OAAO,CAAC,GAAG,WAAW;IAC5B,OACK,IAAI,OAAO,QAAQ,UAAU;QAC9B,EAAE,MAAM,CAAC,GAAG;IAChB,OACK,IAAI,OAAO,QAAQ,UAAU;QAC9B,EAAE,MAAM,CAAC,GAAG;IAChB,OACK,IAAI,OAAO,QAAQ,UAAU;QAC9B,EAAE,MAAM,CAAC,GAAG;IAChB,OACK,IAAI,eAAe,YAAY;QAChC,EAAE,KAAK,CAAC,GAAG;IACf,OACK,IAAI,QAAQ,WAAW;IACxB,aAAa;IACjB,OACK;QACD,MAAM,IAAA,uLAAU,EAAC,KAAK;IAC1B;AACJ;AACA,SAAS,MAAM,EAAE,EAAE,IAAI;AACnB,aAAa;AACjB","ignoreList":[0]}},
    {"offset": {"line": 1892, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/node_modules/@libsql/hrana-client/lib-esm/ws/protobuf_encode.js"],"sourcesContent":["import { Stmt, Batch } from \"../shared/protobuf_encode.js\";\nimport { impossible } from \"../util.js\";\nexport function ClientMsg(w, msg) {\n    if (msg.type === \"hello\") {\n        w.message(1, msg, HelloMsg);\n    }\n    else if (msg.type === \"request\") {\n        w.message(2, msg, RequestMsg);\n    }\n    else {\n        throw impossible(msg, \"Impossible type of ClientMsg\");\n    }\n}\nfunction HelloMsg(w, msg) {\n    if (msg.jwt !== undefined) {\n        w.string(1, msg.jwt);\n    }\n}\nfunction RequestMsg(w, msg) {\n    w.int32(1, msg.requestId);\n    const request = msg.request;\n    if (request.type === \"open_stream\") {\n        w.message(2, request, OpenStreamReq);\n    }\n    else if (request.type === \"close_stream\") {\n        w.message(3, request, CloseStreamReq);\n    }\n    else if (request.type === \"execute\") {\n        w.message(4, request, ExecuteReq);\n    }\n    else if (request.type === \"batch\") {\n        w.message(5, request, BatchReq);\n    }\n    else if (request.type === \"open_cursor\") {\n        w.message(6, request, OpenCursorReq);\n    }\n    else if (request.type === \"close_cursor\") {\n        w.message(7, request, CloseCursorReq);\n    }\n    else if (request.type === \"fetch_cursor\") {\n        w.message(8, request, FetchCursorReq);\n    }\n    else if (request.type === \"sequence\") {\n        w.message(9, request, SequenceReq);\n    }\n    else if (request.type === \"describe\") {\n        w.message(10, request, DescribeReq);\n    }\n    else if (request.type === \"store_sql\") {\n        w.message(11, request, StoreSqlReq);\n    }\n    else if (request.type === \"close_sql\") {\n        w.message(12, request, CloseSqlReq);\n    }\n    else if (request.type === \"get_autocommit\") {\n        w.message(13, request, GetAutocommitReq);\n    }\n    else {\n        throw impossible(request, \"Impossible type of Request\");\n    }\n}\nfunction OpenStreamReq(w, msg) {\n    w.int32(1, msg.streamId);\n}\nfunction CloseStreamReq(w, msg) {\n    w.int32(1, msg.streamId);\n}\nfunction ExecuteReq(w, msg) {\n    w.int32(1, msg.streamId);\n    w.message(2, msg.stmt, Stmt);\n}\nfunction BatchReq(w, msg) {\n    w.int32(1, msg.streamId);\n    w.message(2, msg.batch, Batch);\n}\nfunction OpenCursorReq(w, msg) {\n    w.int32(1, msg.streamId);\n    w.int32(2, msg.cursorId);\n    w.message(3, msg.batch, Batch);\n}\nfunction CloseCursorReq(w, msg) {\n    w.int32(1, msg.cursorId);\n}\nfunction FetchCursorReq(w, msg) {\n    w.int32(1, msg.cursorId);\n    w.uint32(2, msg.maxCount);\n}\nfunction SequenceReq(w, msg) {\n    w.int32(1, msg.streamId);\n    if (msg.sql !== undefined) {\n        w.string(2, msg.sql);\n    }\n    if (msg.sqlId !== undefined) {\n        w.int32(3, msg.sqlId);\n    }\n}\nfunction DescribeReq(w, msg) {\n    w.int32(1, msg.streamId);\n    if (msg.sql !== undefined) {\n        w.string(2, msg.sql);\n    }\n    if (msg.sqlId !== undefined) {\n        w.int32(3, msg.sqlId);\n    }\n}\nfunction StoreSqlReq(w, msg) {\n    w.int32(1, msg.sqlId);\n    w.string(2, msg.sql);\n}\nfunction CloseSqlReq(w, msg) {\n    w.int32(1, msg.sqlId);\n}\nfunction GetAutocommitReq(w, msg) {\n    w.int32(1, msg.streamId);\n}\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 2003, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/node_modules/@libsql/hrana-client/lib-esm/shared/json_decode.js"],"sourcesContent":["import { Base64 } from \"js-base64\";\nimport { ProtoError } from \"../errors.js\";\nimport * as d from \"../encoding/json/decode.js\";\nexport function Error(obj) {\n    const message = d.string(obj[\"message\"]);\n    const code = d.stringOpt(obj[\"code\"]);\n    return { message, code };\n}\nexport function StmtResult(obj) {\n    const cols = d.arrayObjectsMap(obj[\"cols\"], Col);\n    const rows = d.array(obj[\"rows\"]).map((rowObj) => d.arrayObjectsMap(rowObj, Value));\n    const affectedRowCount = d.number(obj[\"affected_row_count\"]);\n    const lastInsertRowidStr = d.stringOpt(obj[\"last_insert_rowid\"]);\n    const lastInsertRowid = lastInsertRowidStr !== undefined\n        ? BigInt(lastInsertRowidStr) : undefined;\n    return { cols, rows, affectedRowCount, lastInsertRowid };\n}\nfunction Col(obj) {\n    const name = d.stringOpt(obj[\"name\"]);\n    const decltype = d.stringOpt(obj[\"decltype\"]);\n    return { name, decltype };\n}\nexport function BatchResult(obj) {\n    const stepResults = new Map();\n    d.array(obj[\"step_results\"]).forEach((value, i) => {\n        if (value !== null) {\n            stepResults.set(i, StmtResult(d.object(value)));\n        }\n    });\n    const stepErrors = new Map();\n    d.array(obj[\"step_errors\"]).forEach((value, i) => {\n        if (value !== null) {\n            stepErrors.set(i, Error(d.object(value)));\n        }\n    });\n    return { stepResults, stepErrors };\n}\nexport function CursorEntry(obj) {\n    const type = d.string(obj[\"type\"]);\n    if (type === \"step_begin\") {\n        const step = d.number(obj[\"step\"]);\n        const cols = d.arrayObjectsMap(obj[\"cols\"], Col);\n        return { type: \"step_begin\", step, cols };\n    }\n    else if (type === \"step_end\") {\n        const affectedRowCount = d.number(obj[\"affected_row_count\"]);\n        const lastInsertRowidStr = d.stringOpt(obj[\"last_insert_rowid\"]);\n        const lastInsertRowid = lastInsertRowidStr !== undefined\n            ? BigInt(lastInsertRowidStr) : undefined;\n        return { type: \"step_end\", affectedRowCount, lastInsertRowid };\n    }\n    else if (type === \"step_error\") {\n        const step = d.number(obj[\"step\"]);\n        const error = Error(d.object(obj[\"error\"]));\n        return { type: \"step_error\", step, error };\n    }\n    else if (type === \"row\") {\n        const row = d.arrayObjectsMap(obj[\"row\"], Value);\n        return { type: \"row\", row };\n    }\n    else if (type === \"error\") {\n        const error = Error(d.object(obj[\"error\"]));\n        return { type: \"error\", error };\n    }\n    else {\n        throw new ProtoError(\"Unexpected type of CursorEntry\");\n    }\n}\nexport function DescribeResult(obj) {\n    const params = d.arrayObjectsMap(obj[\"params\"], DescribeParam);\n    const cols = d.arrayObjectsMap(obj[\"cols\"], DescribeCol);\n    const isExplain = d.boolean(obj[\"is_explain\"]);\n    const isReadonly = d.boolean(obj[\"is_readonly\"]);\n    return { params, cols, isExplain, isReadonly };\n}\nfunction DescribeParam(obj) {\n    const name = d.stringOpt(obj[\"name\"]);\n    return { name };\n}\nfunction DescribeCol(obj) {\n    const name = d.string(obj[\"name\"]);\n    const decltype = d.stringOpt(obj[\"decltype\"]);\n    return { name, decltype };\n}\nexport function Value(obj) {\n    const type = d.string(obj[\"type\"]);\n    if (type === \"null\") {\n        return null;\n    }\n    else if (type === \"integer\") {\n        const value = d.string(obj[\"value\"]);\n        return BigInt(value);\n    }\n    else if (type === \"float\") {\n        return d.number(obj[\"value\"]);\n    }\n    else if (type === \"text\") {\n        return d.string(obj[\"value\"]);\n    }\n    else if (type === \"blob\") {\n        return Base64.toUint8Array(d.string(obj[\"base64\"]));\n    }\n    else {\n        throw new ProtoError(\"Unexpected type of Value\");\n    }\n}\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 2160, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/node_modules/@libsql/hrana-client/lib-esm/ws/json_decode.js"],"sourcesContent":["import { ProtoError } from \"../errors.js\";\nimport * as d from \"../encoding/json/decode.js\";\nimport { Error, StmtResult, BatchResult, CursorEntry, DescribeResult } from \"../shared/json_decode.js\";\nexport function ServerMsg(obj) {\n    const type = d.string(obj[\"type\"]);\n    if (type === \"hello_ok\") {\n        return { type: \"hello_ok\" };\n    }\n    else if (type === \"hello_error\") {\n        const error = Error(d.object(obj[\"error\"]));\n        return { type: \"hello_error\", error };\n    }\n    else if (type === \"response_ok\") {\n        const requestId = d.number(obj[\"request_id\"]);\n        const response = Response(d.object(obj[\"response\"]));\n        return { type: \"response_ok\", requestId, response };\n    }\n    else if (type === \"response_error\") {\n        const requestId = d.number(obj[\"request_id\"]);\n        const error = Error(d.object(obj[\"error\"]));\n        return { type: \"response_error\", requestId, error };\n    }\n    else {\n        throw new ProtoError(\"Unexpected type of ServerMsg\");\n    }\n}\nfunction Response(obj) {\n    const type = d.string(obj[\"type\"]);\n    if (type === \"open_stream\") {\n        return { type: \"open_stream\" };\n    }\n    else if (type === \"close_stream\") {\n        return { type: \"close_stream\" };\n    }\n    else if (type === \"execute\") {\n        const result = StmtResult(d.object(obj[\"result\"]));\n        return { type: \"execute\", result };\n    }\n    else if (type === \"batch\") {\n        const result = BatchResult(d.object(obj[\"result\"]));\n        return { type: \"batch\", result };\n    }\n    else if (type === \"open_cursor\") {\n        return { type: \"open_cursor\" };\n    }\n    else if (type === \"close_cursor\") {\n        return { type: \"close_cursor\" };\n    }\n    else if (type === \"fetch_cursor\") {\n        const entries = d.arrayObjectsMap(obj[\"entries\"], CursorEntry);\n        const done = d.boolean(obj[\"done\"]);\n        return { type: \"fetch_cursor\", entries, done };\n    }\n    else if (type === \"sequence\") {\n        return { type: \"sequence\" };\n    }\n    else if (type === \"describe\") {\n        const result = DescribeResult(d.object(obj[\"result\"]));\n        return { type: \"describe\", result };\n    }\n    else if (type === \"store_sql\") {\n        return { type: \"store_sql\" };\n    }\n    else if (type === \"close_sql\") {\n        return { type: \"close_sql\" };\n    }\n    else if (type === \"get_autocommit\") {\n        const isAutocommit = d.boolean(obj[\"is_autocommit\"]);\n        return { type: \"get_autocommit\", isAutocommit };\n    }\n    else {\n        throw new ProtoError(\"Unexpected type of Response\");\n    }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;AACO,SAAS,UAAU,GAAG;IACzB,MAAM,OAAO,yMAAQ,CAAC,GAAG,CAAC,OAAO;IACjC,IAAI,SAAS,YAAY;QACrB,OAAO;YAAE,MAAM;QAAW;IAC9B,OACK,IAAI,SAAS,eAAe;QAC7B,MAAM,QAAQ,IAAA,mMAAK,EAAC,yMAAQ,CAAC,GAAG,CAAC,QAAQ;QACzC,OAAO;YAAE,MAAM;YAAe;QAAM;IACxC,OACK,IAAI,SAAS,eAAe;QAC7B,MAAM,YAAY,yMAAQ,CAAC,GAAG,CAAC,aAAa;QAC5C,MAAM,WAAW,SAAS,yMAAQ,CAAC,GAAG,CAAC,WAAW;QAClD,OAAO;YAAE,MAAM;YAAe;YAAW;QAAS;IACtD,OACK,IAAI,SAAS,kBAAkB;QAChC,MAAM,YAAY,yMAAQ,CAAC,GAAG,CAAC,aAAa;QAC5C,MAAM,QAAQ,IAAA,mMAAK,EAAC,yMAAQ,CAAC,GAAG,CAAC,QAAQ;QACzC,OAAO;YAAE,MAAM;YAAkB;YAAW;QAAM;IACtD,OACK;QACD,MAAM,IAAI,yLAAU,CAAC;IACzB;AACJ;AACA,SAAS,SAAS,GAAG;IACjB,MAAM,OAAO,yMAAQ,CAAC,GAAG,CAAC,OAAO;IACjC,IAAI,SAAS,eAAe;QACxB,OAAO;YAAE,MAAM;QAAc;IACjC,OACK,IAAI,SAAS,gBAAgB;QAC9B,OAAO;YAAE,MAAM;QAAe;IAClC,OACK,IAAI,SAAS,WAAW;QACzB,MAAM,SAAS,IAAA,wMAAU,EAAC,yMAAQ,CAAC,GAAG,CAAC,SAAS;QAChD,OAAO;YAAE,MAAM;YAAW;QAAO;IACrC,OACK,IAAI,SAAS,SAAS;QACvB,MAAM,SAAS,IAAA,yMAAW,EAAC,yMAAQ,CAAC,GAAG,CAAC,SAAS;QACjD,OAAO;YAAE,MAAM;YAAS;QAAO;IACnC,OACK,IAAI,SAAS,eAAe;QAC7B,OAAO;YAAE,MAAM;QAAc;IACjC,OACK,IAAI,SAAS,gBAAgB;QAC9B,OAAO;YAAE,MAAM;QAAe;IAClC,OACK,IAAI,SAAS,gBAAgB;QAC9B,MAAM,UAAU,kNAAiB,CAAC,GAAG,CAAC,UAAU,EAAE,yMAAW;QAC7D,MAAM,OAAO,0MAAS,CAAC,GAAG,CAAC,OAAO;QAClC,OAAO;YAAE,MAAM;YAAgB;YAAS;QAAK;IACjD,OACK,IAAI,SAAS,YAAY;QAC1B,OAAO;YAAE,MAAM;QAAW;IAC9B,OACK,IAAI,SAAS,YAAY;QAC1B,MAAM,SAAS,IAAA,4MAAc,EAAC,yMAAQ,CAAC,GAAG,CAAC,SAAS;QACpD,OAAO;YAAE,MAAM;YAAY;QAAO;IACtC,OACK,IAAI,SAAS,aAAa;QAC3B,OAAO;YAAE,MAAM;QAAY;IAC/B,OACK,IAAI,SAAS,aAAa;QAC3B,OAAO;YAAE,MAAM;QAAY;IAC/B,OACK,IAAI,SAAS,kBAAkB;QAChC,MAAM,eAAe,0MAAS,CAAC,GAAG,CAAC,gBAAgB;QACnD,OAAO;YAAE,MAAM;YAAkB;QAAa;IAClD,OACK;QACD,MAAM,IAAI,yLAAU,CAAC;IACzB;AACJ","ignoreList":[0]}},
    {"offset": {"line": 2272, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/node_modules/@libsql/hrana-client/lib-esm/shared/protobuf_decode.js"],"sourcesContent":["export const Error = {\n    default() { return { message: \"\", code: undefined }; },\n    1(r, msg) { msg.message = r.string(); },\n    2(r, msg) { msg.code = r.string(); },\n};\nexport const StmtResult = {\n    default() {\n        return {\n            cols: [],\n            rows: [],\n            affectedRowCount: 0,\n            lastInsertRowid: undefined,\n        };\n    },\n    1(r, msg) { msg.cols.push(r.message(Col)); },\n    2(r, msg) { msg.rows.push(r.message(Row)); },\n    3(r, msg) { msg.affectedRowCount = Number(r.uint64()); },\n    4(r, msg) { msg.lastInsertRowid = r.sint64(); },\n};\nconst Col = {\n    default() { return { name: undefined, decltype: undefined }; },\n    1(r, msg) { msg.name = r.string(); },\n    2(r, msg) { msg.decltype = r.string(); },\n};\nconst Row = {\n    default() { return []; },\n    1(r, msg) { msg.push(r.message(Value)); },\n};\nexport const BatchResult = {\n    default() { return { stepResults: new Map(), stepErrors: new Map() }; },\n    1(r, msg) {\n        const [key, value] = r.message(BatchResultStepResult);\n        msg.stepResults.set(key, value);\n    },\n    2(r, msg) {\n        const [key, value] = r.message(BatchResultStepError);\n        msg.stepErrors.set(key, value);\n    },\n};\nconst BatchResultStepResult = {\n    default() { return [0, StmtResult.default()]; },\n    1(r, msg) { msg[0] = r.uint32(); },\n    2(r, msg) { msg[1] = r.message(StmtResult); },\n};\nconst BatchResultStepError = {\n    default() { return [0, Error.default()]; },\n    1(r, msg) { msg[0] = r.uint32(); },\n    2(r, msg) { msg[1] = r.message(Error); },\n};\nexport const CursorEntry = {\n    default() { return { type: \"none\" }; },\n    1(r) { return r.message(StepBeginEntry); },\n    2(r) { return r.message(StepEndEntry); },\n    3(r) { return r.message(StepErrorEntry); },\n    4(r) { return { type: \"row\", row: r.message(Row) }; },\n    5(r) { return { type: \"error\", error: r.message(Error) }; },\n};\nconst StepBeginEntry = {\n    default() { return { type: \"step_begin\", step: 0, cols: [] }; },\n    1(r, msg) { msg.step = r.uint32(); },\n    2(r, msg) { msg.cols.push(r.message(Col)); },\n};\nconst StepEndEntry = {\n    default() {\n        return {\n            type: \"step_end\",\n            affectedRowCount: 0,\n            lastInsertRowid: undefined,\n        };\n    },\n    1(r, msg) { msg.affectedRowCount = r.uint32(); },\n    2(r, msg) { msg.lastInsertRowid = r.uint64(); },\n};\nconst StepErrorEntry = {\n    default() {\n        return {\n            type: \"step_error\",\n            step: 0,\n            error: Error.default(),\n        };\n    },\n    1(r, msg) { msg.step = r.uint32(); },\n    2(r, msg) { msg.error = r.message(Error); },\n};\nexport const DescribeResult = {\n    default() {\n        return {\n            params: [],\n            cols: [],\n            isExplain: false,\n            isReadonly: false,\n        };\n    },\n    1(r, msg) { msg.params.push(r.message(DescribeParam)); },\n    2(r, msg) { msg.cols.push(r.message(DescribeCol)); },\n    3(r, msg) { msg.isExplain = r.bool(); },\n    4(r, msg) { msg.isReadonly = r.bool(); },\n};\nconst DescribeParam = {\n    default() { return { name: undefined }; },\n    1(r, msg) { msg.name = r.string(); },\n};\nconst DescribeCol = {\n    default() { return { name: \"\", decltype: undefined }; },\n    1(r, msg) { msg.name = r.string(); },\n    2(r, msg) { msg.decltype = r.string(); },\n};\nconst Value = {\n    default() { return undefined; },\n    1(r) { return null; },\n    2(r) { return r.sint64(); },\n    3(r) { return r.double(); },\n    4(r) { return r.string(); },\n    5(r) { return r.bytes(); },\n};\n"],"names":[],"mappings":";;;;;;;;;;;;AAAO,MAAM,QAAQ;IACjB;QAAY,OAAO;YAAE,SAAS;YAAI,MAAM;QAAU;IAAG;IACrD,GAAE,CAAC,EAAE,GAAG;QAAI,IAAI,OAAO,GAAG,EAAE,MAAM;IAAI;IACtC,GAAE,CAAC,EAAE,GAAG;QAAI,IAAI,IAAI,GAAG,EAAE,MAAM;IAAI;AACvC;AACO,MAAM,aAAa;IACtB;QACI,OAAO;YACH,MAAM,EAAE;YACR,MAAM,EAAE;YACR,kBAAkB;YAClB,iBAAiB;QACrB;IACJ;IACA,GAAE,CAAC,EAAE,GAAG;QAAI,IAAI,IAAI,CAAC,IAAI,CAAC,EAAE,OAAO,CAAC;IAAO;IAC3C,GAAE,CAAC,EAAE,GAAG;QAAI,IAAI,IAAI,CAAC,IAAI,CAAC,EAAE,OAAO,CAAC;IAAO;IAC3C,GAAE,CAAC,EAAE,GAAG;QAAI,IAAI,gBAAgB,GAAG,OAAO,EAAE,MAAM;IAAK;IACvD,GAAE,CAAC,EAAE,GAAG;QAAI,IAAI,eAAe,GAAG,EAAE,MAAM;IAAI;AAClD;AACA,MAAM,MAAM;IACR;QAAY,OAAO;YAAE,MAAM;YAAW,UAAU;QAAU;IAAG;IAC7D,GAAE,CAAC,EAAE,GAAG;QAAI,IAAI,IAAI,GAAG,EAAE,MAAM;IAAI;IACnC,GAAE,CAAC,EAAE,GAAG;QAAI,IAAI,QAAQ,GAAG,EAAE,MAAM;IAAI;AAC3C;AACA,MAAM,MAAM;IACR;QAAY,OAAO,EAAE;IAAE;IACvB,GAAE,CAAC,EAAE,GAAG;QAAI,IAAI,IAAI,CAAC,EAAE,OAAO,CAAC;IAAS;AAC5C;AACO,MAAM,cAAc;IACvB;QAAY,OAAO;YAAE,aAAa,IAAI;YAAO,YAAY,IAAI;QAAM;IAAG;IACtE,GAAE,CAAC,EAAE,GAAG;QACJ,MAAM,CAAC,KAAK,MAAM,GAAG,EAAE,OAAO,CAAC;QAC/B,IAAI,WAAW,CAAC,GAAG,CAAC,KAAK;IAC7B;IACA,GAAE,CAAC,EAAE,GAAG;QACJ,MAAM,CAAC,KAAK,MAAM,GAAG,EAAE,OAAO,CAAC;QAC/B,IAAI,UAAU,CAAC,GAAG,CAAC,KAAK;IAC5B;AACJ;AACA,MAAM,wBAAwB;IAC1B;QAAY,OAAO;YAAC;YAAG,WAAW,OAAO;SAAG;IAAE;IAC9C,GAAE,CAAC,EAAE,GAAG;QAAI,GAAG,CAAC,EAAE,GAAG,EAAE,MAAM;IAAI;IACjC,GAAE,CAAC,EAAE,GAAG;QAAI,GAAG,CAAC,EAAE,GAAG,EAAE,OAAO,CAAC;IAAa;AAChD;AACA,MAAM,uBAAuB;IACzB;QAAY,OAAO;YAAC;YAAG,MAAM,OAAO;SAAG;IAAE;IACzC,GAAE,CAAC,EAAE,GAAG;QAAI,GAAG,CAAC,EAAE,GAAG,EAAE,MAAM;IAAI;IACjC,GAAE,CAAC,EAAE,GAAG;QAAI,GAAG,CAAC,EAAE,GAAG,EAAE,OAAO,CAAC;IAAQ;AAC3C;AACO,MAAM,cAAc;IACvB;QAAY,OAAO;YAAE,MAAM;QAAO;IAAG;IACrC,GAAE,CAAC;QAAI,OAAO,EAAE,OAAO,CAAC;IAAiB;IACzC,GAAE,CAAC;QAAI,OAAO,EAAE,OAAO,CAAC;IAAe;IACvC,GAAE,CAAC;QAAI,OAAO,EAAE,OAAO,CAAC;IAAiB;IACzC,GAAE,CAAC;QAAI,OAAO;YAAE,MAAM;YAAO,KAAK,EAAE,OAAO,CAAC;QAAK;IAAG;IACpD,GAAE,CAAC;QAAI,OAAO;YAAE,MAAM;YAAS,OAAO,EAAE,OAAO,CAAC;QAAO;IAAG;AAC9D;AACA,MAAM,iBAAiB;IACnB;QAAY,OAAO;YAAE,MAAM;YAAc,MAAM;YAAG,MAAM,EAAE;QAAC;IAAG;IAC9D,GAAE,CAAC,EAAE,GAAG;QAAI,IAAI,IAAI,GAAG,EAAE,MAAM;IAAI;IACnC,GAAE,CAAC,EAAE,GAAG;QAAI,IAAI,IAAI,CAAC,IAAI,CAAC,EAAE,OAAO,CAAC;IAAO;AAC/C;AACA,MAAM,eAAe;IACjB;QACI,OAAO;YACH,MAAM;YACN,kBAAkB;YAClB,iBAAiB;QACrB;IACJ;IACA,GAAE,CAAC,EAAE,GAAG;QAAI,IAAI,gBAAgB,GAAG,EAAE,MAAM;IAAI;IAC/C,GAAE,CAAC,EAAE,GAAG;QAAI,IAAI,eAAe,GAAG,EAAE,MAAM;IAAI;AAClD;AACA,MAAM,iBAAiB;IACnB;QACI,OAAO;YACH,MAAM;YACN,MAAM;YACN,OAAO,MAAM,OAAO;QACxB;IACJ;IACA,GAAE,CAAC,EAAE,GAAG;QAAI,IAAI,IAAI,GAAG,EAAE,MAAM;IAAI;IACnC,GAAE,CAAC,EAAE,GAAG;QAAI,IAAI,KAAK,GAAG,EAAE,OAAO,CAAC;IAAQ;AAC9C;AACO,MAAM,iBAAiB;IAC1B;QACI,OAAO;YACH,QAAQ,EAAE;YACV,MAAM,EAAE;YACR,WAAW;YACX,YAAY;QAChB;IACJ;IACA,GAAE,CAAC,EAAE,GAAG;QAAI,IAAI,MAAM,CAAC,IAAI,CAAC,EAAE,OAAO,CAAC;IAAiB;IACvD,GAAE,CAAC,EAAE,GAAG;QAAI,IAAI,IAAI,CAAC,IAAI,CAAC,EAAE,OAAO,CAAC;IAAe;IACnD,GAAE,CAAC,EAAE,GAAG;QAAI,IAAI,SAAS,GAAG,EAAE,IAAI;IAAI;IACtC,GAAE,CAAC,EAAE,GAAG;QAAI,IAAI,UAAU,GAAG,EAAE,IAAI;IAAI;AAC3C;AACA,MAAM,gBAAgB;IAClB;QAAY,OAAO;YAAE,MAAM;QAAU;IAAG;IACxC,GAAE,CAAC,EAAE,GAAG;QAAI,IAAI,IAAI,GAAG,EAAE,MAAM;IAAI;AACvC;AACA,MAAM,cAAc;IAChB;QAAY,OAAO;YAAE,MAAM;YAAI,UAAU;QAAU;IAAG;IACtD,GAAE,CAAC,EAAE,GAAG;QAAI,IAAI,IAAI,GAAG,EAAE,MAAM;IAAI;IACnC,GAAE,CAAC,EAAE,GAAG;QAAI,IAAI,QAAQ,GAAG,EAAE,MAAM;IAAI;AAC3C;AACA,MAAM,QAAQ;IACV;QAAY,OAAO;IAAW;IAC9B,GAAE,CAAC;QAAI,OAAO;IAAM;IACpB,GAAE,CAAC;QAAI,OAAO,EAAE,MAAM;IAAI;IAC1B,GAAE,CAAC;QAAI,OAAO,EAAE,MAAM;IAAI;IAC1B,GAAE,CAAC;QAAI,OAAO,EAAE,MAAM;IAAI;IAC1B,GAAE,CAAC;QAAI,OAAO,EAAE,KAAK;IAAI;AAC7B","ignoreList":[0]}},
    {"offset": {"line": 2529, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/node_modules/@libsql/hrana-client/lib-esm/ws/protobuf_decode.js"],"sourcesContent":["import { Error, StmtResult, BatchResult, CursorEntry, DescribeResult } from \"../shared/protobuf_decode.js\";\nexport const ServerMsg = {\n    default() { return { type: \"none\" }; },\n    1(r) { return { type: \"hello_ok\" }; },\n    2(r) { return r.message(HelloErrorMsg); },\n    3(r) { return r.message(ResponseOkMsg); },\n    4(r) { return r.message(ResponseErrorMsg); },\n};\nconst HelloErrorMsg = {\n    default() { return { type: \"hello_error\", error: Error.default() }; },\n    1(r, msg) { msg.error = r.message(Error); },\n};\nconst ResponseErrorMsg = {\n    default() { return { type: \"response_error\", requestId: 0, error: Error.default() }; },\n    1(r, msg) { msg.requestId = r.int32(); },\n    2(r, msg) { msg.error = r.message(Error); },\n};\nconst ResponseOkMsg = {\n    default() {\n        return {\n            type: \"response_ok\",\n            requestId: 0,\n            response: { type: \"none\" },\n        };\n    },\n    1(r, msg) { msg.requestId = r.int32(); },\n    2(r, msg) { msg.response = { type: \"open_stream\" }; },\n    3(r, msg) { msg.response = { type: \"close_stream\" }; },\n    4(r, msg) { msg.response = r.message(ExecuteResp); },\n    5(r, msg) { msg.response = r.message(BatchResp); },\n    6(r, msg) { msg.response = { type: \"open_cursor\" }; },\n    7(r, msg) { msg.response = { type: \"close_cursor\" }; },\n    8(r, msg) { msg.response = r.message(FetchCursorResp); },\n    9(r, msg) { msg.response = { type: \"sequence\" }; },\n    10(r, msg) { msg.response = r.message(DescribeResp); },\n    11(r, msg) { msg.response = { type: \"store_sql\" }; },\n    12(r, msg) { msg.response = { type: \"close_sql\" }; },\n    13(r, msg) { msg.response = r.message(GetAutocommitResp); },\n};\nconst ExecuteResp = {\n    default() { return { type: \"execute\", result: StmtResult.default() }; },\n    1(r, msg) { msg.result = r.message(StmtResult); },\n};\nconst BatchResp = {\n    default() { return { type: \"batch\", result: BatchResult.default() }; },\n    1(r, msg) { msg.result = r.message(BatchResult); },\n};\nconst FetchCursorResp = {\n    default() { return { type: \"fetch_cursor\", entries: [], done: false }; },\n    1(r, msg) { msg.entries.push(r.message(CursorEntry)); },\n    2(r, msg) { msg.done = r.bool(); },\n};\nconst DescribeResp = {\n    default() { return { type: \"describe\", result: DescribeResult.default() }; },\n    1(r, msg) { msg.result = r.message(DescribeResult); },\n};\nconst GetAutocommitResp = {\n    default() { return { type: \"get_autocommit\", isAutocommit: false }; },\n    1(r, msg) { msg.isAutocommit = r.bool(); },\n};\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 2709, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/node_modules/@libsql/hrana-client/lib-esm/ws/client.js"],"sourcesContent":["import { Client } from \"../client.js\";\nimport { readJsonObject, writeJsonObject, readProtobufMessage, writeProtobufMessage, } from \"../encoding/index.js\";\nimport { ClientError, ProtoError, ClosedError, WebSocketError, ProtocolVersionError, InternalError, } from \"../errors.js\";\nimport { IdAlloc } from \"../id_alloc.js\";\nimport { errorFromProto } from \"../result.js\";\nimport { Sql } from \"../sql.js\";\nimport { impossible } from \"../util.js\";\nimport { WsStream } from \"./stream.js\";\nimport { ClientMsg as json_ClientMsg } from \"./json_encode.js\";\nimport { ClientMsg as protobuf_ClientMsg } from \"./protobuf_encode.js\";\nimport { ServerMsg as json_ServerMsg } from \"./json_decode.js\";\nimport { ServerMsg as protobuf_ServerMsg } from \"./protobuf_decode.js\";\nexport const subprotocolsV2 = new Map([\n    [\"hrana2\", { version: 2, encoding: \"json\" }],\n    [\"hrana1\", { version: 1, encoding: \"json\" }],\n]);\nexport const subprotocolsV3 = new Map([\n    [\"hrana3-protobuf\", { version: 3, encoding: \"protobuf\" }],\n    [\"hrana3\", { version: 3, encoding: \"json\" }],\n    [\"hrana2\", { version: 2, encoding: \"json\" }],\n    [\"hrana1\", { version: 1, encoding: \"json\" }],\n]);\n/** A client for the Hrana protocol over a WebSocket. */\nexport class WsClient extends Client {\n    #socket;\n    // List of callbacks that we queue until the socket transitions from the CONNECTING to the OPEN state.\n    #openCallbacks;\n    // Have we already transitioned from CONNECTING to OPEN and fired the callbacks in #openCallbacks?\n    #opened;\n    // Stores the error that caused us to close the client (and the socket). If we are not closed, this is\n    // `undefined`.\n    #closed;\n    // Have we received a response to our \"hello\" from the server?\n    #recvdHello;\n    // Subprotocol negotiated with the server. It is only available after the socket transitions to the OPEN\n    // state.\n    #subprotocol;\n    // Has the `getVersion()` function been called? This is only used to validate that the API is used\n    // correctly.\n    #getVersionCalled;\n    // A map from request id to the responses that we expect to receive from the server.\n    #responseMap;\n    // An allocator of request ids.\n    #requestIdAlloc;\n    // An allocator of stream ids.\n    /** @private */\n    _streamIdAlloc;\n    // An allocator of cursor ids.\n    /** @private */\n    _cursorIdAlloc;\n    // An allocator of SQL text ids.\n    #sqlIdAlloc;\n    /** @private */\n    constructor(socket, jwt) {\n        super();\n        this.#socket = socket;\n        this.#openCallbacks = [];\n        this.#opened = false;\n        this.#closed = undefined;\n        this.#recvdHello = false;\n        this.#subprotocol = undefined;\n        this.#getVersionCalled = false;\n        this.#responseMap = new Map();\n        this.#requestIdAlloc = new IdAlloc();\n        this._streamIdAlloc = new IdAlloc();\n        this._cursorIdAlloc = new IdAlloc();\n        this.#sqlIdAlloc = new IdAlloc();\n        this.#socket.binaryType = \"arraybuffer\";\n        this.#socket.addEventListener(\"open\", () => this.#onSocketOpen());\n        this.#socket.addEventListener(\"close\", (event) => this.#onSocketClose(event));\n        this.#socket.addEventListener(\"error\", (event) => this.#onSocketError(event));\n        this.#socket.addEventListener(\"message\", (event) => this.#onSocketMessage(event));\n        this.#send({ type: \"hello\", jwt });\n    }\n    // Send (or enqueue to send) a message to the server.\n    #send(msg) {\n        if (this.#closed !== undefined) {\n            throw new InternalError(\"Trying to send a message on a closed client\");\n        }\n        if (this.#opened) {\n            this.#sendToSocket(msg);\n        }\n        else {\n            const openCallback = () => this.#sendToSocket(msg);\n            const errorCallback = () => undefined;\n            this.#openCallbacks.push({ openCallback, errorCallback });\n        }\n    }\n    // The socket transitioned from CONNECTING to OPEN\n    #onSocketOpen() {\n        const protocol = this.#socket.protocol;\n        if (protocol === undefined) {\n            this.#setClosed(new ClientError(\"The `WebSocket.protocol` property is undefined. This most likely means that the WebSocket \" +\n                \"implementation provided by the environment is broken. If you are using Miniflare 2, \" +\n                \"please update to Miniflare 3, which fixes this problem.\"));\n            return;\n        }\n        else if (protocol === \"\") {\n            this.#subprotocol = { version: 1, encoding: \"json\" };\n        }\n        else {\n            this.#subprotocol = subprotocolsV3.get(protocol);\n            if (this.#subprotocol === undefined) {\n                this.#setClosed(new ProtoError(`Unrecognized WebSocket subprotocol: ${JSON.stringify(protocol)}`));\n                return;\n            }\n        }\n        for (const callbacks of this.#openCallbacks) {\n            callbacks.openCallback();\n        }\n        this.#openCallbacks.length = 0;\n        this.#opened = true;\n    }\n    #sendToSocket(msg) {\n        const encoding = this.#subprotocol.encoding;\n        if (encoding === \"json\") {\n            const jsonMsg = writeJsonObject(msg, json_ClientMsg);\n            this.#socket.send(jsonMsg);\n        }\n        else if (encoding === \"protobuf\") {\n            const protobufMsg = writeProtobufMessage(msg, protobuf_ClientMsg);\n            this.#socket.send(protobufMsg);\n        }\n        else {\n            throw impossible(encoding, \"Impossible encoding\");\n        }\n    }\n    /** Get the protocol version negotiated with the server, possibly waiting until the socket is open. */\n    getVersion() {\n        return new Promise((versionCallback, errorCallback) => {\n            this.#getVersionCalled = true;\n            if (this.#closed !== undefined) {\n                errorCallback(this.#closed);\n            }\n            else if (!this.#opened) {\n                const openCallback = () => versionCallback(this.#subprotocol.version);\n                this.#openCallbacks.push({ openCallback, errorCallback });\n            }\n            else {\n                versionCallback(this.#subprotocol.version);\n            }\n        });\n    }\n    // Make sure that the negotiated version is at least `minVersion`.\n    /** @private */\n    _ensureVersion(minVersion, feature) {\n        if (this.#subprotocol === undefined || !this.#getVersionCalled) {\n            throw new ProtocolVersionError(`${feature} is supported only on protocol version ${minVersion} and higher, ` +\n                \"but the version supported by the WebSocket server is not yet known. \" +\n                \"Use Client.getVersion() to wait until the version is available.\");\n        }\n        else if (this.#subprotocol.version < minVersion) {\n            throw new ProtocolVersionError(`${feature} is supported on protocol version ${minVersion} and higher, ` +\n                `but the WebSocket server only supports version ${this.#subprotocol.version}`);\n        }\n    }\n    // Send a request to the server and invoke a callback when we get the response.\n    /** @private */\n    _sendRequest(request, callbacks) {\n        if (this.#closed !== undefined) {\n            callbacks.errorCallback(new ClosedError(\"Client is closed\", this.#closed));\n            return;\n        }\n        const requestId = this.#requestIdAlloc.alloc();\n        this.#responseMap.set(requestId, { ...callbacks, type: request.type });\n        this.#send({ type: \"request\", requestId, request });\n    }\n    // The socket encountered an error.\n    #onSocketError(event) {\n        const eventMessage = event.message;\n        const message = eventMessage ?? \"WebSocket was closed due to an error\";\n        this.#setClosed(new WebSocketError(message));\n    }\n    // The socket was closed.\n    #onSocketClose(event) {\n        let message = `WebSocket was closed with code ${event.code}`;\n        if (event.reason) {\n            message += `: ${event.reason}`;\n        }\n        this.#setClosed(new WebSocketError(message));\n    }\n    // Close the client with the given error.\n    #setClosed(error) {\n        if (this.#closed !== undefined) {\n            return;\n        }\n        this.#closed = error;\n        for (const callbacks of this.#openCallbacks) {\n            callbacks.errorCallback(error);\n        }\n        this.#openCallbacks.length = 0;\n        for (const [requestId, responseState] of this.#responseMap.entries()) {\n            responseState.errorCallback(error);\n            this.#requestIdAlloc.free(requestId);\n        }\n        this.#responseMap.clear();\n        this.#socket.close();\n    }\n    // We received a message from the socket.\n    #onSocketMessage(event) {\n        if (this.#closed !== undefined) {\n            return;\n        }\n        try {\n            let msg;\n            const encoding = this.#subprotocol.encoding;\n            if (encoding === \"json\") {\n                if (typeof event.data !== \"string\") {\n                    this.#socket.close(3003, \"Only text messages are accepted with JSON encoding\");\n                    this.#setClosed(new ProtoError(\"Received non-text message from server with JSON encoding\"));\n                    return;\n                }\n                msg = readJsonObject(JSON.parse(event.data), json_ServerMsg);\n            }\n            else if (encoding === \"protobuf\") {\n                if (!(event.data instanceof ArrayBuffer)) {\n                    this.#socket.close(3003, \"Only binary messages are accepted with Protobuf encoding\");\n                    this.#setClosed(new ProtoError(\"Received non-binary message from server with Protobuf encoding\"));\n                    return;\n                }\n                msg = readProtobufMessage(new Uint8Array(event.data), protobuf_ServerMsg);\n            }\n            else {\n                throw impossible(encoding, \"Impossible encoding\");\n            }\n            this.#handleMsg(msg);\n        }\n        catch (e) {\n            this.#socket.close(3007, \"Could not handle message\");\n            this.#setClosed(e);\n        }\n    }\n    // Handle a message from the server.\n    #handleMsg(msg) {\n        if (msg.type === \"none\") {\n            throw new ProtoError(\"Received an unrecognized ServerMsg\");\n        }\n        else if (msg.type === \"hello_ok\" || msg.type === \"hello_error\") {\n            if (this.#recvdHello) {\n                throw new ProtoError(\"Received a duplicated hello response\");\n            }\n            this.#recvdHello = true;\n            if (msg.type === \"hello_error\") {\n                throw errorFromProto(msg.error);\n            }\n            return;\n        }\n        else if (!this.#recvdHello) {\n            throw new ProtoError(\"Received a non-hello message before a hello response\");\n        }\n        if (msg.type === \"response_ok\") {\n            const requestId = msg.requestId;\n            const responseState = this.#responseMap.get(requestId);\n            this.#responseMap.delete(requestId);\n            if (responseState === undefined) {\n                throw new ProtoError(\"Received unexpected OK response\");\n            }\n            this.#requestIdAlloc.free(requestId);\n            try {\n                if (responseState.type !== msg.response.type) {\n                    console.dir({ responseState, msg });\n                    throw new ProtoError(\"Received unexpected type of response\");\n                }\n                responseState.responseCallback(msg.response);\n            }\n            catch (e) {\n                responseState.errorCallback(e);\n                throw e;\n            }\n        }\n        else if (msg.type === \"response_error\") {\n            const requestId = msg.requestId;\n            const responseState = this.#responseMap.get(requestId);\n            this.#responseMap.delete(requestId);\n            if (responseState === undefined) {\n                throw new ProtoError(\"Received unexpected error response\");\n            }\n            this.#requestIdAlloc.free(requestId);\n            responseState.errorCallback(errorFromProto(msg.error));\n        }\n        else {\n            throw impossible(msg, \"Impossible ServerMsg type\");\n        }\n    }\n    /** Open a {@link WsStream}, a stream for executing SQL statements. */\n    openStream() {\n        return WsStream.open(this);\n    }\n    /** Cache a SQL text on the server. This requires protocol version 2 or higher. */\n    storeSql(sql) {\n        this._ensureVersion(2, \"storeSql()\");\n        const sqlId = this.#sqlIdAlloc.alloc();\n        const sqlObj = new Sql(this, sqlId);\n        const responseCallback = () => undefined;\n        const errorCallback = (e) => sqlObj._setClosed(e);\n        const request = { type: \"store_sql\", sqlId, sql };\n        this._sendRequest(request, { responseCallback, errorCallback });\n        return sqlObj;\n    }\n    /** @private */\n    _closeSql(sqlId) {\n        if (this.#closed !== undefined) {\n            return;\n        }\n        const responseCallback = () => this.#sqlIdAlloc.free(sqlId);\n        const errorCallback = (e) => this.#setClosed(e);\n        const request = { type: \"close_sql\", sqlId };\n        this._sendRequest(request, { responseCallback, errorCallback });\n    }\n    /** Close the client and the WebSocket. */\n    close() {\n        this.#setClosed(new ClientError(\"Client was manually closed\"));\n    }\n    /** True if the client is closed. */\n    get closed() {\n        return this.#closed !== undefined;\n    }\n}\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 3093, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/node_modules/@libsql/hrana-client/lib-esm/queue_microtask.js"],"sourcesContent":["// queueMicrotask() ponyfill\n// https://github.com/libsql/libsql-client-ts/issues/47\nlet _queueMicrotask;\nif (typeof queueMicrotask !== \"undefined\") {\n    _queueMicrotask = queueMicrotask;\n}\nelse {\n    const resolved = Promise.resolve();\n    _queueMicrotask = (callback) => {\n        resolved.then(callback);\n    };\n}\nexport { _queueMicrotask as queueMicrotask };\n"],"names":[],"mappings":";;;;AAAA,4BAA4B;AAC5B,uDAAuD;AACvD,IAAI;AACJ,IAAI,OAAO,mBAAmB,aAAa;IACvC,kBAAkB;AACtB,OACK;IACD,MAAM,WAAW,QAAQ,OAAO;IAChC,kBAAkB,CAAC;QACf,SAAS,IAAI,CAAC;IAClB;AACJ","ignoreList":[0]}},
    {"offset": {"line": 3113, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/node_modules/@libsql/hrana-client/lib-esm/byte_queue.js"],"sourcesContent":["export class ByteQueue {\n    #array;\n    #shiftPos;\n    #pushPos;\n    constructor(initialCap) {\n        this.#array = new Uint8Array(new ArrayBuffer(initialCap));\n        this.#shiftPos = 0;\n        this.#pushPos = 0;\n    }\n    get length() {\n        return this.#pushPos - this.#shiftPos;\n    }\n    data() {\n        return this.#array.slice(this.#shiftPos, this.#pushPos);\n    }\n    push(chunk) {\n        this.#ensurePush(chunk.byteLength);\n        this.#array.set(chunk, this.#pushPos);\n        this.#pushPos += chunk.byteLength;\n    }\n    #ensurePush(pushLength) {\n        if (this.#pushPos + pushLength <= this.#array.byteLength) {\n            return;\n        }\n        const filledLength = this.#pushPos - this.#shiftPos;\n        if (filledLength + pushLength <= this.#array.byteLength &&\n            2 * this.#pushPos >= this.#array.byteLength) {\n            this.#array.copyWithin(0, this.#shiftPos, this.#pushPos);\n        }\n        else {\n            let newCap = this.#array.byteLength;\n            do {\n                newCap *= 2;\n            } while (filledLength + pushLength > newCap);\n            const newArray = new Uint8Array(new ArrayBuffer(newCap));\n            newArray.set(this.#array.slice(this.#shiftPos, this.#pushPos), 0);\n            this.#array = newArray;\n        }\n        this.#pushPos = filledLength;\n        this.#shiftPos = 0;\n    }\n    shift(length) {\n        this.#shiftPos += length;\n    }\n}\n"],"names":[],"mappings":";;;;AAAO,MAAM;IACT,CAAA,KAAM,CAAC;IACP,CAAA,QAAS,CAAC;IACV,CAAA,OAAQ,CAAC;IACT,YAAY,UAAU,CAAE;QACpB,IAAI,CAAC,CAAA,KAAM,GAAG,IAAI,WAAW,IAAI,YAAY;QAC7C,IAAI,CAAC,CAAA,QAAS,GAAG;QACjB,IAAI,CAAC,CAAA,OAAQ,GAAG;IACpB;IACA,IAAI,SAAS;QACT,OAAO,IAAI,CAAC,CAAA,OAAQ,GAAG,IAAI,CAAC,CAAA,QAAS;IACzC;IACA,OAAO;QACH,OAAO,IAAI,CAAC,CAAA,KAAM,CAAC,KAAK,CAAC,IAAI,CAAC,CAAA,QAAS,EAAE,IAAI,CAAC,CAAA,OAAQ;IAC1D;IACA,KAAK,KAAK,EAAE;QACR,IAAI,CAAC,CAAA,UAAW,CAAC,MAAM,UAAU;QACjC,IAAI,CAAC,CAAA,KAAM,CAAC,GAAG,CAAC,OAAO,IAAI,CAAC,CAAA,OAAQ;QACpC,IAAI,CAAC,CAAA,OAAQ,IAAI,MAAM,UAAU;IACrC;IACA,CAAA,UAAW,CAAC,UAAU;QAClB,IAAI,IAAI,CAAC,CAAA,OAAQ,GAAG,cAAc,IAAI,CAAC,CAAA,KAAM,CAAC,UAAU,EAAE;YACtD;QACJ;QACA,MAAM,eAAe,IAAI,CAAC,CAAA,OAAQ,GAAG,IAAI,CAAC,CAAA,QAAS;QACnD,IAAI,eAAe,cAAc,IAAI,CAAC,CAAA,KAAM,CAAC,UAAU,IACnD,IAAI,IAAI,CAAC,CAAA,OAAQ,IAAI,IAAI,CAAC,CAAA,KAAM,CAAC,UAAU,EAAE;YAC7C,IAAI,CAAC,CAAA,KAAM,CAAC,UAAU,CAAC,GAAG,IAAI,CAAC,CAAA,QAAS,EAAE,IAAI,CAAC,CAAA,OAAQ;QAC3D,OACK;YACD,IAAI,SAAS,IAAI,CAAC,CAAA,KAAM,CAAC,UAAU;YACnC,GAAG;gBACC,UAAU;YACd,QAAS,eAAe,aAAa,OAAQ;YAC7C,MAAM,WAAW,IAAI,WAAW,IAAI,YAAY;YAChD,SAAS,GAAG,CAAC,IAAI,CAAC,CAAA,KAAM,CAAC,KAAK,CAAC,IAAI,CAAC,CAAA,QAAS,EAAE,IAAI,CAAC,CAAA,OAAQ,GAAG;YAC/D,IAAI,CAAC,CAAA,KAAM,GAAG;QAClB;QACA,IAAI,CAAC,CAAA,OAAQ,GAAG;QAChB,IAAI,CAAC,CAAA,QAAS,GAAG;IACrB;IACA,MAAM,MAAM,EAAE;QACV,IAAI,CAAC,CAAA,QAAS,IAAI;IACtB;AACJ","ignoreList":[0]}},
    {"offset": {"line": 3164, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/node_modules/@libsql/hrana-client/lib-esm/http/json_decode.js"],"sourcesContent":["import { ProtoError } from \"../errors.js\";\nimport * as d from \"../encoding/json/decode.js\";\nimport { Error, StmtResult, BatchResult, DescribeResult } from \"../shared/json_decode.js\";\nexport function PipelineRespBody(obj) {\n    const baton = d.stringOpt(obj[\"baton\"]);\n    const baseUrl = d.stringOpt(obj[\"base_url\"]);\n    const results = d.arrayObjectsMap(obj[\"results\"], StreamResult);\n    return { baton, baseUrl, results };\n}\nfunction StreamResult(obj) {\n    const type = d.string(obj[\"type\"]);\n    if (type === \"ok\") {\n        const response = StreamResponse(d.object(obj[\"response\"]));\n        return { type: \"ok\", response };\n    }\n    else if (type === \"error\") {\n        const error = Error(d.object(obj[\"error\"]));\n        return { type: \"error\", error };\n    }\n    else {\n        throw new ProtoError(\"Unexpected type of StreamResult\");\n    }\n}\nfunction StreamResponse(obj) {\n    const type = d.string(obj[\"type\"]);\n    if (type === \"close\") {\n        return { type: \"close\" };\n    }\n    else if (type === \"execute\") {\n        const result = StmtResult(d.object(obj[\"result\"]));\n        return { type: \"execute\", result };\n    }\n    else if (type === \"batch\") {\n        const result = BatchResult(d.object(obj[\"result\"]));\n        return { type: \"batch\", result };\n    }\n    else if (type === \"sequence\") {\n        return { type: \"sequence\" };\n    }\n    else if (type === \"describe\") {\n        const result = DescribeResult(d.object(obj[\"result\"]));\n        return { type: \"describe\", result };\n    }\n    else if (type === \"store_sql\") {\n        return { type: \"store_sql\" };\n    }\n    else if (type === \"close_sql\") {\n        return { type: \"close_sql\" };\n    }\n    else if (type === \"get_autocommit\") {\n        const isAutocommit = d.boolean(obj[\"is_autocommit\"]);\n        return { type: \"get_autocommit\", isAutocommit };\n    }\n    else {\n        throw new ProtoError(\"Unexpected type of StreamResponse\");\n    }\n}\nexport function CursorRespBody(obj) {\n    const baton = d.stringOpt(obj[\"baton\"]);\n    const baseUrl = d.stringOpt(obj[\"base_url\"]);\n    return { baton, baseUrl };\n}\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AACA;;;;AACO,SAAS,iBAAiB,GAAG;IAChC,MAAM,QAAQ,4MAAW,CAAC,GAAG,CAAC,QAAQ;IACtC,MAAM,UAAU,4MAAW,CAAC,GAAG,CAAC,WAAW;IAC3C,MAAM,UAAU,kNAAiB,CAAC,GAAG,CAAC,UAAU,EAAE;IAClD,OAAO;QAAE;QAAO;QAAS;IAAQ;AACrC;AACA,SAAS,aAAa,GAAG;IACrB,MAAM,OAAO,yMAAQ,CAAC,GAAG,CAAC,OAAO;IACjC,IAAI,SAAS,MAAM;QACf,MAAM,WAAW,eAAe,yMAAQ,CAAC,GAAG,CAAC,WAAW;QACxD,OAAO;YAAE,MAAM;YAAM;QAAS;IAClC,OACK,IAAI,SAAS,SAAS;QACvB,MAAM,QAAQ,IAAA,mMAAK,EAAC,yMAAQ,CAAC,GAAG,CAAC,QAAQ;QACzC,OAAO;YAAE,MAAM;YAAS;QAAM;IAClC,OACK;QACD,MAAM,IAAI,yLAAU,CAAC;IACzB;AACJ;AACA,SAAS,eAAe,GAAG;IACvB,MAAM,OAAO,yMAAQ,CAAC,GAAG,CAAC,OAAO;IACjC,IAAI,SAAS,SAAS;QAClB,OAAO;YAAE,MAAM;QAAQ;IAC3B,OACK,IAAI,SAAS,WAAW;QACzB,MAAM,SAAS,IAAA,wMAAU,EAAC,yMAAQ,CAAC,GAAG,CAAC,SAAS;QAChD,OAAO;YAAE,MAAM;YAAW;QAAO;IACrC,OACK,IAAI,SAAS,SAAS;QACvB,MAAM,SAAS,IAAA,yMAAW,EAAC,yMAAQ,CAAC,GAAG,CAAC,SAAS;QACjD,OAAO;YAAE,MAAM;YAAS;QAAO;IACnC,OACK,IAAI,SAAS,YAAY;QAC1B,OAAO;YAAE,MAAM;QAAW;IAC9B,OACK,IAAI,SAAS,YAAY;QAC1B,MAAM,SAAS,IAAA,4MAAc,EAAC,yMAAQ,CAAC,GAAG,CAAC,SAAS;QACpD,OAAO;YAAE,MAAM;YAAY;QAAO;IACtC,OACK,IAAI,SAAS,aAAa;QAC3B,OAAO;YAAE,MAAM;QAAY;IAC/B,OACK,IAAI,SAAS,aAAa;QAC3B,OAAO;YAAE,MAAM;QAAY;IAC/B,OACK,IAAI,SAAS,kBAAkB;QAChC,MAAM,eAAe,0MAAS,CAAC,GAAG,CAAC,gBAAgB;QACnD,OAAO;YAAE,MAAM;YAAkB;QAAa;IAClD,OACK;QACD,MAAM,IAAI,yLAAU,CAAC;IACzB;AACJ;AACO,SAAS,eAAe,GAAG;IAC9B,MAAM,QAAQ,4MAAW,CAAC,GAAG,CAAC,QAAQ;IACtC,MAAM,UAAU,4MAAW,CAAC,GAAG,CAAC,WAAW;IAC3C,OAAO;QAAE;QAAO;IAAQ;AAC5B","ignoreList":[0]}},
    {"offset": {"line": 3262, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/node_modules/@libsql/hrana-client/lib-esm/http/protobuf_decode.js"],"sourcesContent":["import { Error, StmtResult, BatchResult, DescribeResult } from \"../shared/protobuf_decode.js\";\nexport const PipelineRespBody = {\n    default() { return { baton: undefined, baseUrl: undefined, results: [] }; },\n    1(r, msg) { msg.baton = r.string(); },\n    2(r, msg) { msg.baseUrl = r.string(); },\n    3(r, msg) { msg.results.push(r.message(StreamResult)); },\n};\nconst StreamResult = {\n    default() { return { type: \"none\" }; },\n    1(r) { return { type: \"ok\", response: r.message(StreamResponse) }; },\n    2(r) { return { type: \"error\", error: r.message(Error) }; },\n};\nconst StreamResponse = {\n    default() { return { type: \"none\" }; },\n    1(r) { return { type: \"close\" }; },\n    2(r) { return r.message(ExecuteStreamResp); },\n    3(r) { return r.message(BatchStreamResp); },\n    4(r) { return { type: \"sequence\" }; },\n    5(r) { return r.message(DescribeStreamResp); },\n    6(r) { return { type: \"store_sql\" }; },\n    7(r) { return { type: \"close_sql\" }; },\n    8(r) { return r.message(GetAutocommitStreamResp); },\n};\nconst ExecuteStreamResp = {\n    default() { return { type: \"execute\", result: StmtResult.default() }; },\n    1(r, msg) { msg.result = r.message(StmtResult); },\n};\nconst BatchStreamResp = {\n    default() { return { type: \"batch\", result: BatchResult.default() }; },\n    1(r, msg) { msg.result = r.message(BatchResult); },\n};\nconst DescribeStreamResp = {\n    default() { return { type: \"describe\", result: DescribeResult.default() }; },\n    1(r, msg) { msg.result = r.message(DescribeResult); },\n};\nconst GetAutocommitStreamResp = {\n    default() { return { type: \"get_autocommit\", isAutocommit: false }; },\n    1(r, msg) { msg.isAutocommit = r.bool(); },\n};\nexport const CursorRespBody = {\n    default() { return { baton: undefined, baseUrl: undefined }; },\n    1(r, msg) { msg.baton = r.string(); },\n    2(r, msg) { msg.baseUrl = r.string(); },\n};\n"],"names":[],"mappings":";;;;;;AAAA;;AACO,MAAM,mBAAmB;IAC5B;QAAY,OAAO;YAAE,OAAO;YAAW,SAAS;YAAW,SAAS,EAAE;QAAC;IAAG;IAC1E,GAAE,CAAC,EAAE,GAAG;QAAI,IAAI,KAAK,GAAG,EAAE,MAAM;IAAI;IACpC,GAAE,CAAC,EAAE,GAAG;QAAI,IAAI,OAAO,GAAG,EAAE,MAAM;IAAI;IACtC,GAAE,CAAC,EAAE,GAAG;QAAI,IAAI,OAAO,CAAC,IAAI,CAAC,EAAE,OAAO,CAAC;IAAgB;AAC3D;AACA,MAAM,eAAe;IACjB;QAAY,OAAO;YAAE,MAAM;QAAO;IAAG;IACrC,GAAE,CAAC;QAAI,OAAO;YAAE,MAAM;YAAM,UAAU,EAAE,OAAO,CAAC;QAAgB;IAAG;IACnE,GAAE,CAAC;QAAI,OAAO;YAAE,MAAM;YAAS,OAAO,EAAE,OAAO,CAAC,uMAAK;QAAE;IAAG;AAC9D;AACA,MAAM,iBAAiB;IACnB;QAAY,OAAO;YAAE,MAAM;QAAO;IAAG;IACrC,GAAE,CAAC;QAAI,OAAO;YAAE,MAAM;QAAQ;IAAG;IACjC,GAAE,CAAC;QAAI,OAAO,EAAE,OAAO,CAAC;IAAoB;IAC5C,GAAE,CAAC;QAAI,OAAO,EAAE,OAAO,CAAC;IAAkB;IAC1C,GAAE,CAAC;QAAI,OAAO;YAAE,MAAM;QAAW;IAAG;IACpC,GAAE,CAAC;QAAI,OAAO,EAAE,OAAO,CAAC;IAAqB;IAC7C,GAAE,CAAC;QAAI,OAAO;YAAE,MAAM;QAAY;IAAG;IACrC,GAAE,CAAC;QAAI,OAAO;YAAE,MAAM;QAAY;IAAG;IACrC,GAAE,CAAC;QAAI,OAAO,EAAE,OAAO,CAAC;IAA0B;AACtD;AACA,MAAM,oBAAoB;IACtB;QAAY,OAAO;YAAE,MAAM;YAAW,QAAQ,4MAAU,CAAC,OAAO;QAAG;IAAG;IACtE,GAAE,CAAC,EAAE,GAAG;QAAI,IAAI,MAAM,GAAG,EAAE,OAAO,CAAC,4MAAU;IAAG;AACpD;AACA,MAAM,kBAAkB;IACpB;QAAY,OAAO;YAAE,MAAM;YAAS,QAAQ,6MAAW,CAAC,OAAO;QAAG;IAAG;IACrE,GAAE,CAAC,EAAE,GAAG;QAAI,IAAI,MAAM,GAAG,EAAE,OAAO,CAAC,6MAAW;IAAG;AACrD;AACA,MAAM,qBAAqB;IACvB;QAAY,OAAO;YAAE,MAAM;YAAY,QAAQ,gNAAc,CAAC,OAAO;QAAG;IAAG;IAC3E,GAAE,CAAC,EAAE,GAAG;QAAI,IAAI,MAAM,GAAG,EAAE,OAAO,CAAC,gNAAc;IAAG;AACxD;AACA,MAAM,0BAA0B;IAC5B;QAAY,OAAO;YAAE,MAAM;YAAkB,cAAc;QAAM;IAAG;IACpE,GAAE,CAAC,EAAE,GAAG;QAAI,IAAI,YAAY,GAAG,EAAE,IAAI;IAAI;AAC7C;AACO,MAAM,iBAAiB;IAC1B;QAAY,OAAO;YAAE,OAAO;YAAW,SAAS;QAAU;IAAG;IAC7D,GAAE,CAAC,EAAE,GAAG;QAAI,IAAI,KAAK,GAAG,EAAE,MAAM;IAAI;IACpC,GAAE,CAAC,EAAE,GAAG;QAAI,IAAI,OAAO,GAAG,EAAE,MAAM;IAAI;AAC1C","ignoreList":[0]}},
    {"offset": {"line": 3408, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/node_modules/@libsql/hrana-client/lib-esm/http/cursor.js"],"sourcesContent":["import { ByteQueue } from \"../byte_queue.js\";\nimport { Cursor } from \"../cursor.js\";\nimport * as jsond from \"../encoding/json/decode.js\";\nimport * as protobufd from \"../encoding/protobuf/decode.js\";\nimport { ClientError, ClosedError, ProtoError, InternalError } from \"../errors.js\";\nimport { impossible } from \"../util.js\";\nimport { CursorRespBody as json_CursorRespBody } from \"./json_decode.js\";\nimport { CursorRespBody as protobuf_CursorRespBody } from \"./protobuf_decode.js\";\nimport { CursorEntry as json_CursorEntry } from \"../shared/json_decode.js\";\nimport { CursorEntry as protobuf_CursorEntry } from \"../shared/protobuf_decode.js\";\nexport class HttpCursor extends Cursor {\n    #stream;\n    #encoding;\n    #reader;\n    #queue;\n    #closed;\n    #done;\n    /** @private */\n    constructor(stream, encoding) {\n        super();\n        this.#stream = stream;\n        this.#encoding = encoding;\n        this.#reader = undefined;\n        this.#queue = new ByteQueue(16 * 1024);\n        this.#closed = undefined;\n        this.#done = false;\n    }\n    async open(response) {\n        if (response.body === null) {\n            throw new ProtoError(\"No response body for cursor request\");\n        }\n        // node-fetch do not fully support WebStream API, especially getReader() function\n        // see https://github.com/node-fetch/node-fetch/issues/387\n        // so, we are using async iterator which behaves similarly here instead\n        this.#reader = response.body[Symbol.asyncIterator]();\n        const respBody = await this.#nextItem(json_CursorRespBody, protobuf_CursorRespBody);\n        if (respBody === undefined) {\n            throw new ProtoError(\"Empty response to cursor request\");\n        }\n        return respBody;\n    }\n    /** Fetch the next entry from the cursor. */\n    next() {\n        return this.#nextItem(json_CursorEntry, protobuf_CursorEntry);\n    }\n    /** Close the cursor. */\n    close() {\n        this._setClosed(new ClientError(\"Cursor was manually closed\"));\n    }\n    /** @private */\n    _setClosed(error) {\n        if (this.#closed !== undefined) {\n            return;\n        }\n        this.#closed = error;\n        this.#stream._cursorClosed(this);\n        if (this.#reader !== undefined) {\n            this.#reader.return();\n        }\n    }\n    /** True if the cursor is closed. */\n    get closed() {\n        return this.#closed !== undefined;\n    }\n    async #nextItem(jsonFun, protobufDef) {\n        for (;;) {\n            if (this.#done) {\n                return undefined;\n            }\n            else if (this.#closed !== undefined) {\n                throw new ClosedError(\"Cursor is closed\", this.#closed);\n            }\n            if (this.#encoding === \"json\") {\n                const jsonData = this.#parseItemJson();\n                if (jsonData !== undefined) {\n                    const jsonText = new TextDecoder().decode(jsonData);\n                    const jsonValue = JSON.parse(jsonText);\n                    return jsond.readJsonObject(jsonValue, jsonFun);\n                }\n            }\n            else if (this.#encoding === \"protobuf\") {\n                const protobufData = this.#parseItemProtobuf();\n                if (protobufData !== undefined) {\n                    return protobufd.readProtobufMessage(protobufData, protobufDef);\n                }\n            }\n            else {\n                throw impossible(this.#encoding, \"Impossible encoding\");\n            }\n            if (this.#reader === undefined) {\n                throw new InternalError(\"Attempted to read from HTTP cursor before it was opened\");\n            }\n            const { value, done } = await this.#reader.next();\n            if (done && this.#queue.length === 0) {\n                this.#done = true;\n            }\n            else if (done) {\n                throw new ProtoError(\"Unexpected end of cursor stream\");\n            }\n            else {\n                this.#queue.push(value);\n            }\n        }\n    }\n    #parseItemJson() {\n        const data = this.#queue.data();\n        const newlineByte = 10;\n        const newlinePos = data.indexOf(newlineByte);\n        if (newlinePos < 0) {\n            return undefined;\n        }\n        const jsonData = data.slice(0, newlinePos);\n        this.#queue.shift(newlinePos + 1);\n        return jsonData;\n    }\n    #parseItemProtobuf() {\n        const data = this.#queue.data();\n        let varintValue = 0;\n        let varintLength = 0;\n        for (;;) {\n            if (varintLength >= data.byteLength) {\n                return undefined;\n            }\n            const byte = data[varintLength];\n            varintValue |= (byte & 0x7f) << (7 * varintLength);\n            varintLength += 1;\n            if (!(byte & 0x80)) {\n                break;\n            }\n        }\n        if (data.byteLength < varintLength + varintValue) {\n            return undefined;\n        }\n        const protobufData = data.slice(varintLength, varintLength + varintValue);\n        this.#queue.shift(varintLength + varintValue);\n        return protobufData;\n    }\n}\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 3554, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/node_modules/@libsql/hrana-client/lib-esm/http/json_encode.js"],"sourcesContent":["import { Stmt, Batch } from \"../shared/json_encode.js\";\nimport { impossible } from \"../util.js\";\nexport function PipelineReqBody(w, msg) {\n    if (msg.baton !== undefined) {\n        w.string(\"baton\", msg.baton);\n    }\n    w.arrayObjects(\"requests\", msg.requests, StreamRequest);\n}\nfunction StreamRequest(w, msg) {\n    w.stringRaw(\"type\", msg.type);\n    if (msg.type === \"close\") {\n        // do nothing\n    }\n    else if (msg.type === \"execute\") {\n        w.object(\"stmt\", msg.stmt, Stmt);\n    }\n    else if (msg.type === \"batch\") {\n        w.object(\"batch\", msg.batch, Batch);\n    }\n    else if (msg.type === \"sequence\") {\n        if (msg.sql !== undefined) {\n            w.string(\"sql\", msg.sql);\n        }\n        if (msg.sqlId !== undefined) {\n            w.number(\"sql_id\", msg.sqlId);\n        }\n    }\n    else if (msg.type === \"describe\") {\n        if (msg.sql !== undefined) {\n            w.string(\"sql\", msg.sql);\n        }\n        if (msg.sqlId !== undefined) {\n            w.number(\"sql_id\", msg.sqlId);\n        }\n    }\n    else if (msg.type === \"store_sql\") {\n        w.number(\"sql_id\", msg.sqlId);\n        w.string(\"sql\", msg.sql);\n    }\n    else if (msg.type === \"close_sql\") {\n        w.number(\"sql_id\", msg.sqlId);\n    }\n    else if (msg.type === \"get_autocommit\") {\n        // do nothing\n    }\n    else {\n        throw impossible(msg, \"Impossible type of StreamRequest\");\n    }\n}\nexport function CursorReqBody(w, msg) {\n    if (msg.baton !== undefined) {\n        w.string(\"baton\", msg.baton);\n    }\n    w.object(\"batch\", msg.batch, Batch);\n}\n"],"names":[],"mappings":";;;;;;AAAA;AACA;;;AACO,SAAS,gBAAgB,CAAC,EAAE,GAAG;IAClC,IAAI,IAAI,KAAK,KAAK,WAAW;QACzB,EAAE,MAAM,CAAC,SAAS,IAAI,KAAK;IAC/B;IACA,EAAE,YAAY,CAAC,YAAY,IAAI,QAAQ,EAAE;AAC7C;AACA,SAAS,cAAc,CAAC,EAAE,GAAG;IACzB,EAAE,SAAS,CAAC,QAAQ,IAAI,IAAI;IAC5B,IAAI,IAAI,IAAI,KAAK,SAAS;IACtB,aAAa;IACjB,OACK,IAAI,IAAI,IAAI,KAAK,WAAW;QAC7B,EAAE,MAAM,CAAC,QAAQ,IAAI,IAAI,EAAE,kMAAI;IACnC,OACK,IAAI,IAAI,IAAI,KAAK,SAAS;QAC3B,EAAE,MAAM,CAAC,SAAS,IAAI,KAAK,EAAE,mMAAK;IACtC,OACK,IAAI,IAAI,IAAI,KAAK,YAAY;QAC9B,IAAI,IAAI,GAAG,KAAK,WAAW;YACvB,EAAE,MAAM,CAAC,OAAO,IAAI,GAAG;QAC3B;QACA,IAAI,IAAI,KAAK,KAAK,WAAW;YACzB,EAAE,MAAM,CAAC,UAAU,IAAI,KAAK;QAChC;IACJ,OACK,IAAI,IAAI,IAAI,KAAK,YAAY;QAC9B,IAAI,IAAI,GAAG,KAAK,WAAW;YACvB,EAAE,MAAM,CAAC,OAAO,IAAI,GAAG;QAC3B;QACA,IAAI,IAAI,KAAK,KAAK,WAAW;YACzB,EAAE,MAAM,CAAC,UAAU,IAAI,KAAK;QAChC;IACJ,OACK,IAAI,IAAI,IAAI,KAAK,aAAa;QAC/B,EAAE,MAAM,CAAC,UAAU,IAAI,KAAK;QAC5B,EAAE,MAAM,CAAC,OAAO,IAAI,GAAG;IAC3B,OACK,IAAI,IAAI,IAAI,KAAK,aAAa;QAC/B,EAAE,MAAM,CAAC,UAAU,IAAI,KAAK;IAChC,OACK,IAAI,IAAI,IAAI,KAAK,kBAAkB;IACpC,aAAa;IACjB,OACK;QACD,MAAM,IAAA,uLAAU,EAAC,KAAK;IAC1B;AACJ;AACO,SAAS,cAAc,CAAC,EAAE,GAAG;IAChC,IAAI,IAAI,KAAK,KAAK,WAAW;QACzB,EAAE,MAAM,CAAC,SAAS,IAAI,KAAK;IAC/B;IACA,EAAE,MAAM,CAAC,SAAS,IAAI,KAAK,EAAE,mMAAK;AACtC","ignoreList":[0]}},
    {"offset": {"line": 3613, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/node_modules/@libsql/hrana-client/lib-esm/http/protobuf_encode.js"],"sourcesContent":["import { Stmt, Batch } from \"../shared/protobuf_encode.js\";\nimport { impossible } from \"../util.js\";\nexport function PipelineReqBody(w, msg) {\n    if (msg.baton !== undefined) {\n        w.string(1, msg.baton);\n    }\n    for (const req of msg.requests) {\n        w.message(2, req, StreamRequest);\n    }\n}\nfunction StreamRequest(w, msg) {\n    if (msg.type === \"close\") {\n        w.message(1, msg, CloseStreamReq);\n    }\n    else if (msg.type === \"execute\") {\n        w.message(2, msg, ExecuteStreamReq);\n    }\n    else if (msg.type === \"batch\") {\n        w.message(3, msg, BatchStreamReq);\n    }\n    else if (msg.type === \"sequence\") {\n        w.message(4, msg, SequenceStreamReq);\n    }\n    else if (msg.type === \"describe\") {\n        w.message(5, msg, DescribeStreamReq);\n    }\n    else if (msg.type === \"store_sql\") {\n        w.message(6, msg, StoreSqlStreamReq);\n    }\n    else if (msg.type === \"close_sql\") {\n        w.message(7, msg, CloseSqlStreamReq);\n    }\n    else if (msg.type === \"get_autocommit\") {\n        w.message(8, msg, GetAutocommitStreamReq);\n    }\n    else {\n        throw impossible(msg, \"Impossible type of StreamRequest\");\n    }\n}\nfunction CloseStreamReq(_w, _msg) {\n}\nfunction ExecuteStreamReq(w, msg) {\n    w.message(1, msg.stmt, Stmt);\n}\nfunction BatchStreamReq(w, msg) {\n    w.message(1, msg.batch, Batch);\n}\nfunction SequenceStreamReq(w, msg) {\n    if (msg.sql !== undefined) {\n        w.string(1, msg.sql);\n    }\n    if (msg.sqlId !== undefined) {\n        w.int32(2, msg.sqlId);\n    }\n}\nfunction DescribeStreamReq(w, msg) {\n    if (msg.sql !== undefined) {\n        w.string(1, msg.sql);\n    }\n    if (msg.sqlId !== undefined) {\n        w.int32(2, msg.sqlId);\n    }\n}\nfunction StoreSqlStreamReq(w, msg) {\n    w.int32(1, msg.sqlId);\n    w.string(2, msg.sql);\n}\nfunction CloseSqlStreamReq(w, msg) {\n    w.int32(1, msg.sqlId);\n}\nfunction GetAutocommitStreamReq(_w, _msg) {\n}\nexport function CursorReqBody(w, msg) {\n    if (msg.baton !== undefined) {\n        w.string(1, msg.baton);\n    }\n    w.message(2, msg.batch, Batch);\n}\n"],"names":[],"mappings":";;;;;;AAAA;AACA;;;AACO,SAAS,gBAAgB,CAAC,EAAE,GAAG;IAClC,IAAI,IAAI,KAAK,KAAK,WAAW;QACzB,EAAE,MAAM,CAAC,GAAG,IAAI,KAAK;IACzB;IACA,KAAK,MAAM,OAAO,IAAI,QAAQ,CAAE;QAC5B,EAAE,OAAO,CAAC,GAAG,KAAK;IACtB;AACJ;AACA,SAAS,cAAc,CAAC,EAAE,GAAG;IACzB,IAAI,IAAI,IAAI,KAAK,SAAS;QACtB,EAAE,OAAO,CAAC,GAAG,KAAK;IACtB,OACK,IAAI,IAAI,IAAI,KAAK,WAAW;QAC7B,EAAE,OAAO,CAAC,GAAG,KAAK;IACtB,OACK,IAAI,IAAI,IAAI,KAAK,SAAS;QAC3B,EAAE,OAAO,CAAC,GAAG,KAAK;IACtB,OACK,IAAI,IAAI,IAAI,KAAK,YAAY;QAC9B,EAAE,OAAO,CAAC,GAAG,KAAK;IACtB,OACK,IAAI,IAAI,IAAI,KAAK,YAAY;QAC9B,EAAE,OAAO,CAAC,GAAG,KAAK;IACtB,OACK,IAAI,IAAI,IAAI,KAAK,aAAa;QAC/B,EAAE,OAAO,CAAC,GAAG,KAAK;IACtB,OACK,IAAI,IAAI,IAAI,KAAK,aAAa;QAC/B,EAAE,OAAO,CAAC,GAAG,KAAK;IACtB,OACK,IAAI,IAAI,IAAI,KAAK,kBAAkB;QACpC,EAAE,OAAO,CAAC,GAAG,KAAK;IACtB,OACK;QACD,MAAM,IAAA,uLAAU,EAAC,KAAK;IAC1B;AACJ;AACA,SAAS,eAAe,EAAE,EAAE,IAAI,GAChC;AACA,SAAS,iBAAiB,CAAC,EAAE,GAAG;IAC5B,EAAE,OAAO,CAAC,GAAG,IAAI,IAAI,EAAE,sMAAI;AAC/B;AACA,SAAS,eAAe,CAAC,EAAE,GAAG;IAC1B,EAAE,OAAO,CAAC,GAAG,IAAI,KAAK,EAAE,uMAAK;AACjC;AACA,SAAS,kBAAkB,CAAC,EAAE,GAAG;IAC7B,IAAI,IAAI,GAAG,KAAK,WAAW;QACvB,EAAE,MAAM,CAAC,GAAG,IAAI,GAAG;IACvB;IACA,IAAI,IAAI,KAAK,KAAK,WAAW;QACzB,EAAE,KAAK,CAAC,GAAG,IAAI,KAAK;IACxB;AACJ;AACA,SAAS,kBAAkB,CAAC,EAAE,GAAG;IAC7B,IAAI,IAAI,GAAG,KAAK,WAAW;QACvB,EAAE,MAAM,CAAC,GAAG,IAAI,GAAG;IACvB;IACA,IAAI,IAAI,KAAK,KAAK,WAAW;QACzB,EAAE,KAAK,CAAC,GAAG,IAAI,KAAK;IACxB;AACJ;AACA,SAAS,kBAAkB,CAAC,EAAE,GAAG;IAC7B,EAAE,KAAK,CAAC,GAAG,IAAI,KAAK;IACpB,EAAE,MAAM,CAAC,GAAG,IAAI,GAAG;AACvB;AACA,SAAS,kBAAkB,CAAC,EAAE,GAAG;IAC7B,EAAE,KAAK,CAAC,GAAG,IAAI,KAAK;AACxB;AACA,SAAS,uBAAuB,EAAE,EAAE,IAAI,GACxC;AACO,SAAS,cAAc,CAAC,EAAE,GAAG;IAChC,IAAI,IAAI,KAAK,KAAK,WAAW;QACzB,EAAE,MAAM,CAAC,GAAG,IAAI,KAAK;IACzB;IACA,EAAE,OAAO,CAAC,GAAG,IAAI,KAAK,EAAE,uMAAK;AACjC","ignoreList":[0]}},
    {"offset": {"line": 3693, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/node_modules/@libsql/hrana-client/lib-esm/http/stream.js"],"sourcesContent":["import { Request, Headers } from \"cross-fetch\";\nimport { ClientError, HttpServerError, ProtocolVersionError, ProtoError, ClosedError, InternalError, } from \"../errors.js\";\nimport { readJsonObject, writeJsonObject, readProtobufMessage, writeProtobufMessage, } from \"../encoding/index.js\";\nimport { IdAlloc } from \"../id_alloc.js\";\nimport { Queue } from \"../queue.js\";\nimport { queueMicrotask } from \"../queue_microtask.js\";\nimport { errorFromProto } from \"../result.js\";\nimport { Sql } from \"../sql.js\";\nimport { Stream } from \"../stream.js\";\nimport { impossible } from \"../util.js\";\nimport { HttpCursor } from \"./cursor.js\";\nimport { PipelineReqBody as json_PipelineReqBody } from \"./json_encode.js\";\nimport { PipelineReqBody as protobuf_PipelineReqBody } from \"./protobuf_encode.js\";\nimport { CursorReqBody as json_CursorReqBody } from \"./json_encode.js\";\nimport { CursorReqBody as protobuf_CursorReqBody } from \"./protobuf_encode.js\";\nimport { PipelineRespBody as json_PipelineRespBody } from \"./json_decode.js\";\nimport { PipelineRespBody as protobuf_PipelineRespBody } from \"./protobuf_decode.js\";\nexport class HttpStream extends Stream {\n    #client;\n    #baseUrl;\n    #jwt;\n    #fetch;\n    #remoteEncryptionKey;\n    #baton;\n    #queue;\n    #flushing;\n    #cursor;\n    #closing;\n    #closeQueued;\n    #closed;\n    #sqlIdAlloc;\n    /** @private */\n    constructor(client, baseUrl, jwt, customFetch, remoteEncryptionKey) {\n        super(client.intMode);\n        this.#client = client;\n        this.#baseUrl = baseUrl.toString();\n        this.#jwt = jwt;\n        this.#fetch = customFetch;\n        this.#remoteEncryptionKey = remoteEncryptionKey;\n        this.#baton = undefined;\n        this.#queue = new Queue();\n        this.#flushing = false;\n        this.#closing = false;\n        this.#closeQueued = false;\n        this.#closed = undefined;\n        this.#sqlIdAlloc = new IdAlloc();\n    }\n    /** Get the {@link HttpClient} object that this stream belongs to. */\n    client() {\n        return this.#client;\n    }\n    /** @private */\n    _sqlOwner() {\n        return this;\n    }\n    /** Cache a SQL text on the server. */\n    storeSql(sql) {\n        const sqlId = this.#sqlIdAlloc.alloc();\n        this.#sendStreamRequest({ type: \"store_sql\", sqlId, sql }).then(() => undefined, (error) => this._setClosed(error));\n        return new Sql(this, sqlId);\n    }\n    /** @private */\n    _closeSql(sqlId) {\n        if (this.#closed !== undefined) {\n            return;\n        }\n        this.#sendStreamRequest({ type: \"close_sql\", sqlId }).then(() => this.#sqlIdAlloc.free(sqlId), (error) => this._setClosed(error));\n    }\n    /** @private */\n    _execute(stmt) {\n        return this.#sendStreamRequest({ type: \"execute\", stmt }).then((response) => {\n            return response.result;\n        });\n    }\n    /** @private */\n    _batch(batch) {\n        return this.#sendStreamRequest({ type: \"batch\", batch }).then((response) => {\n            return response.result;\n        });\n    }\n    /** @private */\n    _describe(protoSql) {\n        return this.#sendStreamRequest({\n            type: \"describe\",\n            sql: protoSql.sql,\n            sqlId: protoSql.sqlId\n        }).then((response) => {\n            return response.result;\n        });\n    }\n    /** @private */\n    _sequence(protoSql) {\n        return this.#sendStreamRequest({\n            type: \"sequence\",\n            sql: protoSql.sql,\n            sqlId: protoSql.sqlId,\n        }).then((_response) => {\n            return undefined;\n        });\n    }\n    /** Check whether the SQL connection underlying this stream is in autocommit state (i.e., outside of an\n     * explicit transaction). This requires protocol version 3 or higher.\n     */\n    getAutocommit() {\n        this.#client._ensureVersion(3, \"getAutocommit()\");\n        return this.#sendStreamRequest({\n            type: \"get_autocommit\",\n        }).then((response) => {\n            return response.isAutocommit;\n        });\n    }\n    #sendStreamRequest(request) {\n        return new Promise((responseCallback, errorCallback) => {\n            this.#pushToQueue({ type: \"pipeline\", request, responseCallback, errorCallback });\n        });\n    }\n    /** @private */\n    _openCursor(batch) {\n        return new Promise((cursorCallback, errorCallback) => {\n            this.#pushToQueue({ type: \"cursor\", batch, cursorCallback, errorCallback });\n        });\n    }\n    /** @private */\n    _cursorClosed(cursor) {\n        if (cursor !== this.#cursor) {\n            throw new InternalError(\"Cursor was closed, but it was not associated with the stream\");\n        }\n        this.#cursor = undefined;\n        queueMicrotask(() => this.#flushQueue());\n    }\n    /** Immediately close the stream. */\n    close() {\n        this._setClosed(new ClientError(\"Stream was manually closed\"));\n    }\n    /** Gracefully close the stream. */\n    closeGracefully() {\n        this.#closing = true;\n        queueMicrotask(() => this.#flushQueue());\n    }\n    /** True if the stream is closed. */\n    get closed() {\n        return this.#closed !== undefined || this.#closing;\n    }\n    /** @private */\n    _setClosed(error) {\n        if (this.#closed !== undefined) {\n            return;\n        }\n        this.#closed = error;\n        if (this.#cursor !== undefined) {\n            this.#cursor._setClosed(error);\n        }\n        this.#client._streamClosed(this);\n        for (;;) {\n            const entry = this.#queue.shift();\n            if (entry !== undefined) {\n                entry.errorCallback(error);\n            }\n            else {\n                break;\n            }\n        }\n        if ((this.#baton !== undefined || this.#flushing) && !this.#closeQueued) {\n            this.#queue.push({\n                type: \"pipeline\",\n                request: { type: \"close\" },\n                responseCallback: () => undefined,\n                errorCallback: () => undefined,\n            });\n            this.#closeQueued = true;\n            queueMicrotask(() => this.#flushQueue());\n        }\n    }\n    #pushToQueue(entry) {\n        if (this.#closed !== undefined) {\n            throw new ClosedError(\"Stream is closed\", this.#closed);\n        }\n        else if (this.#closing) {\n            throw new ClosedError(\"Stream is closing\", undefined);\n        }\n        else {\n            this.#queue.push(entry);\n            queueMicrotask(() => this.#flushQueue());\n        }\n    }\n    #flushQueue() {\n        if (this.#flushing || this.#cursor !== undefined) {\n            return;\n        }\n        if (this.#closing && this.#queue.length === 0) {\n            this._setClosed(new ClientError(\"Stream was gracefully closed\"));\n            return;\n        }\n        const endpoint = this.#client._endpoint;\n        if (endpoint === undefined) {\n            this.#client._endpointPromise.then(() => this.#flushQueue(), (error) => this._setClosed(error));\n            return;\n        }\n        const firstEntry = this.#queue.shift();\n        if (firstEntry === undefined) {\n            return;\n        }\n        else if (firstEntry.type === \"pipeline\") {\n            const pipeline = [firstEntry];\n            for (;;) {\n                const entry = this.#queue.first();\n                if (entry !== undefined && entry.type === \"pipeline\") {\n                    pipeline.push(entry);\n                    this.#queue.shift();\n                }\n                else if (entry === undefined && this.#closing && !this.#closeQueued) {\n                    pipeline.push({\n                        type: \"pipeline\",\n                        request: { type: \"close\" },\n                        responseCallback: () => undefined,\n                        errorCallback: () => undefined,\n                    });\n                    this.#closeQueued = true;\n                    break;\n                }\n                else {\n                    break;\n                }\n            }\n            this.#flushPipeline(endpoint, pipeline);\n        }\n        else if (firstEntry.type === \"cursor\") {\n            this.#flushCursor(endpoint, firstEntry);\n        }\n        else {\n            throw impossible(firstEntry, \"Impossible type of QueueEntry\");\n        }\n    }\n    #flushPipeline(endpoint, pipeline) {\n        this.#flush(() => this.#createPipelineRequest(pipeline, endpoint), (resp) => decodePipelineResponse(resp, endpoint.encoding), (respBody) => respBody.baton, (respBody) => respBody.baseUrl, (respBody) => handlePipelineResponse(pipeline, respBody), (error) => pipeline.forEach((entry) => entry.errorCallback(error)));\n    }\n    #flushCursor(endpoint, entry) {\n        const cursor = new HttpCursor(this, endpoint.encoding);\n        this.#cursor = cursor;\n        this.#flush(() => this.#createCursorRequest(entry, endpoint), (resp) => cursor.open(resp), (respBody) => respBody.baton, (respBody) => respBody.baseUrl, (_respBody) => entry.cursorCallback(cursor), (error) => entry.errorCallback(error));\n    }\n    #flush(createRequest, decodeResponse, getBaton, getBaseUrl, handleResponse, handleError) {\n        let promise;\n        try {\n            const request = createRequest();\n            const fetch = this.#fetch;\n            promise = fetch(request);\n        }\n        catch (error) {\n            promise = Promise.reject(error);\n        }\n        this.#flushing = true;\n        promise.then((resp) => {\n            if (!resp.ok) {\n                return errorFromResponse(resp).then((error) => {\n                    throw error;\n                });\n            }\n            return decodeResponse(resp);\n        }).then((r) => {\n            this.#baton = getBaton(r);\n            this.#baseUrl = getBaseUrl(r) ?? this.#baseUrl;\n            handleResponse(r);\n        }).catch((error) => {\n            this._setClosed(error);\n            handleError(error);\n        }).finally(() => {\n            this.#flushing = false;\n            this.#flushQueue();\n        });\n    }\n    #createPipelineRequest(pipeline, endpoint) {\n        return this.#createRequest(new URL(endpoint.pipelinePath, this.#baseUrl), {\n            baton: this.#baton,\n            requests: pipeline.map((entry) => entry.request),\n        }, endpoint.encoding, json_PipelineReqBody, protobuf_PipelineReqBody);\n    }\n    #createCursorRequest(entry, endpoint) {\n        if (endpoint.cursorPath === undefined) {\n            throw new ProtocolVersionError(\"Cursors are supported only on protocol version 3 and higher, \" +\n                `but the HTTP server only supports version ${endpoint.version}.`);\n        }\n        return this.#createRequest(new URL(endpoint.cursorPath, this.#baseUrl), {\n            baton: this.#baton,\n            batch: entry.batch,\n        }, endpoint.encoding, json_CursorReqBody, protobuf_CursorReqBody);\n    }\n    #createRequest(url, reqBody, encoding, jsonFun, protobufFun) {\n        let bodyData;\n        let contentType;\n        if (encoding === \"json\") {\n            bodyData = writeJsonObject(reqBody, jsonFun);\n            contentType = \"application/json\";\n        }\n        else if (encoding === \"protobuf\") {\n            bodyData = writeProtobufMessage(reqBody, protobufFun);\n            contentType = \"application/x-protobuf\";\n        }\n        else {\n            throw impossible(encoding, \"Impossible encoding\");\n        }\n        const headers = new Headers();\n        headers.set(\"content-type\", contentType);\n        if (this.#jwt !== undefined) {\n            headers.set(\"authorization\", `Bearer ${this.#jwt}`);\n        }\n        if (this.#remoteEncryptionKey !== undefined) {\n            headers.set(\"x-turso-encryption-key\", this.#remoteEncryptionKey);\n        }\n        return new Request(url.toString(), { method: \"POST\", headers, body: bodyData });\n    }\n}\nfunction handlePipelineResponse(pipeline, respBody) {\n    if (respBody.results.length !== pipeline.length) {\n        throw new ProtoError(\"Server returned unexpected number of pipeline results\");\n    }\n    for (let i = 0; i < pipeline.length; ++i) {\n        const result = respBody.results[i];\n        const entry = pipeline[i];\n        if (result.type === \"ok\") {\n            if (result.response.type !== entry.request.type) {\n                throw new ProtoError(\"Received unexpected type of response\");\n            }\n            entry.responseCallback(result.response);\n        }\n        else if (result.type === \"error\") {\n            entry.errorCallback(errorFromProto(result.error));\n        }\n        else if (result.type === \"none\") {\n            throw new ProtoError(\"Received unrecognized type of StreamResult\");\n        }\n        else {\n            throw impossible(result, \"Received impossible type of StreamResult\");\n        }\n    }\n}\nasync function decodePipelineResponse(resp, encoding) {\n    if (encoding === \"json\") {\n        const respJson = await resp.json();\n        return readJsonObject(respJson, json_PipelineRespBody);\n    }\n    if (encoding === \"protobuf\") {\n        const respData = await resp.arrayBuffer();\n        return readProtobufMessage(new Uint8Array(respData), protobuf_PipelineRespBody);\n    }\n    await resp.body?.cancel();\n    throw impossible(encoding, \"Impossible encoding\");\n}\nasync function errorFromResponse(resp) {\n    const respType = resp.headers.get(\"content-type\") ?? \"text/plain\";\n    let message = `Server returned HTTP status ${resp.status}`;\n    if (respType === \"application/json\") {\n        const respBody = await resp.json();\n        if (\"message\" in respBody) {\n            return errorFromProto(respBody);\n        }\n        return new HttpServerError(message, resp.status);\n    }\n    if (respType === \"text/plain\") {\n        const respBody = (await resp.text()).trim();\n        if (respBody !== \"\") {\n            message += `: ${respBody}`;\n        }\n        return new HttpServerError(message, resp.status);\n    }\n    await resp.body?.cancel();\n    return new HttpServerError(message, resp.status);\n}\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 4090, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/node_modules/@libsql/hrana-client/lib-esm/http/client.js"],"sourcesContent":["import { fetch, Request } from \"cross-fetch\";\nimport { Client } from \"../client.js\";\nimport { ClientError, ClosedError, ProtocolVersionError } from \"../errors.js\";\nimport { HttpStream } from \"./stream.js\";\nexport const checkEndpoints = [\n    {\n        versionPath: \"v3-protobuf\",\n        pipelinePath: \"v3-protobuf/pipeline\",\n        cursorPath: \"v3-protobuf/cursor\",\n        version: 3,\n        encoding: \"protobuf\",\n    },\n    /*\n    {\n        versionPath: \"v3\",\n        pipelinePath: \"v3/pipeline\",\n        cursorPath: \"v3/cursor\",\n        version: 3,\n        encoding: \"json\",\n    },\n    */\n];\nconst fallbackEndpoint = {\n    versionPath: \"v2\",\n    pipelinePath: \"v2/pipeline\",\n    cursorPath: undefined,\n    version: 2,\n    encoding: \"json\",\n};\n/** A client for the Hrana protocol over HTTP. */\nexport class HttpClient extends Client {\n    #url;\n    #jwt;\n    #fetch;\n    #remoteEncryptionKey;\n    #closed;\n    #streams;\n    /** @private */\n    _endpointPromise;\n    /** @private */\n    _endpoint;\n    /** @private */\n    constructor(url, jwt, customFetch, remoteEncryptionKey, protocolVersion = 2) {\n        super();\n        this.#url = url;\n        this.#jwt = jwt;\n        this.#fetch = customFetch ?? fetch;\n        this.#remoteEncryptionKey = remoteEncryptionKey;\n        this.#closed = undefined;\n        this.#streams = new Set();\n        if (protocolVersion == 3) {\n            this._endpointPromise = findEndpoint(this.#fetch, this.#url);\n            this._endpointPromise.then((endpoint) => this._endpoint = endpoint, (error) => this.#setClosed(error));\n        }\n        else {\n            this._endpointPromise = Promise.resolve(fallbackEndpoint);\n            this._endpointPromise.then((endpoint) => this._endpoint = endpoint, (error) => this.#setClosed(error));\n        }\n    }\n    /** Get the protocol version supported by the server. */\n    async getVersion() {\n        if (this._endpoint !== undefined) {\n            return this._endpoint.version;\n        }\n        return (await this._endpointPromise).version;\n    }\n    // Make sure that the negotiated version is at least `minVersion`.\n    /** @private */\n    _ensureVersion(minVersion, feature) {\n        if (minVersion <= fallbackEndpoint.version) {\n            return;\n        }\n        else if (this._endpoint === undefined) {\n            throw new ProtocolVersionError(`${feature} is supported only on protocol version ${minVersion} and higher, ` +\n                \"but the version supported by the HTTP server is not yet known. \" +\n                \"Use Client.getVersion() to wait until the version is available.\");\n        }\n        else if (this._endpoint.version < minVersion) {\n            throw new ProtocolVersionError(`${feature} is supported only on protocol version ${minVersion} and higher, ` +\n                `but the HTTP server only supports version ${this._endpoint.version}.`);\n        }\n    }\n    /** Open a {@link HttpStream}, a stream for executing SQL statements. */\n    openStream() {\n        if (this.#closed !== undefined) {\n            throw new ClosedError(\"Client is closed\", this.#closed);\n        }\n        const stream = new HttpStream(this, this.#url, this.#jwt, this.#fetch, this.#remoteEncryptionKey);\n        this.#streams.add(stream);\n        return stream;\n    }\n    /** @private */\n    _streamClosed(stream) {\n        this.#streams.delete(stream);\n    }\n    /** Close the client and all its streams. */\n    close() {\n        this.#setClosed(new ClientError(\"Client was manually closed\"));\n    }\n    /** True if the client is closed. */\n    get closed() {\n        return this.#closed !== undefined;\n    }\n    #setClosed(error) {\n        if (this.#closed !== undefined) {\n            return;\n        }\n        this.#closed = error;\n        for (const stream of Array.from(this.#streams)) {\n            stream._setClosed(new ClosedError(\"Client was closed\", error));\n        }\n    }\n}\nasync function findEndpoint(customFetch, clientUrl) {\n    const fetch = customFetch;\n    for (const endpoint of checkEndpoints) {\n        const url = new URL(endpoint.versionPath, clientUrl);\n        const request = new Request(url.toString(), { method: \"GET\" });\n        const response = await fetch(request);\n        await response.arrayBuffer();\n        if (response.ok) {\n            return endpoint;\n        }\n    }\n    return fallbackEndpoint;\n}\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 4207, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/node_modules/@libsql/hrana-client/lib-esm/libsql_url.js"],"sourcesContent":["import { LibsqlUrlParseError } from \"./errors.js\";\n;\n/** Parses a URL compatible with the libsql client (`@libsql/client`). This URL may have the \"libsql:\" scheme\n * and may contain query parameters. */\nexport function parseLibsqlUrl(urlStr) {\n    const url = new URL(urlStr);\n    let authToken = undefined;\n    let tls = undefined;\n    for (const [key, value] of url.searchParams.entries()) {\n        if (key === \"authToken\") {\n            authToken = value;\n        }\n        else if (key === \"tls\") {\n            if (value === \"0\") {\n                tls = false;\n            }\n            else if (value === \"1\") {\n                tls = true;\n            }\n            else {\n                throw new LibsqlUrlParseError(`Unknown value for the \"tls\" query argument: ${JSON.stringify(value)}`);\n            }\n        }\n        else {\n            throw new LibsqlUrlParseError(`Unknown URL query argument ${JSON.stringify(key)}`);\n        }\n    }\n    let hranaWsScheme;\n    let hranaHttpScheme;\n    if ((url.protocol === \"http:\" || url.protocol === \"ws:\") && (tls === true)) {\n        throw new LibsqlUrlParseError(`A ${JSON.stringify(url.protocol)} URL cannot opt into TLS using ?tls=1`);\n    }\n    else if ((url.protocol === \"https:\" || url.protocol === \"wss:\") && (tls === false)) {\n        throw new LibsqlUrlParseError(`A ${JSON.stringify(url.protocol)} URL cannot opt out of TLS using ?tls=0`);\n    }\n    if (url.protocol === \"http:\" || url.protocol === \"https:\") {\n        hranaHttpScheme = url.protocol;\n    }\n    else if (url.protocol === \"ws:\" || url.protocol === \"wss:\") {\n        hranaWsScheme = url.protocol;\n    }\n    else if (url.protocol === \"libsql:\") {\n        if (tls === false) {\n            if (!url.port) {\n                throw new LibsqlUrlParseError(`A \"libsql:\" URL with ?tls=0 must specify an explicit port`);\n            }\n            hranaHttpScheme = \"http:\";\n            hranaWsScheme = \"ws:\";\n        }\n        else {\n            hranaHttpScheme = \"https:\";\n            hranaWsScheme = \"wss:\";\n        }\n    }\n    else {\n        throw new LibsqlUrlParseError(`This client does not support ${JSON.stringify(url.protocol)} URLs. ` +\n            'Please use a \"libsql:\", \"ws:\", \"wss:\", \"http:\" or \"https:\" URL instead.');\n    }\n    if (url.username || url.password) {\n        throw new LibsqlUrlParseError(\"This client does not support HTTP Basic authentication with a username and password. \" +\n            'You can authenticate using a token passed in the \"authToken\" URL query parameter.');\n    }\n    if (url.hash) {\n        throw new LibsqlUrlParseError(\"URL fragments are not supported\");\n    }\n    let hranaPath = url.pathname;\n    if (hranaPath === \"/\") {\n        hranaPath = \"\";\n    }\n    const hranaWsUrl = hranaWsScheme !== undefined\n        ? `${hranaWsScheme}//${url.host}${hranaPath}` : undefined;\n    const hranaHttpUrl = hranaHttpScheme !== undefined\n        ? `${hranaHttpScheme}//${url.host}${hranaPath}` : undefined;\n    return { hranaWsUrl, hranaHttpUrl, authToken };\n}\n"],"names":[],"mappings":";;;;AAAA;;;AAIO,SAAS,eAAe,MAAM;IACjC,MAAM,MAAM,IAAI,IAAI;IACpB,IAAI,YAAY;IAChB,IAAI,MAAM;IACV,KAAK,MAAM,CAAC,KAAK,MAAM,IAAI,IAAI,YAAY,CAAC,OAAO,GAAI;QACnD,IAAI,QAAQ,aAAa;YACrB,YAAY;QAChB,OACK,IAAI,QAAQ,OAAO;YACpB,IAAI,UAAU,KAAK;gBACf,MAAM;YACV,OACK,IAAI,UAAU,KAAK;gBACpB,MAAM;YACV,OACK;gBACD,MAAM,IAAI,kMAAmB,CAAC,CAAC,4CAA4C,EAAE,KAAK,SAAS,CAAC,QAAQ;YACxG;QACJ,OACK;YACD,MAAM,IAAI,kMAAmB,CAAC,CAAC,2BAA2B,EAAE,KAAK,SAAS,CAAC,MAAM;QACrF;IACJ;IACA,IAAI;IACJ,IAAI;IACJ,IAAI,CAAC,IAAI,QAAQ,KAAK,WAAW,IAAI,QAAQ,KAAK,KAAK,KAAM,QAAQ,MAAO;QACxE,MAAM,IAAI,kMAAmB,CAAC,CAAC,EAAE,EAAE,KAAK,SAAS,CAAC,IAAI,QAAQ,EAAE,qCAAqC,CAAC;IAC1G,OACK,IAAI,CAAC,IAAI,QAAQ,KAAK,YAAY,IAAI,QAAQ,KAAK,MAAM,KAAM,QAAQ,OAAQ;QAChF,MAAM,IAAI,kMAAmB,CAAC,CAAC,EAAE,EAAE,KAAK,SAAS,CAAC,IAAI,QAAQ,EAAE,uCAAuC,CAAC;IAC5G;IACA,IAAI,IAAI,QAAQ,KAAK,WAAW,IAAI,QAAQ,KAAK,UAAU;QACvD,kBAAkB,IAAI,QAAQ;IAClC,OACK,IAAI,IAAI,QAAQ,KAAK,SAAS,IAAI,QAAQ,KAAK,QAAQ;QACxD,gBAAgB,IAAI,QAAQ;IAChC,OACK,IAAI,IAAI,QAAQ,KAAK,WAAW;QACjC,IAAI,QAAQ,OAAO;YACf,IAAI,CAAC,IAAI,IAAI,EAAE;gBACX,MAAM,IAAI,kMAAmB,CAAC,CAAC,yDAAyD,CAAC;YAC7F;YACA,kBAAkB;YAClB,gBAAgB;QACpB,OACK;YACD,kBAAkB;YAClB,gBAAgB;QACpB;IACJ,OACK;QACD,MAAM,IAAI,kMAAmB,CAAC,CAAC,6BAA6B,EAAE,KAAK,SAAS,CAAC,IAAI,QAAQ,EAAE,OAAO,CAAC,GAC/F;IACR;IACA,IAAI,IAAI,QAAQ,IAAI,IAAI,QAAQ,EAAE;QAC9B,MAAM,IAAI,kMAAmB,CAAC,0FAC1B;IACR;IACA,IAAI,IAAI,IAAI,EAAE;QACV,MAAM,IAAI,kMAAmB,CAAC;IAClC;IACA,IAAI,YAAY,IAAI,QAAQ;IAC5B,IAAI,cAAc,KAAK;QACnB,YAAY;IAChB;IACA,MAAM,aAAa,kBAAkB,YAC/B,GAAG,cAAc,EAAE,EAAE,IAAI,IAAI,GAAG,WAAW,GAAG;IACpD,MAAM,eAAe,oBAAoB,YACnC,GAAG,gBAAgB,EAAE,EAAE,IAAI,IAAI,GAAG,WAAW,GAAG;IACtD,OAAO;QAAE;QAAY;QAAc;IAAU;AACjD","ignoreList":[0]}},
    {"offset": {"line": 4280, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/node_modules/@libsql/hrana-client/lib-esm/index.js"],"sourcesContent":["import { WebSocket } from \"@libsql/isomorphic-ws\";\nimport { subprotocolsV2, subprotocolsV3 } from \"./ws/client.js\";\nimport { WebSocketUnsupportedError } from \"./errors.js\";\nimport { HttpClient } from \"./http/client.js\";\nimport { WsClient } from \"./ws/client.js\";\nexport { WebSocket } from \"@libsql/isomorphic-ws\";\nexport { fetch, Request, Headers } from \"cross-fetch\";\nexport { Client } from \"./client.js\";\nexport * from \"./errors.js\";\nexport { Batch, BatchStep, BatchCond } from \"./batch.js\";\nexport { parseLibsqlUrl } from \"./libsql_url.js\";\nexport { Sql } from \"./sql.js\";\nexport { Stmt } from \"./stmt.js\";\nexport { Stream } from \"./stream.js\";\nexport { HttpClient } from \"./http/client.js\";\nexport { HttpStream } from \"./http/stream.js\";\nexport { WsClient } from \"./ws/client.js\";\nexport { WsStream } from \"./ws/stream.js\";\n/** Open a Hrana client over WebSocket connected to the given `url`. */\nexport function openWs(url, jwt, protocolVersion = 2) {\n    if (typeof WebSocket === \"undefined\") {\n        throw new WebSocketUnsupportedError(\"WebSockets are not supported in this environment\");\n    }\n    var subprotocols = undefined;\n    if (protocolVersion == 3) {\n        subprotocols = Array.from(subprotocolsV3.keys());\n    }\n    else {\n        subprotocols = Array.from(subprotocolsV2.keys());\n    }\n    const socket = new WebSocket(url, subprotocols);\n    return new WsClient(socket, jwt);\n}\n/** Open a Hrana client over HTTP connected to the given `url`.\n *\n * If the `customFetch` argument is passed and not `undefined`, it is used in place of the `fetch` function\n * from `cross-fetch`. This function is always called with a `Request` object from\n * `cross-fetch`.\n */\nexport function openHttp(url, jwt, customFetch, remoteEncryptionKey, protocolVersion = 2) {\n    return new HttpClient(url instanceof URL ? url : new URL(url), jwt, customFetch, remoteEncryptionKey, protocolVersion);\n}\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AAGA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AAEA;;;;;;;;;;;;;;;;;;;AAEO,SAAS,OAAO,GAAG,EAAE,GAAG,EAAE,kBAAkB,CAAC;IAChD,IAAI,OAAO,yKAAS,KAAK,aAAa;QAClC,MAAM,IAAI,wMAAyB,CAAC;IACxC;IACA,IAAI,eAAe;IACnB,IAAI,mBAAmB,GAAG;QACtB,eAAe,MAAM,IAAI,CAAC,mMAAc,CAAC,IAAI;IACjD,OACK;QACD,eAAe,MAAM,IAAI,CAAC,mMAAc,CAAC,IAAI;IACjD;IACA,MAAM,SAAS,IAAI,yKAAS,CAAC,KAAK;IAClC,OAAO,IAAI,6LAAQ,CAAC,QAAQ;AAChC;AAOO,SAAS,SAAS,GAAG,EAAE,GAAG,EAAE,WAAW,EAAE,mBAAmB,EAAE,kBAAkB,CAAC;IACpF,OAAO,IAAI,iMAAU,CAAC,eAAe,MAAM,MAAM,IAAI,IAAI,MAAM,KAAK,aAAa,qBAAqB;AAC1G","ignoreList":[0]}}]
}